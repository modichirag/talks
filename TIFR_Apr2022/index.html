<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Reconstruction of Cosmological Fields in Forward Model Framework</title>

		<meta name="description" content="Presentation at TIFR">
		<meta name="author" content="Chirag Modi">

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<link rel="stylesheet" href="reveal.js/css/reset.css">
		<link rel="stylesheet" href="reveal.js/css/reveal.css">
		<link rel="stylesheet" href="reveal.js/css/theme/darkenergy.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="reveal.js/lib/css/monokai.css">
		
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'reveal.js/css/print/pdf.css' : 'reveal.js/css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">

				<!-- <section  data-background-image="assets/lsst_stills_0009_crop.jpg" > -->
				<section  data-background-image="assets/backgroundweb1.jpg" data-background-size="2500px" data-background-color="black" data-background-position='right'> 
				<!-- <section  data-background-image="assets/backgroundtrail2.jpg" data-background-size="cover" data-background-color="black" > -->

						<div class="container">
							<div class="title" style="border-radius: 20px; background-color:rgba(0, 0, 0, 0.4);  margin-left: 50px;">
								<h2> A Forward Modelling Approach to Cosmological Analysis </h2>
								<h3> Reconstructing Cosmological Fields with Differentiable Simulations </h3>
								<h4> State of the Universe Seminar, TIFR, April 22nd 2022</h4>
							</div>
						</div>

						<hr>
						<div style="border-radius: 20px; background-color:rgba(0, 0, 0, 0);">
							<div class="container" >
								<div class="col">
									<div align="left" style="margin-left: 20px;">
										<br>
										<h3>Chirag Modi</h3>
										<p>Center for Computational Astronomy<br>Center for Computational Mathematics<br>Flatiron Institute</p>
										
										<br>
										
									</div>
								</div>
								<div class="col" align="right">
									<img src="assets/fl_logo3.png" class="plain" height="150"></img>
									<br>
									<br>
									<!-- <img src="assets/bids-logo2.png" class="plain" height="150"></img>
									     <img src="assets/desc-logo-inv.png" class="plain" height="200"></img> -->
								</div>
							</div>
						</div>
				</section>
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				
				<!-- <section data-background-image="assets/WMAP_timeline.jpg" data-background-size="1100px" data-background-color="black"> -->
				<!-- 	<\!-- <h2 class='slide-title' style="position:absolute;top:0;"> the $\Lambda$CDM view of the Universe </h3> -\-> -->
				<!-- 	<h2 class='slide-title' style="position:relative;top:0;"> the $\Lambda$CDM view of the Universe </h2> -->
				<!-- 	<\!-- <img class="plain" data-src="assets/WMAP_timeline.jpg" /> -\-> -->
				<!-- 	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br> -->
				<!-- 	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br> -->
				<!-- 	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br> -->
				<!-- 	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br> -->

				
				<!-------------------------------------------------------------------------------->
				<section>
						<h3 class="slide-title"> Outline </h3>

						</ul>
								
						<div class="block ">
							<div class="block-title">
								Main parts of the talk
							</div>
							<div class="block-content">
								<ul>
									<li class="fragment fade-up" data-fragment-index='0' > Motivating forward modeling framework<br>
									</li>
									<br>
									<li class="fragment fade-up" data-fragment-index='0' > Reconstruction of cosmological fields
									</li>
									<br>
									<li class="fragment fade-up" data-fragment-index='0' > <b class="alert">FlowPM </b>: differentiable cosmological simulations in TensorFlow
									</li>
									<br>
									<li class="fragment fade-up" data-fragment-index='1' > Challenges with inference in high dimensions
									</li>
									<br>
									<li class="fragment fade-up" data-fragment-index='1' > <b class="alert">CosmicRIM </b>: learning optimization with recurrent networks
									</li>
									<br>
									<li class="fragment fade-up" data-fragment-index='1' > <b class="alert">Variational self boosted sampling </b>: combining variational inference and MCMC
									</li>
								</ul>
							</div>
						</div>
						<br>
						
						<br> <br> <br>
				</section>
				<section>
					<!-- <section data-background-image="assets/cmb.png" data-background-size="1400px" data-background-color="black"> -->
					<!-- 	<h3 class='slide-title'> next generation of cosmological probes</h3> -->
					<!-- 	<div class="container"> -->
					<!-- 		<div class="col"> -->
					<!-- 			<div class="plain" data-fragment-index='0'> -->
					<!-- 				Galaxy Clustering  -  DESI, LSST, Euclid... -->
					<!-- 				<br> -->
					<!-- 				<img src="assets/sdss_pie2.jpg" class="plain" height="250"></img> -->
					<!-- 				<br> -->
					<!-- 			</div> -->
					<!-- 			<div class="plain" data-fragment-index='0'> -->
					<!-- 				Gravitational Lensing - DES, HSC, LSST... -->
					<!-- 				<br> -->
					<!-- 				<img src="assets/lensing.jpg" class="plain" height="250"></img> -->
					<!-- 				<br> -->
					<!-- 			</div> -->
					<!-- 		</div> -->
							
					<!-- 		<div class="col"> -->
					<!-- 			<div class="plain" data-fragment-index='0'> -->
					<!-- 				Supernovae - DES, LSST, WFRIST... -->
					<!-- 				<br> -->
					<!-- 				<img src="assets/supernova2.jpg" class="plain" height="250"></img> -->
					<!-- 			</div> -->
								
					<!-- 			<div class="plain" data-fragment-index='0'> -->
					<!-- 				21-cm Intensity Mapping - CHIME, HIRAX, PUMA... -->
					<!-- 				<br> -->
					<!-- 				<img src="assets/21cm.png" class="plain" height="250"></img> -->
					<!-- 				<br> -->
					<!-- 			</div> -->
								
					<!-- 		</div> -->
					<!-- 	</div> -->
					<!-- </section> -->

				<section>
						<h3 class='slide-title'> next generation of cosmological probes</h3>
						<div class="container">
							<div class="col"  style="flex: 2 0; position:relative; top:0px">
								<div class="container">
									<div class="col">
										<div class="plain" data-fragment-index='0'>
											Cosmic Microwave Background  <br> <em> SO, CMB-S4...</em>
											<br>
											<img src="assets/cmb.png" class="plain" height="200"></img>
											<br>
										</div>
									</div>
									<div class="col">
										<div class="plain" data-fragment-index='0'>
											Galaxy Clustering  <br> <em>  DESI, LSST, Euclid... </em>
											<br>
											<img src="assets/sdss_pie2.jpg" class="plain" height="200"></img>
											<br>
										</div>
									</div>
								</div>
								<div class="plain" data-fragment-index='0'>
									Gravitational Lensing <br> <em> DES, HSC, LSST... </em>
									<br>
									<img src="assets/lensing.jpg" class="plain" height="200"></img>
									<br>
								</div>
							</div>
							
							<div class="col">
								<div class="plain" data-fragment-index='0'>
									21-cm Intensity Mapping <br> <em> CHIME, HIRAX, PUMA... </em>
									<br>
									<img src="assets/21cm.png" class="plain" height="200"></img>
									<br>
								</div>

								<div class="plain" data-fragment-index='0' style="position:relative; right:230px">
									Supernovae <br> <em> DES, LSST, WFRIST... </em>
									<br>
									<img src="assets/supernova2.jpg" class="plain" height="200"></img>
								</div>
									
							</div>

						</div>
							<div style="text-align:right">
								<em> ...and more... </em>
							</div>
					</section>
				
					<!-------------------------------------------------------------------------------->
					<!-- <section data-background-image="assets/Mayall.jpg"> -->
					<!-- 	<h2 class='slide-title'> the Dark Energy Spectroscopic Instrument</h2>						 -->
					<!-- 	<div class="container"> -->
					<!-- 		<div class="col"> -->
					<!-- 			<ul> -->
					<!-- 				<li > 14,000 square degrees over 5 years</li> -->
					<!-- 				<br> -->
					<!-- 				<li > 35 million galaxies and quasars in 0 &lt; z &lt; 3.5</li> -->
					<!-- 				<br> -->
					<!-- 				<li class="fragment fade-up" data-fragment-index="1"> Measuring growth of structures and Baryon Acoustic Oscillations</li> -->
					<!-- 			</ul> -->
					<!-- 			<br > -->
					<!-- 		</div> -->
					<!-- 		<div class="col"> -->
					<!-- 			<div style="position:relative; width:480px; height:420px; margin:0 auto;"> -->
					<!-- 			<\!-- <img src="assets/desi_bao.png" class="fragment fade-up" height="400"></img> -\-> -->
					<!-- 			<\!--  -->
					<!-- 			     <img class="fragment current-visible plain"  data-src="assets/desi_first_sky.png" style="position:absolute;top:20px;left:20px;" data-fragment-index="0" />  -->
					<!-- 			     <img class="fragment current-visible plain"  data-src="assets/desi_first_sky.png" style="position:absolute;top:20px;left:20px;" data-fragment-index="1" /> -->
					<!-- 			     -\-> -->
					<!-- 			<img src="assets/desi_bao.png" class="fragment fade-up" data-fragment-index="1" height="400"></img> -->
					<!-- 			</div> -->
					<!-- 			<div class="fragment"  data-fragment-index="1" style="position:relative; float:right; font-size: 20px; top:10px; left:0px">DESI Collaboration: 1611.00036</div> -->
					<!-- 		</div> -->
					<!-- </section> -->
					
					<!-- <\!-------------------------------------------------------------------------------\-> -->
					<!-- <section  data-background-image="assets/chime2.jpeg"  data-background-color="black"> -->

					<!-- 	<h2 class='slide-title'>Packed Ultra-wideband Mapping Array (PUMA)</h2> -->

					<!-- 	<br> -->
					<!-- 	<div class='container'> -->
					<!-- 		<div class='col' style="flex: 0 0 25em;position:relative; top:-80px"> -->
					<!-- 			<ul> -->
					<!-- 				<\!-- <li class='fragment' data-fragment-index="1">A concept for an ultra-wide band, high-sensitivity and low-resolution radio telescope array </li> -\-> -->
					<!-- 				<li>post-DESI, post-LSST program for dark energy</li> -->
					<!-- 				<br> -->
					<!-- 				<li class='fragment' data-fragment-index="2" >A concept radio telescope array for 21 cm intensity mapping in post-reionization era </li> -->
					<!-- 				<br> -->
					<!-- 				<li class='fragment' data-fragment-index="4">Growth and expansion history in the pre-acceleration era</li> 				 -->
					<!-- 			</ul> -->
					<!-- 		</div> -->
					<!-- 		<div class='col' style="flex: 0 0 25em;"> -->
					<!-- 			<div style="position:relative; width:480px; height:420px; margin:0 auto;"> -->
									
					<!-- 				<img class="fragment current-visible plain"  data-src="assets/21cmmapwhitepaper.png" style="position:absolute;top:0px;left:0px;" data-fragment-index="2" /> -->
					<!-- 				<img data-src="assets/puma_expansion.png" class='fragment plain' data-fragment-index="4",  style="position:absolute;top:0px;left:0px;height: 370px;"/> -->
					<!-- 			</div> -->
					<!-- 			<div class="fragment"  data-fragment-index="2" style="position:relative; float:right; font-size: 20px; top:-20px; left:50px">CVDE White Paper: 1810.09572</div> -->
					<!-- 		</div> -->

					<!-- </section> -->
					<!-------------------------------------------------------------------------------->
					<!-------------------------------------------------------------------------------->

					<!-- <section data-background-image="assets/LSST.jpg" > -->
					<!-- 	<font color='black'> -->
					<!-- 	<h2 class='slide-title-black'> <font color='black'> the Vera C. Rubin Legacy Survey of Space and Time </font> </h2> -->
					<!-- 	<div class="container"> -->
					<!-- 		<div class="col"> -->
					<!-- 			<ul> -->
					<!-- 				<li class="fragment fade-up"> 1000 images each night, 15 TB/night for 10 years</li> -->
					<!-- 				<br> -->
					<!-- 				<li class="fragment fade-up"> 18,000 square degrees, observed once every few days</li> -->
					<!-- 				<br> -->
					<!-- 				<li class="fragment fade-up"> Tens of billions of objects, each one observed $\sim1000$ times</li> -->
					<!-- 				<br> -->
					<!-- 				<li class="fragment fade-up"> Galaxy Clustering, Weak lensing, Supernovae and much more</li> -->
					<!-- 			</ul> -->
					<!-- 			<br > -->
					<!-- 		</div> -->
					<!-- 		<div class="col"> -->
					<!-- 			<div class="fragment fade-up"> -->
					<!-- 				<\!-- <font color="white">LSST forecast on dark energy parameters </font> -\-> -->
					<!-- 				<img class="plain" data-src="assets/lsst_y10_forecast2.png" style="height :400px"/> -->
					<!-- 			</div> -->
					<!-- 		</div> -->
					<!-- 	</div> -->
					<!-- 	</font> -->
					<!-- </section> -->
					
				</section>
				
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				<section>
					<section>
						<h3 class='slide-title'> modern cosmological surveys </h3>
						<div class="container">
							<div class="col" style="flex: 0 0 30em;">

								<div class="block fragment" data-fragment-index="0">
									<div class="block-title">
										A Blessing
									</div>
									<div class="block-content">
										<ul>
											<li>Unprecedented statistical power
											</li>
											<br>
											<li>Great potential for new discoveries
											</li>
										</ul>
									</div>
								</div>

								<br>
								<div class="block fragment" data-fragment-index="1">
									<div class="block-title">
										The challenge
									</div>
									<div class="block-content">
										<ul>
											<li class="fragment" data-fragment-index="1">How to combine different cosmological probes </li>
											<br>
											<li class="fragment" data-fragment-index="2">What are the optimal summary statistics? <br>
												$\rightarrow$ <b>2 point function</b>, 3 point function, peak counts ...
											</li>
											<br>
											<li class="fragment" data-fragment-index="3"> MCMC to recover a posterior on model parameters <br>
												$\rightarrow$  <b class="alert">analytic likelihood</b> :
												$p(\theta | x ) \propto \underbrace{p(x | \theta)}_{\mathrm{likelihood}}  \  \underbrace{p(\theta)}_{\mathrm{prior}}$
											</li>

										</ul>
									</div>

								</div>

							</div>
							<div class="col" >
								<div style="position:relative; width:480px; height:420px; margin:0 auto;">
									<img class="fragment current-visible"  data-src="assets/lsst_y10_forecast2.png" style="position:absolute;top:0;left:0;" data-fragment-index="0" />
									<img class="fragment current-visible plain"  data-src="assets/cov.png" style="position:absolute;top:0;left:0;" data-fragment-index="1" />
									<img class="fragment current-visible plain" data-src="assets/nbody.png"  data-fragment-index="2" />
									  <img class="fragment  plain" data-src="assets/hsc_constraints.png" style="position:absolute;top:0;left:0;" data-fragment-index="3" />
								</div>
								<div class="fragment current-visible" data-fragment-index="0" style="position:absolute; font-size: 20px;  left:900px">DESC Collaboration: 1809.01669</div>
								<div class="fragment current-visible" data-fragment-index="1" style="position:absolute; font-size: 20px;  left:980px">Krause &amp; Eifler 2016</div>
								<div class="fragment"  data-fragment-index="3" style="position:absolute; font-size: 20px; top:500px; left:1030px">Hikage et al. 2018</div>
							</div>
						</div>
						<br>
						<div class="fragment">
							$\Longrightarrow$ Dire need for <b class="alert">novel analysis techniques</b> to fully realize the potential of modern surveys.
						</div>


					</section>

					
					<!-------------------------------------------------------------------------------->

					<!-- <section> -->
					<!-- 	<h3  class='slide-title'>A different road: forward modeling</h3> -->

					<!-- 	<div class='container'> -->
					<!-- 			<div class='col'> -->

					<!-- 				<ul> -->
					<!-- 					<li > Instead of trying to analytically evaluate the likelihood, -->
					<!-- 						let us build a forward model of the observables.</li> -->
					<!-- 					<br> -->
					<!-- 					<li > Each component of the model is now tractable -->
					<!-- 					</li> -->
					<!-- 					<br> -->
					<!-- 					<li class='fragment' data-fragment-index='0'> Cost - <b >large number of latent variables</b>. -->
					<!-- 						<br> -->
					<!-- 						<br> -->
					<!-- 						<ul style="list-style:None"> 																				 -->
					<!-- 							$\rightarrow$  Effecient high dimensional inference possible with novel methods: -->
										
										
					<!-- 								<ul  style="padding-left: 20px"> -->
					<!-- 									<li> Hamiltonian Monte-Carlo -->
					<!-- 									</li> -->
					<!-- 									<li> Variational Inference -->
					<!-- 									</li> -->
					<!-- 									<li> MAP+Laplace -->
					<!-- 									</li> -->
					<!-- 									<li> Gold Mining -->
					<!-- 									</li> -->
					<!-- 									<li> Dimensionality reduction by Fisher-Information Maximization -->
					<!-- 									</li> -->
					<!-- 								</ul> -->
					<!-- 								<br> -->
					<!-- 								$\rightarrow$ Benefit from fast, accurate, differentiable forward simulations -->
												
					<!-- 						</ul> -->
											
					<!-- 					</li> -->
					<!-- 					<br> -->
										

					<!-- 			</div> -->
						
					<!-- 			<div class='col'> -->
					<!-- 				<img data-src="assets/pgm_lensing.png" class="plain" style="height:550px;"/> -->
					<!-- 				<div style="float:right; font-size: 20px">Schneider et al. 2015</div> -->
					<!-- 			</div> -->
					<!-- 	</div> -->
					<!-- </section> -->


					<!-------------------------------------------------------------------------------->

					<section>
						<h3  class='slide-title'>A different road: forward modeling</h3>

						<div class='container'>
								<div class='col'>

									<ul>
										<li > Build a forward model of the observables from the initial conditions
											wherein each component is accessible</li>
										<br>
										<li class='fragment' data-fragment-index='0'> Cost - <b >large number of latent variables to infer</b>.
										</li>
										<br>
										<li class='fragment' data-fragment-index='1'> Novel methods for high dimensional inference with <b> fast, accurate, differentiable forward simulations</b>.
											<br>
											<br>
											<ul style="list-style:None"> 																										
													<ul  style="padding-left: 20px">
														<li class='fragment' data-fragment-index='2'> Hamiltonian Monte-Carlo
														</li>
														<div class="fragment current-visible" data-fragment-index="2" style="position:absolute; font-size: 20px;  left:125px"><em>Follow gradient to take long jumps in MCMC</em></div>
														<li class='fragment' data-fragment-index='3'> Variational Inference
														</li>
														<div class="fragment current-visible" data-fragment-index="3" style="position:absolute; font-size: 20px;  left:125px"><em>Use gradients to reduce stochasticity in learning</em></div>
														<li class='fragment' data-fragment-index='4'> Dimensionality reduction by Fisher-Information Maximization
														</li>
														<div class="fragment current-visible" data-fragment-index="4" style="position:absolute; font-size: 20px;  left:125px"><em>Use gradients to estimate Fisher information for training loss</em></div>
														<li class='fragment' data-fragment-index='5'> Neural Score Matching
														</li>
														<div class="fragment" data-fragment-index="5" style="position:absolute; font-size: 20px;  left:125px"><em>Match the gradients of the log-likelihood of the data</em></div>
													</ul>
												
											</ul>
											
										</li>
										<br>
										

								</div>
						
								<div class='col'>
									<img data-src="assets/pgm_lensing.png" class="plain" style="height:550px;"/>
									<div style="float:right; font-size: 20px">Schneider et al. 2015</div>
								</div>
						</div>
					</section>

					
				</section>

				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				
				<section>
						<h3 class='slide-title'> Bayesian Reconstruction of Cosmological Fields </h3>


						<div> <b> Idea : </b>
							Given a forward model for the observed data, reconstruct latent fields for analysis by maximizing the posterior of the initial conditions  $(s)$ of the Universe </div>
						$$ \arg\max_s \  \log p(d | \mathcal{F}(s)) \ + \ p(s) $$
						<!-- =  \underbrace{[d - \mathcal{F}(s)]^\dagger N ^{-1} [d - \mathcal{F}(s)]}_{likelihood \,(\mathcal{E})} + \underbrace{s^\dagger \mathcal{S}^{-1} s}_{prior} $$ -->

						<div class="container">

							<div class="col"  style="flex: 0 0 32em;">

								<div class="block fragment " data-fragment-index="1">
									<div class="block-title">
										Examples of latent fields
									</div>
									<div class="block-content">
										<ul>
											<li> Initial density field 
											$\rightarrow$ Optimal analysis, BAO ... </li>
											<li > Observed data field 
											$\rightarrow$ Denoising ... </li> 
											<li > Velocity field/Final matter density 
											$\rightarrow$ Supplement analyses </li> 
												
										</ul>
									</div>

								</div>
								<br>
								<div class="block fragment " data-fragment-index="3">
									<div class="block-title">
										Challenges
									</div>
									<div class="block-content">
										<ul>
											<li >High Dimensional Optimization (&gt $10^8$ parameters)<br>
											$\rightarrow$ Gradient Based Algorithm <br>
												$\rightarrow$ Differentiable Forward Models</li>
											<li > Correct Likelihood and noise model
										</ul>
									</div>

								</div>
								<br>

							</div>
							<div class="col" style="flex: 0 0 21em;">
								<img class="plain"  data-src="assets/opt_cycle.png" />
							</div>
				
				</section>


					
				

				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				<!-- <section> -->
				<!-- 	<div style="font-size:80px">Galaxy Clustering Surveys</div> -->
				<!-- </section> -->
				
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->

				<section>
					
					<!-- <\!-------------------------------------------------------------------------------\-> -->
					<!-- <section> -->
					<!-- 	<h3 class='slide-title'> example 1 : galaxy clustering surveys</h3> -->

					<!-- 	<div style="position:relative; width:1000px; height:300px; margin:0 auto;">							 -->
					<!-- 		<img   style="position:absolute;top:0;left:0;" data-src="assets/recontruth.png" height="500"/> -->
					<!-- 	</div> -->
					<!-- 	<div style="position:relative; width:1000px; height:300px; margin:0 auto;"> -->
					<!-- 		<div class="fragment " data-fragment-index="0" style="position:absolute;top:10px;left:600px;font-size:200%"> $\longrightarrow$ </div> -->
					<!-- 		<img class="fragment plain" data-fragment-index="0" style="position:absolute;top:50px;left:500px;" data-src="assets/fnn.jpeg" height="150" /> -->
					<!-- 		<img class="fragment  current-visible" data-fragment-index="1"  style="position:absolute;top:0;left:0;" data-src="assets/reconinit.png" height="500"/> -->
					<!-- 		<img class="fragment  current-visible " data-fragment-index="2"  style="position:absolute;top:0;left:0;" data-src="assets/reconrecon.png" height="500"/> -->
					<!-- 	</div> -->
					<!-- 	<div class="fragment" data-fragment-index="0" style="position:relative; float:right; left:-50px; font-size: 20px; margin:0 auto">Modi et al. 2018</div> -->
						
					<!-- </section> -->

					<!-------------------------------------------------------------------------------->
					<section>
						<h3 class='slide-title'> example 1 : galaxy clustering surveys</h3>

						<div class="container">
							<div class="col">
								<div class="block "  style="position:absolute;top:200px;left:40px">
									<div class="block-title">
										true fields
									</div>
									<div class="block-content" >
									</div>
								</div>
								<br>
								<br>
								<br>
								<br>
 								<div class="block fragment  current-visible" data-fragment-index="1" style="position:absolute;top:500px;left:20px">
									<div class="block-title">
										  starting fields
									</div>
									<div class="block-content">
									</div>
								</div>
								<div class="block fragment  current-visible" data-fragment-index="2" style="position:absolute;top:500px">
									<div class="block-title">
										reconstructed fields
									</div>
									<div class="block-content">
									</div>
								</div>
							</div>
							
							<div class="col">
								<div style="position:relative; width:1000px; height:300px; margin:0 auto;">							
									<img   style="position:absolute;top:0;left:0;" data-src="assets/recontruth.png" height="500"/>
								</div>
								<div style="position:relative; width:1000px; height:300px; margin:0 auto;">
									<div class="fragment " data-fragment-index="0" style="position:absolute;top:10px;left:600px;font-size:200%"> $\longrightarrow$ </div>
									<img class="fragment plain" data-fragment-index="0" style="position:absolute;top:50px;left:500px;" data-src="assets/fnn.jpeg" height="150" />
									<img class="fragment  current-visible" data-fragment-index="1"  style="position:absolute;top:0;left:0;" data-src="assets/reconinit.png" height="500"/>
									<img class="fragment  current-visible " data-fragment-index="2"  style="position:absolute;top:0;left:0;" data-src="assets/reconrecon.png" height="500"/>
								</div>
								<div class="fragment" data-fragment-index="0" style="position:relative; float:right; left:-50px; font-size: 20px; margin:0 auto">Modi et al. 2018</div>
							</div>
						</div>
					</section>

					
					<!-------------------------------------------------------------------------------->
					<!-- <section> -->
					<!-- 	<h3 class='slide-title'> reconstruction - 2pt functions </h3> -->

					<!-- 	<div class="container" style="position:relative;">							 -->

					<!-- 		<div class="col" style="position:relative; width:100px;  margin:0 auto;">							 -->
					<!-- 			<\!-- <div> -\-> -->
					<!-- 			<\!-- 	Cross correlation : $ r_c = \frac{P_{xy}}{\sqrt{P_x \times P_y}}$ <br> -\-> -->
					<!-- 			<\!-- 	Transfer Function : $ t_f = \sqrt{\frac{P_{y}}{P_x} }$  -\-> -->

					<!-- 			<\!-- </div> -\-> -->


					<!-- 			<img data-src="assets/recontruth.png" /> -->
					<!-- 		<img data-src="assets/reconrecon.png" /> -->
					<!-- 		</div> -->
					<!-- 		<div class="col"> -->
					<!-- 			<div> -->
					<!-- 			</div> -->

					<!-- 			<img class="plain  " data-fragment-index="1"  data-src="assets/recon2pt.png" /> -->
					<!-- 		</div> -->
					<!-- 	</div> -->
					<!-- 	<div style="position:relative; float:right; left:-50px; font-size: 20px; margin:0 auto">Modi et al. 2018</div> -->
						
					<!-- </section> -->
					<!-------------------------------------------------------------------------------->
					<section>
						<h3 class='slide-title'> galaxy clustering : baryon acoustic oscillations </h3>

						<i> Most robust probes for dark energy from galaxy surveys like DESI </i>

						<br>
						<br>
						
						<div class="container">

							<div class="col">
								<ul>
									<li class="fragment" data-fragment-index="0">Pressure waves in the primordial photon-baryon fluids </li> 
									<br>									
									<li class="fragment" data-fragment-index="0">Frozen at the time of decoupling <br>$\rightarrow$ Clustering at preferred scale </li>
									<br>
									<li class="fragment" data-fragment-index="0"> Damping due to non-linear evolution</li>
									<br>

									<li class="fragment" data-fragment-index="2"> Fisher information <br> <br>
										$F_{ij} =  V_{\rm{eff}}\int_{k_{min}}^{k_{max}} \frac{\partial {\rm ln} P(k)}{\partial p_i} \frac{\partial {\rm ln} P(k)}{\partial p_j}\frac{4 \pi k^2}{2 (2\pi)^3} dk \quad \mathbf{\propto \,  r_c^4} $
									</li>


								</ul>
							</div>		
														
							<div class="col" >
								<!-- <\!-- <div class="col"> -\-> -->
								<div style="position:relative; width:600px; height:400px; top:130px; left:50px;  margin:1 auto">
									
									
									<!-- <img class="fragment current-visible plain" data-fragment-index="0"  style="position:absolute;top:-150px;left:0px;" data-src="assets/bao_cartoon.png" />  -->
									<Img class="fragment current-visible plain" data-fragment-index="0" style="position:absolute;top:-150px;left:0px;" data-src="assets/bao_damping.jpg"/>
									
									<img class="fragment plain" data-fragment-index="2"  style="position:absolute;top:-50px;left:0px;" data-src="assets/realrccfig.png" />

								</div>
								<div class="fragment current-visible plain" data-fragment-index="0" style="position:absolute; float:right; top:550px; right:00px; font-size: 20px; margin:0 auto">Padmanabhan et al. 2012</div>							
								<div class="fragment current-visible" data-fragment-index="2" style="position:absolute; float:right;  top:550px; right:0px; font-size: 20px; margin:0 auto">Seo et al. 2007</div>
								<div class="fragment current-visible" data-fragment-index="2" style="position:absolute; float:right;  top:570px; right:0px; font-size: 20px; margin:0 auto">Modi et al. 2018</div>
								
							</div>
						
						</div>
						<br><br>

					</section>
					

				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				<section>
						<h3 class='slide-title'> galaxy clustering : reconstruction in redshift space </h3>

						
						<div class="container">

							<div class="col">
								<ul>
									<li >Forward modeling reconstructs velocity field </li> 
									<br>									
									<li >Displace halos with velocities beyond linear theory</li>
									<br>
									<li class="fragment" data-fragment-index="1"> Imporvements in BAO <br><br>
										<ul>$\rightarrow$ Over 2x gains in line-of-sight direction</ul>
										<ul class="fragment" data-fragment-index="1"> $\rightarrow$ Same ~30% improvement in transverse direction</ul>
									</li>
									<br>
									<li class="fragment" data-fragment-index="1"> Supplement other analyses - velocity power spectra, undoing redshift space distortions ...</li>
									<br>
									<br>
								</ul>
							</div>		
														
							<div class="col" >
								<!-- <div class="col"> -->
								<img  data-src="assets/vel-scatter2sm.png" height="250"/>
								<img class="fragment plain" data-fragment-index="1"  data-src="assets/redrccfig.png" height="250"/>
							</div>
						
						</div>
						<br><br>

					</section>


				</section>
				


				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				<!-- <section> -->
				<!-- 	<div style="font-size:80px">21-cm Intensity Mapping Surveys</div> -->
				<!-- </section> -->

				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				<section >
						
					<section >
					<h3 class='slide-title'>example 2 : 21-cm Intensity Mapping Surveys</h3>

										
						<div class="container">

							<div class="col">
								<ul>
									<li >Loose large scale modes due to the forgeround (wedge) </li> 
									<br>									
									<li >Fraction of modes lost can be as large as  21, 60, 88% at z=2, 4, 6 respectively.</li>
									<br>
									<br>
									<br>
								</ul>
								<br>
								<br>
								<br>
								<div class='fragment', data-fragment-index=1> How to recover these lost modes? <br>
									$\Longrightarrow$ Exploit mode coupling between small and large scales
								</div>

							</div>		
														
							<div class="col" >
								<!-- <div class="col"> -->
								<img  data-src="assets/21cmwedge.png" height="200"/>
								<img class="fragment plain" data-fragment-index="1"  data-src="assets/21cmloop2.png" height="250"/>
							</div>
						
						</div>
						<br><br>
						
						<!-- <div class='container'> -->
						<!-- 	<div class='col' > -->
						<!-- 		<ul> -->
						<!-- 			<li> Loose large scales to due to foreground wedge in 21-cm surveys -->
						<!-- 			</li> -->
						<!-- 			<li> At $z = 2, 4, 6$, fraction of modes lost in the wedge -->
						<!-- 				can be as high as 21, 60, 88%  -->
						<!-- 		</ul> -->
						<!-- 	</div> -->
						<!-- 	<div class='fragment', data-fragment-index=5> How to recover these lost modes? <br> -->
						<!-- 		$\Longrightarrow$ Exploit mode coupling between small and large scales -->
						<!-- 	</div> -->
							
						<!-- 	<div class='col' > -->
						<!-- 		<\!-- <div style="position:relative; width:600px; height:500px; margin:0 auto;top:-50px"> -\-> -->
						<!-- 		<\!-- 	<img class="fragment current-visible plain"  data-src="assets/21cmmapwhitepaper.png" style="position:absolute;top:0px;left:0px;" data-fragment-index="0" /> -\-> -->
						<!-- 		<\!-- 	<img class="fragment current-visible plain"  data-src="assets/21cmmapwhitepaper.png" style="position:absolute;top:0px;left:0px;" data-fragment-index="1" /> -\-> -->
						<!-- 		<\!-- 	<img class="fragment  plain"  data-src="assets/21cmwedge.png" style="position:absolute;top:400px;left:00px;" data-fragment-index="1" /> -\-> -->
						<!-- 		<\!-- 	<img class="fragment  current-visible plain"  data-src="assets/21cmcorrupt.png" style="position:absolute;top:20px;left:100px;" data-fragment-index="2"/> -\-> -->
						<!-- 		<\!-- 	<img class="fragment  current-visible plain"  data-src="assets/21cmcorrupt.png" style="position:absolute;top:20px;left:100px;" data-fragment-index="3"/> -\-> -->
						<!-- 		<\!-- 	<img class="fragment  current-visible plain"  data-src="assets/21cmcorrupt.png" style="position:absolute;top:20px;left:100px;" data-fragment-index="4"/> -\-> -->
						<!-- 		<\!-- 	<img class="fragment plain"  data-src="assets/21cmloop2.png" style="position:absolute;top:0px;left:40px;" data-fragment-index="5" height="350px"/> -\-> -->

						<!-- 		<\!-- </div> -\-> -->
						<!-- 		<\!-- <div  class="fragment  plain"  data-fragment-index="1" style="position:absolute; float:right; top:650px;  left:1000px;font-size: 20px; margin:0 auto">Modi et al. 2019b</div> -\-> -->

						<!-- 	</div> -->
						<!-- </div> -->
					</section>
					<!-------------------------------------------------------------------------------->
					<!-------------------------------------------------------------------------------->

					<section >
						<h3 class='slide-title'>21-cm surveys : reconstructing large scale modes in the data</h3>
						<div class="fragment" data-fragment-index="1">	
						$$\mathcal{P}_w =  \sum_k \frac{1}{\rm N_{modes}(k)} \left( \sum_{\substack{\vec{k}, |\vec{k}|\sim k, \\ {\vec{k} \not\in w}}}  \frac{|\delta_{\rm HI}^b(\vec{k}) - \delta_{\rm HI}^n(\vec{k})|^2}{P_{\rm err}(k,\mu)} +  \sum_{\vec{k}, |\vec{k}|\sim k}  \frac{|s(\vec{k}))|^2}{P_{\rm s}(k)}  \right)$$
						</div>
						<div style="position:relative; width:800px; height:600px; left:100px;margin:0 auto">	
							<img class="fragment plain current-visible fade-up"  style="position:absolute;left:-70px;width:800px" data-src="assets/21cmrecon-noise.png" data-fragment-index="0"/>
							<img class="fragment  "  style="position:absolute;left:-70px;width:800px" data-src="assets/21cmrecon.png" data-fragment-index="1"/>
						</div>
						
						<div   style="position:absolute; float:right; top:650px;  left:1000px;font-size: 20px; margin:0 auto">Modi et al. 2019b</div>
						

					</section>


					<section >

						<h3 class='slide-title'>21-cm surveys : science cases</h3>

						<div class='container'>
							<div class='col' style="position:relative; width:800px; height:600px; left:0px; top:0px; margin:1 auto">
								<h4 class="alert"> Photometric Redshifts </h4>
								$$\delta_p(k, \mu) = (b_p + f\mu^2) \mathcal{D} \delta_m(\vec{k}) + {\rm noise}$$
								$$\mathcal{D}(k, \mu) = {\rm exp} [-k^2\mu^2\sigma_\chi^2/2]$$
								<img  style="position:absolute;top:170px;left:100px;width:450px"
								     data-src="assets/photocross-snr.png" />
								<br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br>
								<div > <b> Also CMB Lensing cross-correlations </b> </div>
							</div>
							<div class='col' style="position:relative; width:800px; height:600px; left:0px; top:0px; margin:1 auto">
								<h4 class="alert" data-fragment-index="2"> Baryon Acoustic Oscillations </h4>
								<img class="plain"  style="position:absolute;left:-70px;width:800px" data-fragment-index="2"  data-src="assets/21cmbao2d.png" />
								<br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br><br><br>
								<div class=' '   data-fragment-index="2">  Standard reconstruction does not reconstruct inside the wedge  </div>
							</div>
						</div>
						<div   style="position:absolute; float:right; top:650px;  left:1000px;font-size: 20px; margin:0 auto">Modi et al. 2019b<br>Modi et al. 2020b</div>

					</section>

				</section>

				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				
				<section class="inverted" data-background="#000">
					<h2>How do we make the forward models in cosmology <b>fast</b> and <b>differentiable</b>?</h2>
				</section>
				
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				
				<section>

	
					<section>
						 <h3 class='slide-title'> forward models in cosmology</h3>


						<div class="container">
							<div class='col'>
								<img data-src="assets/fieldinit.png" class="plain" style="height:300px;"/>
								<b class="alert"> Linear Field </b>
							</div>
							<div class='col fragment' data-fragment-index='2'>
								<img data-src="assets/fieldfin.png" class="plain " style="height:300px;"/>
								<b class="alert"> Final Dark Matter </b>
							</div>
							<hr style="width: 1px; height: 400px; background: white; border: none;" />
							<div class='col fragment' data-fragment-index='3'>
								<img data-src="assets/fieldhalo.png" class="plain " style="height:300px;"/>
								<b class="alert"> Dark Matter Halos </b>
							</div>
							<div class='col fragment' data-fragment-index='4'>
								<img data-src="assets/fieldgal.png" class="plain " style="height:300px;"/>
								<b class="alert"> Observables </b>
							</div>
						</div>
						<div class="container" style="position:relative; width:1000px; height:50px; margin:0 auto;">
							<div class='col fragment'  data-fragment-index='2'> <font size="10"> $\longrightarrow$ </font> <br> N-body simulations
								<br>
								<b class="alert fragment "> FlowPM </b>
							</div>
							<div class='col fragment' data-fragment-index='3'>  <font size="10"> $\longrightarrow$ </font> <br> Group Finding <br> algorithms </div>
							<div class='col fragment' data-fragment-index='4'>  <font size="10"> $\longrightarrow$ </font> <br> Semi-analytic &amp <br> distribution models </div>
						<!-- 		<div class='fragment' data-fragment-index='2'> N-body simulations <div> -->
						<!-- <div class='fragment' data-fragment-index='3'> Group Finding algorithms <div> -->
						<!-- <div class='fragment' data-fragment-index='4'> Semi-analytic models <div> -->
						</div>


					</section>

					<!-------------------------------------------------------------------------------->
					<section>
						<h3 class='slide-title'>the Fast Particle-Mesh scheme</h3>

						<b>The idea</b>: approximate gravitational forces by estimating densities on a grid.
						
						<div class='container'>
							<div class='col'>
								<ul>
									<li>The numerical scheme:
										<br>
										<br>
										<ul>
											<li class="fragment" data-fragment-index="1"> Estimate the density of particles on a mesh<br>
											=> compute gravitational forces by FFT
											</li>
											
											<br>
											
											<li class="fragment" data-fragment-index="2"> Interpolate forces at particle positions
											</li>
											
											<br>
											
											<li class="fragment" data-fragment-index="3"> Update particle velocity and positions, and iterate
											</li>
										</ul>
									</li>
									<br>
									
									<li class='fragment'> Fast and simple, at the cost of approximating short range interactions.
									</li>
									
								</ul>
							</div>
							
							<div class='col'>

								<div style="position:relative; width:550px; height:550px; margin:0 auto;">
									<img class="fragment current-visible plain" data-src="assets/particle_positions_0.png" style="position:absolute;top:0;left:0;" data-fragment-index="0" />
									<img class="fragment current-visible plain" data-src="assets/particle_density_0.png" style="position:absolute;top:0;left:0;" data-fragment-index="1" />
									<img class="fragment current-visible plain" data-src="assets/particle_positions_0.png" style="position:absolute;top:0;left:0;" data-fragment-index="2" />
									<img class="fragment  plain" data-src="assets/particle_positions_1.png" style="position:absolute;top:0;left:0;" data-fragment-index="3" />
									
								</div>
								
							</div>
						</div>
						
						<div class="fragment"> $\Longrightarrow$ Only a series of FFTs and interpolations.</div>
					</section>
					
					<!-------------------------------------------------------------------------------->

					<section>
						<h3 class="slide-title">the hammer behind the Deep Learning revolution</h3>
						<br>
						<ul>
							<li class="fragment"> <b>Automatic differentiation</b> allows you to compute analytic derivatives of arbitraty expressions:<br>
								If I form the expression $y = a * x + b$, it is separated in fundamental ops:
								$$ y = u + b \qquad u = a * x $$
								then gradients can be obtained by the chain rule:
								$$\frac{\partial y}{\partial x} = \frac{\partial y}{\partial u} \frac{ \partial u}{\partial x} = 1 \times a = a$$
							</li>
							<br>
							<li class="fragment"> This is a fundamental tool in Machine Learning, and autodiff frameworks include <b>TensorFlow</b>, <b>JAX</b> or PyTorch.
								<div class="container">
									<div class="col">
										<img data-src="assets/TF_FullColor_Horizontal.png" />
									</div>

									<div class="col">
										<img data-src="https://raw.githubusercontent.com/google/jax/master/images/jax_logo_250px.png" class="plain" />
									</div>
								</div>
								$\Longrightarrow$ In addition to autodiff, they all provide <b>GPU/TPU acceleration</b>.
							</li>
						</ul>
						<br>
						<br>
					</section>


					<!-------------------------------------------------------------------------------->
					

					
			
					<section>
						<h3 class='slide-title'>Introducing FlowPM: Particle-Mesh Simulations in TensorFlow</h3>
						<div class="container">
							<div class="col">
								<div style="float:right; font-size: 20px"> Modi, <b>Lanusse</b>, Seljak (2020)
									<a href="https://arxiv.org/abs/2010.11847"><img src="https://img.shields.io/badge/astro--ph.CO-arXiv%3A2010.11847-B31B1B.svg" class="plain" style="height:25px;vertical-align:middle;" /></a>
								</div>
							</div>
						</div>
						<div class='container'>
							<div class='col'>
								<img data-src="assets/github.png" class="plain" style="height:50px" />
								<img data-src="assets/TF_FullColor_Horizontal.png" class='plain' style="height: 50px;" />
								
								<div> <a href="https://github.com/DifferentiableUniverseInitiative/flowpm">https://github.com/DifferentiableUniverseInitiative/flowpm</a>
								</div>
								<pre class="python"><code data-trim data-noescape>
										import tensorflow as tf
										import flowpm
										# Defines integration steps
										stages = np.linspace(0.1, 1.0, 10, endpoint=True)
										
										initial_conds = flowpm.linear_field(32,       # size of the cube
										100,      # Physical size
										ipklin,   # Initial powerspectrum
										batch_size=16)
										
										# Sample particles and displace them by LPT
										state = flowpm.lpt_init(initial_conds, a0=0.1)
										
										# Evolve particles down to z=0
										final_state = flowpm.nbody(state, stages, 32)
										
										# Retrieve final density field
										final_field = flowpm.cic_paint(tf.zeros_like(initial_conditions),
										final_state[0])
								</code></pre>
								10x faster than CPU based PM simulations <br>
								Scales to multiple GPUs with Mesh TensorFlow
								<br>
								<br>
								<br>
								<br>
								<br>
							</div>
							
							<div class='col'>
								<div class="fig-container" data-file="flowpm_16.html" data-style="height: 550px;"></div>
								<br>
								<br>
								<br>
								<br>
							</div>
						</div>
					</section>



				
					<section>
						<h3 class='slide-title'>reconstructing the Universe in 10 lines</h3>

						<br>
						$$ \mathcal{L}(s) = \underbrace{[d - \mathcal{F}(s)]^\dagger N ^{-1} [d - \mathcal{F}(s)]}_{likelihood} + \underbrace{s^\dagger \mathcal{S}^{-1} s}_{prior} $$

						  <div class='container'>
							  <div class='col' style="flex: 0 0 25em;">
								  <ul >
									  <li> Readily available gradients with respect to every component of the forward model
									  </li>
									  <br>
									  <li > Seamless interfacing with DL elements for hybrid forward models and inference </li>
								  </ul>

								  <br><br>
							      <img data-src="assets/TF_FullColor_Horizontal.png" class='plain' style="height: 60px;"/>
							  </div>
							  <div class='col' style="flex: 0 0 25em;">

								  <pre  ><code data-trim data-noescape style="height:70em;width:50em;">
								  import tensorflow as tf
								  import flowpm

								  linear = tf.get_variable('linear', shape=(nc, nc, nc),
											 initializer=tf.random_normal_initializer(), trainable=True)
								  initial_conds = flowpm.lpt_init(linear, name='icstate')
								  final_state = flowpm.nbody(initial_conds, stages, nc, name='fnstate')

								  #Likelihood term of data
								  final = tf.zeros_like(linear)
								  final = flowpm.cic_paint(final, final_state[0], boxsize=bs, name='final')
								  residual = tf.multiply(tf.subtract(final, data), 1/sigma)
								  likelihood = tf.reduce_sum(tf.multiply(residual, residual))
								  #likelihood = module(dict(features=final, labels=data), as_dict=True)[loss] ##DL
								  #Prior
								  lineark = flowpm.r2c3d(linear, norm=nc**3)
								  prior = tf.square(tf.cast(tf.abs(lineark), tf.float32))
								  prior = tf.reduce_sum(tf.multiply(prior, 1/priorwt))j
								  #Loss
								  loss = tf.add(likelihood, prior, name='loss')
								  optimizer = ScipyOptimizerInterface(loss, var_list=[linear], 'L-BFGS-B')

								  with tf.Session() as session:
								      optimizer.minimize(session)
								      recon = session.run(linear)


								  </code></pre>
							  </div>
						  </div>

					</section>

				</section>
				
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				
				<section class="inverted" data-background="#000">
					<h2>Challenges to high dimensional inference</h2>
				</section>
				
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				
				<!-- <section> -->
				<!-- 	    <h3 class="slide-title"> MAP optimization in action</h3> -->
				<!-- 	    $$\arg\max_s \ \log p(x_{dm} | f(s)) \ + \ p(s) $$ -->
				<!-- 	    <\!-- <div style="float:right; font-size: 16px">credit: <a href="https://github.com/modichirag">C. Modi</a></div> -\-> -->
				<!-- 	    <br> -->
				<!-- 	    <div class="container"> -->
				<!-- 		    <div class="col fragment fade-up" data-fragment-index="1"> -->
				<!-- 			    <img data-src="assets/init_field.png" style='height:250px;' /> -->
				<!-- 			    <br> True initial conditions <br> $s_0$ -->
				<!-- 		    </div> -->

				<!-- 		    <div class="col"> -->
				<!-- 			    <img data-src="assets/reconim_init.gif" style='height:250px;' /> -->
				<!-- 			    <br> Reconstructed initial conditions $s$ -->
				<!-- 		    </div> -->

				<!-- 		    <div class="col"> -->
				<!-- 			    <img data-src="assets/reconim_fin.gif" style='height:250px;' /> -->
				<!-- 			    <br> Reconstructed dark matter distribution $x_{dm} = f(s)$ -->
				<!-- 		    </div> -->

				<!-- 		    <div class="col"> -->
				<!-- 			    <img data-src="assets/fin_field.png" style='height:250px;' /> -->
				<!-- 			    <br> Data <br> $x_{dm} = f(s_0)$ -->
				<!-- 		    </div> -->
				<!-- 	    </div> -->
				<!-- 	    <br> -->
				<!-- 	    <br> -->

				<!-- 	    <div class="fragment" data-fragment-index="1"> -->
				<!-- 		    Check out this blogpost for more details <br> <a href=https://blog.tensorflow.org/2020/03/simulating-universe-in-tensorflow.html> -->
				<!-- 			    https://blog.tensorflow.org/2020/03/simulating-universe-in-tensorflow.html</a> -->
				<!-- 	    </div> -->
				<!-- </section> -->
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->

				<section>
					<section>
						
					    <h3 class="slide-title">If only MAP optimization was easy...</h3>

					    $$\arg\max_s \ \log p(x_{dm} | f(s)) \ + \ p(s) $$

					    <div class="container">
						    <div class="col">
							    Direct optimization
							    <div style="position:relative; width:600px; height:410px; margin:0 auto;">
								    <img style="position:absolute;top:0;left:0px;" data-src="assets/recon_illustration0.png" height="350" />
								    <img class="fragment " data-fragment-index="1" style="position:absolute;top:0;left:0px;" data-src="assets/recon_illustration1.png" height="350" />
							    </div>

						    </div>
						    <div class="col fragment" data-fragment-index="2">
							    ad-hoc annealing
							    <div style="position:relative; width:600px; height:410px; margin:0 auto;">
								    <img class="fragment " data-fragment-index="2" style="position:absolute;top:0;left:5px;" data-src="assets/recon_illustration2.png" height="350" />
								    <img class="fragment " data-fragment-index="3" style="position:absolute;top:0;left:5px;" data-src="assets/recon_illustration3.png" height="350" />
								    <img class="fragment " data-fragment-index="4" style="position:absolute;top:0;left:5px;" data-src="assets/recon_illustration4.png" height="350" />
								    <img class="fragment " data-fragment-index="5" style="position:absolute;top:0;left:5px;" data-src="assets/recon_illustration5.png" height="350" />
							    </div>
						    </div>
					    </div>

					    <div>
						    <ul>
							    <li class="fragment" data-fragment-index="1"> Direct optimization of MAP leads to poor solutions on large scales.
							    </li>
							    <li class="fragment" data-fragment-index="3">Annealing recovers unbiased large scales, but at the cost of ad-hoc tempering procedure.
							    </li>
						    </ul>
					    </div>
					</section>

					<!-------------------------------------------------------------------------------->
					<section>
						<h3 class="slide-title">If only getting uncertainties was easy...</h3>

						<br>
					
						$$\mathrm{Generate\, samples\, from\, posterior: }\, \pi(x)  =  \log p(y | f(x)) \ + \ p(x) $$
						
						<div class="container">
							<div class="col">
								<ul>
									<li class="fragment" data-fragment-index="1" > <b> Hamiltonian Monte Carlo (HMC) </b>
										<br>
										$$U(x) = - \log \pi(x) $$
										$$H(x, p) = U(x) + \frac{1}{2}p^TM^{-1}p$$
									<br>
									Generate samples by simulating a Markov chain to evolve the Hamiltonian
									</li>
									<br>
									<li class="fragment" data-fragment-index="2"> Guaranteed to be asymptotically correct
									</li>
									<br>
									<li class="fragment" data-fragment-index="3"> Samples are correlated
									</li>
								</ul>
								
							</div>
							<div class="col" >
								<!-- <\!-- <div class="col"> -\-> -->
								<div style="position:relative; width:700px; height:400px; top:130px; left:50px;  margin:1 auto">

									<Img class="fragment current-visible plain" data-fragment-index="1" style="position:absolute;top:-50px;left:0px;" data-src="assets/hmc_algo.png"/>
									<img class="fragment current-visible plain" data-fragment-index="2"  style="position:absolute;top:-50px;left:0px" data-src="assets/hmc_posterior.png" />
									<img class="fragment plain" data-fragment-index="3"  style="position:absolute;top:-50px;left:0px;height:250px;width:800px" data-src="assets/hmc_ac.png" />

								</div>
								<div class="fragment" data-fragment-index="1" style="position:absolute; float:right; top:600px; right:00px; font-size: 20px; margin:0 auto">Modi et al. (in prep)</div>							
								
							</div>
						</div>
						
						<br>
						<div class="fragment">
							$\Longrightarrow$ Can take $\mathcal{O}(10^4)$ simulations to generate one independent sample!!!
						</div>
					</section>
					
				</section>


				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->


				<section class="inverted" data-background="#000">
					    <h2>Combining machine learning with differentiable simulations for efficient inference</h2>
				</section>

				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->

				<section>

					<section>
						<h3 class="slide-title">Learning to Optimize: A closer look at the optimization algorithm</h3>

						<br>
					
						$$\arg\max_x \ \log p(y | f(x)) \ + \ p(x) $$
						
						<div class="container">
							<div class="col">
								<ul>
									<li> Standard Gradient Descent Algorithm:
										$$x_{i+1} = x_i - \epsilon \left[ \nabla_x{\log p(y | f(x_i))} + \nabla_x \log p(x_i) \right]$$
										<div class="fragment" data-fragment-index="1">$$x_{i+1} = x_i - \Gamma \left(\nabla_x{\log p(y | f(x_i))}, \nabla_x \log p(x_i) \right]$$
											with <b class="alert">update function</b> $\Gamma: (u,v) \rightarrow \epsilon(u + v)$ </div>
									</li>
									<br>
									<br>
									<li class="fragment"> Many algorithms (e.g. ADAM, LBFGS) can expressed in this form with a different choice of $\Gamma$.
									</li>
								</ul>
								
							</div>
							<div class="col fragment" data-fragment-index="1">
								<img data-src="assets/map_graph.png" />
							</div>
						</div>
						
						<br>
						<div class="fragment">
							$\Longrightarrow$ What if we could learn this update function?
						</div>
					</section>

					<!-------------------------------------------------------------------------------->
					
					<section>
						<h3 class="slide-title">Learning to Optimize: Recurrent Inference Machines<br> <a href="https://arxiv.org/abs/1706.04008">Putzky & Welling, 2017</a></h3>
						
						<img data-src="assets/illustration_RIM.png" />
						
						<div class="container">
							<div class="col", style="width:900px">
								<ul>
									<li> Recurrent Neural Network $h_\phi$ learns the update function <br>
										state variable $s$ keeps a memory of previous updates
										$$ s_{i+1} = h^*_\phi( \nabla \log p(y|x_{i}), x_i, s_{i})$$
										$$ x_{i+1} = x_i + h_\phi(\nabla \log p(y|x_{i}), x_i, s_{i+1})$$
									</li>
									
								</ul>
							</div>
							<div class="col fragment">
								<ul>
									<li> Train according to:
										$$\mathcal{L} = \sum_{i}^T w_i\mathcal{L}(x_i, x)$$
									</li>
								</ul>
							</div>
						</div>
					</section>
					
					<!-- <section> -->
					<!-- 	    <h3 class="slide-title">Inside an RNN Cell</h3> -->
					<!-- 	    <img data-src="assets/LSTM_GRU.png" height="600px" /> -->
					<!-- 	    (<a href="https://towardsdatascience.com/illustrated-guide-to-lstms-and-gru-s-a-step-by-step-explanation-44e9eb85bf21">source</a>) -->
					<!-- </section> -->

					<!-- <section> -->
					<!-- 	    <h3 class="slide-title">Illustration on inverse problems</h3> -->
					<!-- 	    <br> -->
					<!-- 	    <br> -->
					<!-- 	    <br> -->
					<!-- 	    <br> -->
					<!-- 	    <div> -->
					<!-- 		    <img data-src="assets/IllustrationRIM.png" /><br> -->
					<!-- 		    From left to right: input masked image, increasing number of steps of solutions, ground truth. -->
					<!-- 	    </div> -->
					<!-- 	    <br> -->
					<!-- 	    <br> -->
					<!-- 	    <br> -->
					<!-- 	    <br> -->
					<!-- </section> -->
				</section>
				
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->

				<section>
					    <section>
						    <h3 class="slide-title">CosmicRIM: Recurrence Inference Machines for Initial Condition Reconstruction</h3>
						    <div class="container">
							    <div class="col">
								    <div style="float:right; font-size: 20px"> Modi, <b>Lanusse</b>, Seljak, Spergel, Perreault-Levasseur (2021)
									    <a href="https://arxiv.org/abs/2104.12864"><img src="https://img.shields.io/badge/astro--ph.CO-arXiv%3A2104.12864-B31B1B.svg" class="plain" style="height:25px;vertical-align:middle;" /></a>
								    </div>
							    </div>
						    </div>
						    <br>

						    <div class="container">

							    <div class="col">
								    Recurrent Neural Network Architecture
								    <img data-src="assets/cosmic_rim.png" width="450" />
							    </div>

							    <div class="col">

								    <ul>
									    <li class="fragment"> Few key features of Cosmic RIM:
										    <br>
										    <ul>
											    <br>
											    <li >We provide gradients of both prior and likelihood to the model.</li>
											    <br>
											    <li >Because our forward model couples scales, we use a multiscale U-Net architecture.</li>
											    <br>
											    <li > Input gradients are pre-scaled with the ADAM formula.</li>
										    </ul>
									    </li>

								    </ul>

							    </div>
						    </div>
						    <br>
					    </section>

					    <section>
						    <h3 class="slide-title">Experiments</h3>
						    <div class="block ">
							    <div class="block-title">
								    Settings
							    </div>
							    <div class="block-content">
								    <ul>
									    <li>Data: Halo mass weighted field, $\bar{n}=10^{-3}$ (h/Mpc)$^3$
									    </li>
									    <li>Forward model: $64^3$ particles, 400 Mpc/h box, 2LPT dynamics with 2nd order bias model
									    </li>
									    <li> RIM: 10 steps, trained under l2 loss
									    </li>
								    </ul>
							    </div>
						    </div>

						    <div class="container">

							    <div class="col">
								    Initial conditions cross-correlation
								    <img data-src="assets/rim_rc.png" width="420" />

							    </div>
							    <div class="col">
								    Transfer function<br>
								    <img data-src="assets/rim_transfer.png" width="420" />
							    </div>

						    </div>
						    <ul>
							    <li class="fragment">CosmicRIM: Learn to optimize by embedding a Neural Network in the optimization algorithm.<br>
								    $\Longrightarrow$ converges 40x faster than LBFGS.</li>
						    </ul>

					    </section>


					    <section>
						    <h3 class="slide-title">What does RIM learn</h3>

							  <div class='container'>
								  <div class='col' style="flex: 0 0 25em;">
									  <br><br>
									  <ul >
										  <li > Physically motivated annealing
											  <ul>
												  <li>  large scales are reconstructed before small scales </li>
											  </ul>
											  <br>
										  <li class="plain fragment"> Local minima i.e. ADAM/L-BFGS starting from RIM output do not improve results
										  </li>
									  </ul>

								  </div>
								  <div class='col' style="flex: 0 0 25em;">
									  <div style="position:relative; width:600px; height:400px; top:00px; left:50px;  margin:1 auto">
										  <img  style="position:absolute;left:20px;" data-src="assets/rim_rc_steps.png"/>
									  </div> 
									  </div>
							  </div>

					    </section>

				</section>

				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->


				<section>
					<section>
						<h3 class="slide-title">Learning to sample: Variational Self Boosted Sampling</h3>

					
						<!-- $$\mathrm{Posterior }\, \pi(x)  =  \log p(y | f(x)) \ + \ p(x) $$ -->
						
						<div class="container">
							<div class="col">
								<ul>
									<li  > <b> Variational Inference</b> : Learns a parametric form of the posterior $q(x; \nu)$
									</li>
									<br>
									<li class="fragment" data-fragment-index="2"> <b> Variational Self boosted Sampling </b>
										<br>
										Combine HMC sampling with VI to
										<ul>
											<br>
											<li> Phase 1- Use HMC samples to train variational distribution on the fly
											</li>
											<br>
											<li> Phase 2- Generate proposals from variational distribution to break
												correlations in Markov chain
											</li>
										</ul>
									</li>
									<br>
									<li class="fragment" data-fragment-index="3"> Generated samples explore the posterior correctly
									</li>
									<br>
									<li class="fragment" data-fragment-index="4"> Reduces correlation length by over x10
									</li>
								</ul>
								
							</div>
							<div class="col" >
								<!-- <\!-- <div class="col"> -\-> -->
								<div style="position:relative; width:700px; height:600px; top:50px; left:50px;  margin:1 auto">

									<Img class="fragment current-visible plain" data-fragment-index="2" style="position:absolute;top:-50px;left:0px;" data-src="assets/vsbs_algo.png"/>
									<img class="fragment current-visible plain" data-fragment-index="3"  style="position:absolute;top:0px;left:0px" data-src="assets/vsbs_posterior.png" />
									<img class="fragment plain" data-fragment-index="4"  style="position:absolute;top:-50px;left:0px;height:800px;width:800px" data-src="assets/vsbs_ac_gains.png" />
								</div>
								<div class="fragment" data-fragment-index="2" style="position:absolute; float:right; top:600px; right:00px; font-size: 20px; margin:0 auto">Modi et al. (in prep)</div>							
								
							</div>
						</div>
					</section>
					
				</section>


				<!-- <section class="inverted" data-background="#000"> -->
				<!-- 	    <h2>$64^3$? too small, it's never going to be useful for anything!</h2> -->
				<!-- </section> -->

				<!-- <section> -->
				<!-- 		<section> -->
				<!-- 			<h3 class='slide-title'>towards large scale inference with Mesh TensorFlow</h3> -->

				<!-- 			  <div class='container'> -->
				<!-- 				  <div class='col' style="flex: 0 0 25em;"> -->
				<!-- 					  <br><br> -->
				<!-- 					  <ul > -->
				<!-- 						  <li> Simulations of interesting size do not fit on single GPU RAM -->
				<!-- 							  <ul> -->
				<!-- 								  <\!-- <li> Need distributed machine learning framework </li> -\-> -->
				<!-- 								  <li>  Shift from <em> Data </em>  parallelism to <em>  Model </em>  parallelism on HPC environment </li> -->
				<!-- 							  </ul> -->
				<!-- 						  </li> -->
				<!-- 						  <br> -->
				<!-- 						  <li class='fragment' data-fragment-index="1"> Mesh TensorFlow (Shazeer et al. 2018) -->
				<!-- 							  <ul> <li> mesh: a n-dimensional array of processors </li> -->
				<!-- 								  <li> logical tensors with named dimensions </li> -->
				<!-- 								  <li> <em> Computational layout: </em> <br> tensor dimesnion $\rightarrow$ mesh-dimension </li> -->
				<!-- 							  </ul> -->
				<!-- 						  </li> -->
				<!-- 						  <\!-- <br> -\-> -->
				<!-- 						  <\!-- <li class='fragment' data-fragment-index="2"> 3D FFT are computational bottleneck -\-> -->
				<!-- 						  <\!-- 	  <ul> <li> Multi-grid scheme for PM simulations  </li>  -\-> -->
				<!-- 						  <\!-- 		  <li> coarse grids to estimate large scale forces </li> -\-> -->
				<!-- 						  <\!-- 		  <li> <em> Laplacian Image Pyramids </em> to split scales </li> -\-> -->
				<!-- 						  <\!-- 	  </ul> -\-> -->
				<!-- 						  <\!-- </li> -\-> -->
				<!-- 					  </ul> -->

				<!-- 				  </div> -->
				<!-- 				  <div class='col' style="flex: 0 0 25em;"> -->
				<!-- 					  <div style="position:relative; width:600px; height:400px; top:00px; left:50px;  margin:1 auto"> -->
				<!-- 						  <img class="plain fragment current-visible" data-fragment-index="0"  style="position:absolute;left:20px;" data-src="assets/mesh_tensorflow.png"/> -->
				<!-- 						  <img class="plain fragment current-visible" data-fragment-index="1"  style="position:absolute;left:20px;" data-src="assets/matmul2d.png"/> -->
				<!-- 						  <\!-- <img class="plain fragment current-visible" data-fragment-index="2"  style="position:absolute;left:50px;" data-src="assets/pyramid_im.png"/> -\-> -->
				<!-- 						  <\!-- <img class="plain fragment" data-fragment-index="3"  style="position:absolute;left:50px;height:300px" data-src="assets/pyramid_2pt.png"/> -\-> -->
				<!-- 					  </div>  -->
				<!-- 					  <div class="plain fragment current-visible" data-fragment-index="0"  style="position:absolute; text-align:right; right:0px; bottom:100px;">  Gholami et al. 2018  </div> -->
				<!-- 					  <div class="plain fragment current-visible" data-fragment-index="1"  style="position:absolute; text-align:right; right:0px; bottom:100px;">  Shazeer et al. 2018  </div>																																			  </div> -->
				<!-- 			  </div> -->


				<!-- 		</section> -->

				<!-- 		<section> -->
				<!-- 			<h3 class='slide-title'>Mesh FlowPM</h3> -->
				<!-- 			<\!-- -->
				<!-- 			    <img data-src="assets/mesh_flopwm.png" class="plain" style="height:450px;" /> -\-> -->

				<!-- 			  <div class='container'> -->
				<!-- 				  <div class='col' style="flex: 0 0 25em;"> -->
				<!-- 					  <br><br> -->
				<!-- 					  <ul > -->
				<!-- 						  <li > Mesh TensorFlow for distributed, GPU accelerated and automatically differentiable simulations -->
				<!-- 						  </li> -->
				<!-- 						  <br> -->
				<!-- 						  <li class='fragment' data-fragment-index="1"> 3D FFT are computational bottleneck -->
				<!-- 						  </li> -->
				<!-- 						  <br> -->
				<!-- 						  <li class='fragment' data-fragment-index="2"> Multi-grid scheme for PM simulations   -->
				<!-- 							  <ul>  -->
				<!-- 								  <li> coarse grids to estimate large scale forces </li> -->
				<!-- 								  <li> <em> Laplacian Image Pyramids </em> to split scales </li> -->
				<!-- 							  </ul> -->
				<!-- 						  </li> -->
				<!-- 					  </ul> -->

				<!-- 				  </div> -->
				<!-- 				  <div class='col' style="flex: 0 0 25em;"> -->
				<!-- 					  <div style="position:relative; width:600px; height:400px; top:00px; left:50px;  margin:1 auto"> -->

				<!-- 						  <img class="plain fragment current-visible" data-fragment-index="1"  style="position:absolute;left:50px;" data-src="assets/hvsim2.png"/> -->
				<!-- 						  <img class="plain fragment current-visible" data-fragment-index="2"  style="position:absolute;left:100px;" data-src="assets/pyramid_im.png"/> -->
				<!-- 						  <img class="plain fragment" data-fragment-index="3"  style="position:absolute;left:100px;height:300px" data-src="assets/pyramid_2pt.png"/> -->
				<!-- 					  </div>  -->
				<!-- 				  </div> -->
				<!-- 			  </div> -->


				<!-- 		</section> -->

				<!-- 		<section> -->
				<!-- 			<h3 class='slide-title'>Mesh FlowPM: scaling to next generation surveys</h3> -->
				<!-- 			<\!-- -->
				<!-- 			    <img data-src="assets/mesh_flopwm.png" class="plain" style="height:450px;" /> -\-> -->

				<!-- 			<div class="container"> -->
				<!-- 				<div class="col"> -->
				<!-- 					<img data-src="assets/mfpm_demo_1024.png" /> -->
				<!-- 				</div> -->

				<!-- 				<div class="col"> -->
				<!-- 					<ul> -->
				<!-- 						<li> Working MeshTF fork resulting from collaboration with NVIDIA and the Jean-Zay user team. -->
				<!-- 						</li> -->
				<!-- 						<br> -->
				<!-- 						<br> -->
				<!-- 						<li> For a $2048^3$ simulation: -->
				<!-- 							<ul> -->
				<!-- 								<li>Distributed on <b>256</b> NVIDIA V100 GPUs</li> -->
				<!-- 								<li>Runtime: 3 mins</li> -->
				<!-- 							</ul> -->
				<!-- 						</li> -->
				<!-- 						<br> -->
				<!-- 						<br> -->
				<!-- 						<li> Don't hesitate to reach out if you have a use case for model parallelism!<br> -->
				<!-- 							<img data-src="assets/github.png" class="plain" style="height:70px" /><br> -->

				<!-- 							<div> <a href="https://github.com/DifferentiableUniverseInitiative/mesh">https://github.com/DifferentiableUniverseInitiative/mesh</a> -->
				<!-- 							</div> -->
				<!-- 						</li> -->
				<!-- 					</ul> -->
				<!-- 				</div> -->
				<!-- 			</div> -->
				<!-- 		</section> -->
				<!-- </section> -->

				<!-------------------------------------------------------------------------------->
				    <!-------------------------------------------------------------------------------->

				<section>
						<h3 class="slide-title"> Summary </h3>

						<div class="block ">
							<div class="block-title">
								Main Takeaways
							</div>
							<div class="block-content">
								<ul>
									<li class="fragment fade-up"> <b class="alert">Cosmological forward modelling</b>.<br>
										$\Longrightarrow$ Bypass the need for analytic likelihoods and goes towards optimal inference.<br>
										$\Longrightarrow$ Reconstruction of latent cosmological fields 
									</li>
									<br>
									<li class="fragment fade-up"> <b class="alert">Differentiable simulations</b>.<br>
										$\Longrightarrow$ FlowPM and Mesh-FlowPM <br>
										$\Longrightarrow$ enable efficient simulator-based inference and hybrid physical/deep learning models.
									</li>
									<br>
									<li class="fragment fade-up"> <b class="alert">Learned optimization & sampling</b>.<br>
										$\Longrightarrow$ Recurrent Inference Machines allow us to efficiently navigate complex, non-convex posteriors.<br>
										$\Longrightarrow$ Variational Self Boosted Sampling reduces auto-correlation length by combining HMC and VI
									</li>
								</ul>
							</div>
						</div>
						<br>

						<p class="fragment">To find our codes, go to <a href="https://github.com/DifferentiableUniverseInitiative">https://github.com/DifferentiableUniverseInitiative</a></p>
						
						<br>
						<p class="fragment">Thank you ! </p>
						<br> <br> <br>
				</section>
				
				<!-- <section > -->
					
				<!-- 	<h3 class='slide-title'>Summary</h3> -->
					

				<!-- 	<br> -->
				<!-- 	<div class="block fragment " style="width:1200px"> -->
				<!-- 		<div class="block-title" > -->
				<!-- 			Forward Model Framework -->
				<!-- 		</div> -->
				<!-- 		<div class="block-content"> -->
				<!-- 			<ul> -->
				<!-- 				<li> Develop novel inference methodologies for future surveys </li> -->
				<!-- 				<li> FlowPM: differentiable PM simulations in ML framework </li> -->
				<!-- 				<li> Probabilistic forward models with ML enhanced cosmological simulations </li> -->
				<!-- 		</div> -->
				<!-- 	</div> -->
				<!-- 	<br> -->
				<!-- 	<div class="block fragment " style="width:1200px" > -->
				<!-- 		<div class="block-title" > -->
				<!-- 			Reconstruction from galaxy surveys -->
				<!-- 		</div> -->
				<!-- 		<div class="block-content"> -->
				<!-- 			<ul> -->
				<!-- 				<li> Novel neural halo model and likelihood models </li> -->
				<!-- 				<li> Improve over standard reconstruction for BAO analysis </li> -->
				<!-- 				<li> Reconstruct Gaussian initial conditions and velocity field for cosmological analyses </li> -->
				<!-- 		</div> -->
				<!-- 	</div> -->
				<!-- 	<br> -->
				<!-- 	<div class="block fragment " style="width:1200px"> -->
				<!-- 		<div class="block-title" class="fragment"> -->
				<!-- 			Reconstruction from 21cm-intensity mapping surveys -->
				<!-- 		</div> -->
				<!-- 		<div class="block-content"> -->
				<!-- 			<ul> -->
				<!-- 				<li> Lagrangian bias model for the data </li> -->
				<!-- 				<li> Denoising - Recover large scale modes lost in the wedge  </li> -->
				<!-- 				<li> Cross correlation with photometric surveys like LSST and CMB lensing  </li> -->
				<!-- 		</div> -->
				<!-- 	</div> -->
				<!-- 	<br> -->
				<!-- 	 <div class='fragment' style="font-size:30px"> Thank you! </div> -->
					
				<!-- </section> -->

					<!-------------------------------------------------------------------------------->
					
				</div>
			</div>
			

		<style>
		<!--    .reveal .slides { -->
		<!--     border: 5px solid red; -->
		<!--     min-height: 100%; -->
		<!--     width: 128mm; -->
		<!--     height: 96mm; -->
		<!-- } -->
		.reveal .box {
			background-color: #191919;
			margin-left: 10px;
			margin-right: 10px;
			text-align: center;
		}
		.reveal .box-title {
			background-color: #333333;
			padding:1px 1px 1px 1px;
  		color: #FFAA7F;
  		font-weight: bold;
		}

		
		.reveal .block {
			background-color: #191919;
			margin-left: 20px;
			margin-right: 20px;
			text-align: left;
			padding-bottom: 0.1em;
		}
		.reveal .block-title {
			background-color: #333333;
			padding:8px 35px 8px 14px;
  		color: #FFAA7F;
  		font-weight: bold;
		}
		.reveal .block-content {
			padding:8px 35px 8px 14px;
		}
		.reveal .slide-title {
			border-left: 5px solid white;
			text-align: left;
			margin-left: 20px;
			padding-left: 20px;
		}
		.reveal .slide-title-black {
			border-left: 5px solid black;
			text-align: left;
			margin-left: 20px;
			padding-left: 20px;
		}
		.reveal .alert {
  		color: #FFAA7F;
  		font-weight: bold;
		}
		.reveal .inverted {
			filter: invert(100%);
		}
		</style>


		<script src="reveal.js/js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				controls: true,

				//center: false,
				hash: true,
				// Visibility rule for backwards navigation arrows; "faded", "hidden"
				// or "visible"
				controlsBackArrows: 'hidden',
				// Display a presentation progress bar
				progress: true,
				// Display the page number of the current slide
				slideNumber: true,
				transition: 'slide', // none/fade/slide/convex/concave/zoom
				// The "normal" size of the presentation, aspect ratio will be preserved
				// when the presentation is scaled to fit different resolutions. Can be
				// specified using percentage units.
				width: 1280,
				height: 720,
				// Factor of the display size that should remain empty around the content
				margin: 0.1,
				// Bounds for smallest/largest possible scale to apply to content
				minScale: 0.2,
				maxScale: 1.5,

				dependencies: [
					{ src: 'reveal.js/plugin/markdown/marked.js' },
					{ src: 'reveal.js/plugin/markdown/markdown.js' },
					{ src: 'reveal.js/plugin/notes/notes.js', async: true },
					{ src: 'reveal.js/plugin/highlight/highlight.js', async: true },
					{ src: 'reveal.js/plugin/math/math.js', async: true },
					{ src: 'reveal.js/plugin/reveal.js-d3/reveald3.js' },
					{ src: 'reveal.js/plugin/reveal.js-plugins/chart/Chart.min.js' },
					{ src: 'reveal.js/plugin/reveal.js-plugins/chart/csv2chart.js' },
				]
			});
		</script>
	</body>
</html>



						<!-- <div class="container fragment"> -->
						<!-- 	<\!-- <div class="col"> <h3> 1 </h3> </div> -\-> -->
						<!-- 	<div class="col"> -->
						<!-- 		<div class="box"> -->
						<!-- 			<div class="box-title"> -->
						<!-- 				Initial Dark Matter -->
						<!-- 			</div> -->
						<!-- 			<img class="plain" data-src="assets/fieldinit.png" height="200"/> -->

						<!-- 		</div>								 -->
						<!-- 	</div> -->
						<!-- 	<div class="col"> <br><br>$\Longrightarrow$ <br>N-Body Simulation  <br>e.g. Particle Mesh Simulations</div> -->
						<!-- 	<div class="col"> -->
						<!-- 		<div class="box"> -->
						<!-- 			<div class="box-title"> -->
						<!-- 				Final Dark Matter -->
						<!-- 			</div> -->
						<!-- 			<img class="plain" data-src="assets/fieldfin.png" height="100"/> -->
						<!-- 		</div> -->

						<!-- 	</div> -->
						<!-- </div> -->
						<!-- <br><br> -->
						<!-- <div class="container fragment"> -->
						<!-- 	<\!-- <div class="col"> <h3> 2 </h3> </div> -\-> -->
						<!-- 	<div class="col"> -->
						<!-- 		<div class="box"> -->
						<!-- 			<div class="box-title"> -->
						<!-- 				Final Dark Matter -->
						<!-- 			</div> -->
						<!-- 			<img class="plain" data-src="assets/fieldfin.png" height="100"/> -->
						<!-- 		</div>								 -->
						<!-- 	</div> -->
						<!-- 	<div class="col">  <br> <br>$\Longrightarrow$ <br> Group Finding Algorithm <br> e.g. Friends of Friends</div> -->
						<!-- 	<div class="col"> -->
						<!-- 		<div class="box"> -->
						<!-- 			<div class="box-title"> -->
						<!-- 				Dark Matter Halos -->
						<!-- 			</div> -->
						<!-- 			<img class="plain" data-src="assets/fieldhalo.png" height="100"/> -->
						<!-- 		</div> -->

						<!-- 	</div> -->
						<!-- </div> -->

						<!-- <br><br> -->
						<!-- <div class="container fragment"> -->
						<!-- 	<\!-- <div class="col"> <h3> 3 </h3> </div> -\-> -->
						<!-- 	<div class="col"> -->
						<!-- 		<div class="box"> -->
						<!-- 			<div class="box-title"> -->
						<!-- 				Dark Matter Halos -->
						<!-- 			</div> -->
						<!-- 			<img class="plain" data-src="assets/fieldhalo.png" height="100"/> -->
						<!-- 		</div>								 -->
						<!-- 	</div> -->
						<!-- 	<div class="col">  <br> <br>$\Longrightarrow$ <br> Semi analytic approaches <br> Distribution Functions</div> -->
						<!-- 	<div class="col"> -->
						<!-- 		<div class="box"> -->
						<!-- 			<div class="box-title"> -->
						<!-- 				Galaxies -->
						<!-- 			</div> -->
						<!-- 			<img class="plain" data-src="assets/fieldgal.png" height="100"/> -->
						<!-- 		</div> -->

						<!-- 	</div> -->
						<!-- </div> -->
<!-- #arrow { -->
<!--     border-right:2px solid black; -->
<!--     border-bottom:2px solid black; -->
<!--     width:10px; -->
<!--     height:10px; -->
<!--     transform: rotate(-45deg); -->
<!--     margin-top:40px; -->
<!-- } -->

