<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Forward Modeling approaches for Cosmological Analysis</title>

		<meta name="description" content="Mexico Presentation">
		<meta name="author" content="Chirag Modi">

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<link rel="stylesheet" href="reveal.js/css/reset.css">
		<link rel="stylesheet" href="reveal.js/css/reveal.css">
		<link rel="stylesheet" href="reveal.js/css/theme/darkenergy.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="reveal.js/lib/css/monokai.css">
		
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'reveal.js/css/print/pdf.css' : 'reveal.js/css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">

				<!-- <section  data-background-image="assets/lsst_stills_0009_crop.jpg" > -->
				<!-- <section  data-background-image="assets/Mayall.jpg" > -->
				<!-- <section  data-background-image="assets/backgroundweb1.jpg" data-background-size="2500px" data-background-color="black" data-background-position='right'> -->
				<!-- <section  data-background-image="assets/backgroundtrail2.jpg" data-background-size="cover" data-background-color="black" > -->
				<section  data-background-image="" data-background-size="cover" data-background-color="black" >

						<div class="container">
							<div class="title" style="margin:auto; text-align:center; border-radius: 20px; background-color:rgba(0, 0, 0, 0.4);">
								<h2> Bayesian Inference for Natural Sciences </h2>
                                                                <h3> with Applications to Astrophysics </h3>
								<h4> SEAS, Harvard University<br>March 21st, 2024</h4>
							</div>
						</div>

						<hr>
						<div style="border-radius: 20px; background-color:rgba(0, 0, 0, 0);">
							<div class="container" >
								<div class="col">
									<div align="left" style="margin-left: 20px;">
										<br>
										<h3>Chirag Modi</h3>
										<p>Center for Computational Astrophysics<br>Center for Computational Mathematics<br>Flatiron Institute</p>
										
										<br>
										
									</div>
								</div>
								<div class="col">
									<img style="position:relative; left:60px" src="assets/fl_logo_transparent.png" class="plain" height="100"></img>
									<!-- <img src="assets/logo_bccp.png" class="plain" height="100"></img> -->
									<br>
									<br>
									<!-- <img src="assets/bids-logo2.png" class="plain" height="150"></img>
									     <img src="assets/desc-logo-inv.png" class="plain" height="200"></img> -->
								</div>
							</div>
						</div>
				</section>

				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				<section data-background-color="black">

					<h3 class='slide-title' style=";"> A snapshot of my scientific interests </h3>

					
					<div class="slide-text" style=";">

						<br>
						
							<div class="block " data-fragment-index="2" style="width:620px">
								<div class="block-title">
									1. Astrophysics and cosmology
								</div>
								<div class="block-content" style="font-size:20px">
									<ul>
                                                                                <li> Large scale structures of the Universe
										        <ul>
                                                                                                
                                                                                                <li> Analytic methods
                                                                                                        <!-- <span style="position:absolute; right:20px"> MNRAS 472,3959(2017); JCAP 08(2017)009; JCAP 03(2020)045...</span>  -->
										                </li>

                                                                                                <li  style="" >  Computational methods (forward modeling) &ensp; <b> $\Longleftarrow$</b>

										                </li>
                                                                                        </ul>
										<li> Galaxy formation
                                                                                        <!-- <span style="position:absolute; right:20px"> In preparation </span> -->
										</li>
									</ul>
									<br>
								</div>
							</div>
							
							<br>
							<div class="block " data-fragment-index="2" style="width:620px">
								<div class="block-title" style="height:40px">
									2. Statistical inference and machine learning
								</div>
								<em style="position:absolute; left:180px; top:340px; text-align:right; color:white; font-size:17px">
									with David Blei, Lawrence Saul, Bob Carpenter, Alex Barnett
								</em>
								<div class="block-content" style="font-size:20px">
									<!-- <span style="">with David Blei, Lawrence Saul, Bob Carpenter, Alex Barnett @Center for Computational Mathematics </span>  -->
										<ul>
										<li> Sampling algorithms
                                                                                        <ul> E.g., Markov Chain Monte Carlo (MCMC) </ul>
                                                                                        <!-- <span style="position:absolute; right:20px"> Bayesian Analysis (2022) </span> -->
                                                                                </li>
										<li> Approximate inference
                                                                                        <ul> E.g., Variational inference </ul>
                                                                                        <!-- <span style="position:absolute; right:20px"> In preparation </span> -->
                                                                                </li>
										<li> Accelerated inference with machine learning
                                                                                        <!-- <span style="position:absolute; right:20px"> ICLR-SimDL (2021), ICML-ML4Astro (2022) </span> -->
                                                                                </li>
										</ul>
									<br>
								</div>
								
							</div>
							<br>
							<div class="block " data-fragment-index="2" style="width:620px">
								<div class="block-title">
									3. Interdisciplinary: statistical methods
								</div>
								<div class="block-content" style="font-size:20px">
									<ul>
										<li> Causal inference in econometrics
                                                                                        <!-- <span style="position:absolute; right:20px"> NeurIPS-Casual ML (2019) </span> -->
                                                                                </li>
										<li> Estimating fatality rates for COVID-19
                                                                                        <!-- <span style="position:absolute; right:20px"> Nature Communications 12,2729 (2021)</span> -->
                                                                                </li>
										<li> Differentiable models & SBI for neutron stars, strong-lensing 
                                                                                        <!-- <span style="position:absolute; right:20px"> Nature Communications 12,2729 (2021)</span> -->
                                                                                </li>
									</ul>
									<br>
									
									<img style='position:absolute; right:300px; top:120px; width:300px' data-src="assets/hysbi_corner_eighth.png"  />
									<img style='position:absolute; right:35px; top:150px; width:250px' data-src="assets/drhmc_2stage.png" />
									<img style='position:absolute; right:200px; top:390px; width:350px' data-src="assets/causal_catax.png" />
								</div>
							</div>
							<div style="position:absolute; float:right;  text-align:right; font-size:16px; top:610px; right:10px">
								<b><u> Modi</b></u> and Philcox (2023) <br>
								<b><u> Modi</b></u> and Seljak (2019) <br>
								<b><u> Modi</b></u>, Carpenter and Barnett (2022) <br>
							</div>
				</section>
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->

				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
                                
				<section>
                                        <section data-background-color="black">

					        <h3 class='slide-title' style="position:absolute;top:0;"> Bayesian inference </h3>
                                                
                                                <br>
                                                <br>
					        <div class="slide-text" style="margin-left:50px;">
                                                        
                                                        We wish to learn about <u>parameters</u>: $\theta \in \mathcal{R}^D$ <br>
                                                        $$\textrm{Prior:} \quad \theta \sim p(\theta)$$
                                                        
                                                        We observe <u>data</u> ($x$)  which is informtive about these parameters <br>
                                                        Probabilistic model: $f(\theta \rightarrow x)$
                                                        $$\textrm{Likelihood:} \quad x \sim p(x|\theta)$$
                                                        
                                                        Inference: 
                                                        $$\textrm{Posterior:} \quad x \sim p(\theta | x)$$
                                                        
                                                        Bayes theorem:
                                                        $$p(\theta | x)  = \frac{p(x|\theta) \times p(\theta)}{p(x)} \propto p(x|\theta) \times p(\theta)$$
                                                        
                                        </div>
                                        
                                        </section>

                                        <!-------------------------------------------------------------------------------->

                                        <section data-background-color="black">

                                                <h3 class='slide-title' style="position:absolute;top:0;"> Inferential tasks </h3>
                                                
                                                <br>
                                                <br>
					        <div class="slide-text" style="margin-left:50px;">

					                <div class="container">
                                                                
						                <div class="col" style="flex: 0 0 33em;">
                                                                        $p(\theta | x)$ directly is rarely useful. We are actually interested in :
                                                                        <br>
                                                                        <br>
                                                                        
                                                                        <ul>
                                                                                <li> Parameter estimates: $\hat{\theta}$, $\hat{\theta}^2...$
                                                                                        $$ \hat{\theta}  = \int \theta\, p (\theta | x) \, \textrm{d} \theta$$
                                                                                </li>
                                                                                <br>
                                                                                <li> Event probabilities i.e. $g(\theta) \in A$
                                                                                        $$ p(A) = \int I(g(\theta) \in A )\, p (\theta | x) \,  \textrm{d} \theta$$
                                                                                </li>
                                                                                <br>
                                                                                <li> Posterior predictive probabilities of new events $\tilde x$
                                                                                $$ p (\tilde x | x) = \int p (\tilde x | \theta)\, p (\theta | x) \, \textrm{d} \theta$$
                                                                                </li>
                                                                                <br>
                                                                        </ul>
                                                                </div>
                                                                
                                                                <div class="col fragment" style="flex: 0 0 30em;">
                                                                        Approximate these integrals with Monte-Carlo integration:
                                                                        
                                                                        $$ \hat{\theta}  = \int \theta\, p (\theta | x) \, \textrm{d} \theta \approx \sum_{\theta_i \sim p(\theta | x)} \theta_i$$

                                                                        $\longrightarrow$ Draw samples from the posterior distribution.
                                                                </div>
                                                </div>
                                                
                                        </section>
                                        
                                </section>
                                
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				<section>

                                        <section data-background-color="black">
					        <h3 class='slide-title' style="position:absolute;top:0;"> Cosmology: the story of our Universe </h3>
					        <div class="container">

						<div class="col" style="flex: 0 0 33em;">
							<img class="plain" src="assets/WMAP_timeline.jpg" width="800px"/>
						</div>
						
						<div class="plain  fragment current-visible" data-fragment-index="1" style="position:absolute; top:150px; right:30px; height:400px; text-align:right; font-size:20px">
							<img class="plain" data-src="assets/sdss_pie2.jpg" />
							<br>
							Credits: M. Blanton and SDSS
						</div>
						<div class="col" style="flex: 0 0 20em;">

							<br>
							
							<div class="fragment" data-fragment-index="2" style="">
 							        Standard model:<b class="alert"> $\Lambda$-CDM </b> <br>  
							        $\Lambda$: cosmological constant dark energy <br>
                                                                CDM: Cold dark matter

							</div>
							<br>
							<br>
							<div class="block fragment current-visible" data-fragment-index="2" >
								<div class="block-title">
 									6 parameters in $\Lambda$-CDM model
 								</div>
								<div class="block-content" style="font-size:20px">
                                                                        $$\theta = (\Omega_b, \Omega_m, H, \tau, \sigma_8, n_s)$$ 

									<ol>
										<li>baryon density fraction ($\Omega_b$)</li>
										<li>dark matter density fraction ($\Omega_m$)</li>
										<li>rate of acceleration of the Universe ($H$)</li>
										<li>optical depth at reionization ($\tau$) </li>
										<li>amplitude of density fluctuations ($\sigma_8$)</li>
										<li>scalar spectral index ($n_s$)</li>
									</ol>
                                                                        <br>
                                                                        <!-- Extended models: -->
                                                                        <!-- <ol> -->
                                                                        <!--         Massive neutrinos ($m_\nu$)  -->
                                                                        <!--         Massive neutrinos ($m_\nu$)  -->
                                                                        <!-- </ol> -->
	 							</div>
                                                                
							</div>
                                                        <br>

							<!-- <img class="plain fragment current-visible" data-fragment-index="2" data-src="assets/lcdm.png" /> -->
							
							<div class="block fragment" data-fragment-index="3" style="position:absolute; top:250px; right:30px; width:400px">
								<div class="block-title">
									Open questions
								</div>
								<div class="block-content" style="font-size:20px">
									<ul>
										<li>What is dark energy?</li>
										<li>What is dark matter made of?</li>
										<li>How did inflation happen?</li>
										<li>What are the masses of neutrinos?</li>
										<li>Is general relativity correct?</li>
										<li>...</li>
									</ul>
									<br>
								</div>
								
							</div>
							
						</div>
					</div>
                                                        
                                                        
                                        </section>
                                        
				        <!-------------------------------------------------------------------------------->
                                        
                                        <section data-background-color="black">
					        
						<h3 class='slide-title'>Next generation of cosmology</h3>
						<br>
						<div class="container" style="font-size:20px; ">
                                                        <div class="col" style="flex: 0 0 42em;">

								<div class="plain" style="position:absolute; top:90px; left:50px">
									<img src="assets/desi_telescope.jpg" class="plain" height="150" width="250" style="border:none"></img>
									<div style="position:relative; top:-75px; left:-60px; " > DESI </div>
								</div>
								<div class="plain" style="position:absolute; top:90px; left:300px">
									<img src="assets/euclid_telescope.jpg" class="plain"  height="150" width="250" style="border:none"></img>	
									<div style="position:relative; top:-75px; left:50px" > Euclid </div>
								</div>
								<div class="plain" style="position:absolute; top:90px; left:550px">
									<img src="assets/spherex_telescope.jpg" class="plain" height="150" width="250" style="border:none"></img>
									<div style="position:relative; top:-75px; left:70px" > SphereX</div>
								</div>
								
								<div class="plain" style="position:absolute; top:280px; left:160px">
									<img src="assets/lsst_telescope.jpg" class="plain" height="150" width="250" style="border:none"></img>
									<div style="position:relative; top:-160px; left:-80px" > LSST</div>
								</div>
								<div class="plain" style="position:absolute; top:280px; left:440px">
									<img src="assets/SO_telescope.jpg" class="plain" height="150" width="250" style="border:none"></img>
									<div style="position:relative; top:-105px; left:-60px" >Simons<br>Observatory</div>
								</div>
								
								<div class="plain" style="position:absolute; top:480px; left:50px">
									<img src="assets/roman_telescope.jpg" class="plain" height="150" width="250" style="border:none"></img>
									<div style="position:relative; top:-75px; left:-70px" > Roman<br>Telescope</div>
								</div>
								<div class="plain" style="position:absolute; top:480px; left:300px">
									<img src="assets/hirax_telescope.jpg" class="plain" height="150" width="250" style="border:none"></img>
									<div style="position:relative; top:-50px; left:-70px; color:white" > HIRAX </div>
								</div>
								<div class="plain" style="position:absolute; top:480px; left:550px">
									<img src="assets/cmbs4_telescope.jpg" class="plain" height="150" width="250" style="border:none"></img>
									<div style="position:relative; top:-50px; left:-60px; color:black;" >CMB-S4</div>
								</div>
                                                                
							</div>
                                                        
                                                        <div class="col fragment" data-fragment-index="0" style="flex: 0 0 20em;">
                                                                
                                                                  <!-- <img src="assets/desi_telescope.jpg" class="plain" height="150" width="250" style="border:none"></img> -->
								<br>
								<div class="fragment" data-fragment-index="0">
									<b class="alert"> Dark Energy Spectroscopic Instrument (DESI) </b>
									<br>
									<ul style="">
										<li> One-third of the night sky over 5 years</li>
										<li> 35 million galaxies and quasars</li>
										<li class="fragment" data-fragment-index="0"> Has mapped out <b><u> more galaxies than all of the previous 3D surveys combined.</u></b>
                                                                                        <ul>
                                                                                                $\rightarrow$ 1.2 million galaxies in the first 6 months, same as BOSS survey in 5 years.
                                                                                        </ul> 
									</ul>
								</div>
								<br>
								<img class="plain fragment fade-in"  data-fragment-index="0" data-src="assets/sdss_vs_desi.jpg" style="position:absolute; right:20px; width:450px; height:210px" />
								<br>
 								<div class="fragment"  data-fragment-index="0" style="position:absolute; font-size: 16px; top: 650px; right:20px">
									DESI Collaboration: 1611.00036</div>
							</div>
							                         
                                                </div>
                                                
						<br>
						
                                                
                                        </section>
                                        
				        <!-------------------------------------------------------------------------------->
                                        
                                        <section data-background-color="black">

					        <h3 class='slide-title' style=""> How do we extract information from this dataset? </h3>
                                                
                                                <br>
                                                <br>
                                                <div class='container'>
							<div class="col" style="flex:0 0 30em; margin-left:20px; font-size:22px">
                                                                
								<ul>
                                                                        Data ($x$) : 2-point correlation function or power spectrum
                                                                        
								        <div class="plain fragment current-visible" data-fragment-index="1" style="position:absolute; top:300px; left:200px; height:150px">
									        $$\xi(|r_1-r_2|) = \langle \delta(r_1) \delta(r_2) \rangle$$
									        <img class="plain " data-fragment-index="1" style="position:relative; left:0px" data-src="assets/2ptcorrelation.png" />
								        </div>
                                                                        
                                                                        <br>
                                                                        <br>

                                                                        <span  class="plain fragment" data-fragment-index="2" > Can be modeled theoretically using effective field theories (EFT)
                                                                                <br>
                                                                                <span style="font-size:20px">
                                                                                        $$p(x | \theta) = \mathcal{N}(\mu (\theta), \Sigma (\theta))$$
                                                                                </span>
                                                                        </span>
                                                                        <span class="plain fragment" data-fragment-index="4"> Infer the posterior on model parameters using Bayesian inference:
										<span style="font-size:20px"> $\,p(\theta | x ) \propto p(x | \theta)  \ p(\theta)$ </span>
                                                                                
                                                                        </span>

                                                                </ul>
								<br>
								<br>
								<div class="plain fragment" data-fragment-index="5" style="text-align:center">
									<!-- <div class="alert "  > Moving ahead, each of these steps is a limiting factor! </div> -->
									<em  > However this is not sufficient moving forward! </em>
								</div>
                                                                        
                                                        </div>
						        
							<div class="col" style="font-size:20px">
								<div>
                                                                        <img class="plain" data-fragment-index="1" style="position:absolute; top:0px; right:50px; height:200px" data-src="assets/sdss_pie2.jpg" />
                                                                        <span style="position:absolute; text-align:right; right:10px; top:200px; font-size: 16px"> Credit: SDSS
                                                                        </span>
                                                                </div>

								<div class="plain fragment current-visible" data-fragment-index="1" style="position:absolute; top:250px; right:100px; height:280px; font-size:20px">
									<img  data-src="assets/boss_dr12_fit_corr.png" />
									<br>
									<em> Measurement of 2-pt correlation function from BOSS survey </em>
								</div>
								
								<div class="plain fragment current-visible" data-fragment-index="2" style="position:absolute; top:250px; right:100px; width:500px; font-size:20px">
									<img data-src="assets/pk_eqn3.png" />
									<br>
									<em> An example of EFT integrals to predict the mean of the power-spectrum </em>
                                                                        
								</div>
 								<div class="plain fragment current-visible" data-fragment-index="4" style="position:absolute; top:250px; right:120px; height:360px;; font-size:20px;">
									<img src="assets/misha_constraints.png" />
									<br>
									<em style="position:relative; top:-10px"> Example constraints from BOSS data analysis </em>
								</div>
								
							</div>

                                                        <span class="container fragment fade-in" data-fragment-index="5" style="position:absolute; top:420px; left:120px; width:1000px; height:300px; font-size:20px; " >
							        <div class='col '  style="top:50px">
								        <img data-src="assets/ngfield0.png" class="plain" style="top:10px; height:240px;"/>
								        <span style="position:relative; top:-20px;" >
									        Our Universe
								        </span>
							        </div>
							        <div class='col  ' style="top:50px">
								        <img data-src="assets/gfield0.png" class="plain " style="height:240px;"/>
								<span style="position:relative; top:-20px;" > Gaussian random field </span>
                                                                
							        </div>
							        <div class='col  ' style="top:50px">
								        <br>
								        <img data-src="assets/ngfield0_pk_white.png" class="plain " style="height:190px;"/>
								<br>
								<br>
								<span style="position:relative; top:-20px;" > Power spectrum </span>
							        </div>
							        
                                                        </span>

                                                        <div class="plain fragment current-visible" data-fragment-index="1" style="position:absolute; top:600px; right:20px; font-size: 16px; text-align:right">
								Ross et al. (2016)<br>
								Beutler et al. (including <b><u> CM</b></u>) (2016)</div>
							<div class="plain fragment current-visible" data-fragment-index="2" style="position:absolute; top:600px; right:20px; font-size: 16px; text-align:right">
								Ross et al. (2016)<br>
								Beutler et al. (including <b><u> CM</b></u>) (2016)</div>
							<div class="plain fragment current-visible" data-fragment-index="4" style="position:absolute; top:680px; right:20px; font-size: 16px">
								Ivanov, Simonovic, Zaldarriaga (2020)</div>

						</div>
                                                
                                                
                                        </section>
                                        
                                        
                                </section>
                                
                                
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->

                                <section> 
                                        <section data-background-color="black">


                                                <h3 class='slide-title' style=""> Field-level inference: holy-grail of cosmological analysis </h3>


                                                <br>
                                                Model the field-level data without any compression and use it for inference.

                                                <div class="slide-text", style="position:relative;">
                                                        <br>
                                                        <br>

                                                        <span class="fragment " data-fragment-index="1"> No information is lost by compressing data into low-dimensional summary statistics.
                                                        </span>
                                                        <br>
                                                         <img class="fragment plain"   data-fragment-index="1" width="350px" height="300px" style="position:relative;top:50px;left:250px" data-src="assets/field_level_prelim.png" />
                                                        <br>

                                                        <div class="fragment  " data-fragment-index="1" style="font-size: 16px; position:relative; top:80px; left:-20px; text-align:right;">
                                                                <b><u>Modi</u></b> et al. (in preparation)
                                                                <br>
                                                                <b><u>Modi</u></b>, Feng, Seljak (2017)
                                                                <br>
                                                                Leclercq and Heavens (2021)
                                                        </div>
                                                </div>

                                                <div>
                                                        <img class="plain fragment grow" data-fragment-index="1" style="position:absolute; top:175px; right:165px; height:200px"
                                                             data-src="assets/sdss_pie2.jpg" />
                                                        <img class="plain fragment semi-fade-out" data-fragment-index="1" style="position:absolute; top:425px; right:120px; height:200px"
                                                             data-src="assets/boss_dr12_fit_corr.png" />
                                                  </div>
                                                
                                        </section>
                                        
                                        <!-------------------------------------------------------------------------------->

                                        <section data-background-color="black">


                                                <h3 class='slide-title' style=""> Modeling for field-level inference </h3>
                                                
                                                <br>
						$x \sim  f(\theta)$ <br>
						<div style="font-size:20px" > data $\sim$ probabilistic forward model (cosmology) </div>

						<div class="container" style="font-size:20px">
                                                        <div class='col fragment' data-fragment-index="1" >
								<br>
								<br>
                                                                $\Lambda$
                                                                <br>
								<b class="alert"> Cosmology </b>
								<div style="font-size:30px"> + </div>
								<img data-src="assets/modes.png" class="plain" style="position:relative; top:-30px; height:150px;"/>
								<br>
								<b class="alert" style="position:relative; top:-50px; ;"> Initial phases <br> $z \sim {N}(0, 1)$</b>
							</div>

							<div class='col fragment' data-fragment-index='2'>
								<img data-src="assets/fieldinit.png" class="plain" style="height:200px;"/>
                                                                <br>
								<b class="alert"> Initial (Linear) <br>Dark Matter </b>
							</div>
							<div class='col fragment' data-fragment-index='3'>
								<img data-src="assets/fieldfin.png" class="plain " style="height:200px;"/>
								<br>
                                                                <b class="alert"> Final (Evolved) <br> Dark Matter </b>
							</div>
							<div class='col fragment' data-fragment-index='4'>
								<img data-src="assets/fieldgal.png" class="plain " style="height:200px;"/>
                                                                <br>
                                                                <b class="alert"> Galaxies <br> (Data, $x$) </b>
							</div>
							<!-- <div class='col fragment' data-fragment-index='6'> -->
                                                        <!--         $x = f(\Lambda)$ -->
							<!-- 	<br> -->
                                                        <!--         <br> -->
                                                        <!--         <b class="alert"> Data </b> -->
							<!-- </div> -->
                                                         
						</div>
                                                
						<!-- <img class="plain fragment" data-fragment-index="0" style="position:absolute; top:90px; right:20px; width:300px;" data-src="assets/pk_eqn3.png" /> -->
						
						<div class="container" style="position:absolute; top:325px; width:1000px; height:50px; left:130px; font-size:35px">
							<div class='col fragment' data-fragment-index='2'>  $\rightarrow$ </div>
							<div class='col fragment' data-fragment-index='3'>  $\rightarrow$ </div>
							<!-- <div class='col fragment' data-fragment-index='4'>  $\rightarrow$ </div> -->
							<div class='col fragment' data-fragment-index='4'>  $\rightarrow$ </div>
							<!-- <div class='col fragment' data-fragment-index='6'>  $\rightarrow$ </div> -->
						</div>
                                                                                                
						<div class="container" style="position:relative; top:-10px; width:1000px; height:50px; left:0px; margin:0 auto; font-size:18px">
							<div class='col fragment' data-fragment-index='2'>  Boltzmann <br> equations </div>
							<div class='col fragment' data-fragment-index='3'>  Gravity evolution <br> (N-Body simulations) <br> ($\mathbf{\Lambda}$) </div>
							<!-- <div class='col fragment' data-fragment-index='4'>  Group Finding <br> algorithms <br>  ($\mathbf{\theta}$) </div> -->
							<div class='col fragment' data-fragment-index='4'>  Galaxy models & <br>survey systematics <br> ($\mathbf{\phi}$)  </div>
							<!-- <div class='col fragment' data-fragment-index='6'>  Survey systematics <br> & summarize<br> ($\mathbf{\theta}$)  </div> -->
						</div>
                                                <img class="plain  fragment fade-out" data-fragment-index="3" style="position:absolute; top:10px; right:20px; height:250px;" data-src="assets/WMAP_timeline.jpg" />
                                                <span class="fragment fade-out" data-fragment-index="4">
                                                        <img class="plain  fragment fade-in" data-fragment-index="3" style="position:absolute; top:10px; right:20px;;" data-src="assets/nbodysim.gif" />
                                                </span>
                                                <img class="plain  fragment fade-in" data-fragment-index="4" style="position:absolute; top:50px; right:20px; height:150px;" data-src="assets/galaxypeaks.jpg" />

                                                <div class='fragment' data-fragment-index='6'>
                                                        $$\theta = (\Lambda, z, \phi)$$
                                                </div>
						

                                        </section>
                                        
                                        
                                        
                                        <!-------------------------------------------------------------------------------->

                                        <section data-background-color="black">


                                                <h3 class='slide-title' style=""> Challenges for inference </h3>


						$x \sim  f(\Lambda, z, \phi)$
                                                <br>
                                                <br>
						<div class="slide-text" style="font-size:20px">

                                                        <ol>
                                                                <li> High-dimensional inference <br>
                                                                        $\rightarrow$ $z$ can be billions on unknown parameters
                                                                </li>
                                                                <br>
                                                                <li> Computationally expensive models <br>
                                                                        $\rightarrow$ $N$-body simulation under gravity
                                                                </li>
                                                                <br>
                                                                <li> Hierarchical model <br>
                                                                        $\rightarrow$ Difficult posterior geometry
                                                                </li>
                                                                        
						        </ol>

                                                        <br>
                                                        <br>
                                                        <br>
                                                        <br>
                                                        <div class="fragment" data-fragment-index="1" style="width:500px; text-align:center">
                                                                <b> Bayesian inference problems or inverse problems span all natural and social science disciplines.</b> 
                                                        </div>
                                                </div>
                                                                  
                                                <img class="plain  fragment " data-fragment-index="1" style="position:absolute; top:50px; right:20px; height:350px;" data-src="assets/ocean_temp.png" />
                                                <img class="plain  fragment " data-fragment-index="1" style="position:absolute; top:140px; right:400px; height:250px;" data-src="assets/md_hierarchical.png" />
                                                <img class="plain  fragment " data-fragment-index="1" style="position:absolute; top:420px; right:350px; height:200px;" data-src="assets/tracer_travel.png" />
                                                <img class="plain  fragment " data-fragment-index="1" style="position:absolute; top:420px; right:35px; height:200px;" data-src="assets/tracer_hydrolichead.png" />
						<div class="plain fragment " data-fragment-index="1" style="position:absolute; top:650px; right:20px; font-size: 16px">
							Woodbury and Rubin. (2000);  Kulakova, Arampatzis et al. (2017);  Conrad, Davis et al. (2017);  Dong, Haines et al. (2021)
                                                </div>
                                                        
                                        </section>
                                        
                                </section> 
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				<section data-background-color="black">

					<h3 class='slide-title' style="position:absolute;top:0;"> Outline of the talk </h3>

                                        <br>
                                        <br>
                                        Advances in Bayesian inference for natural sciences. 
                                        <br>
                                        <br>
					<div class="slide-text">
                                                
                                                <ul>
                                                        <li> Explicit Inference: when you have access to the data likelihood $p(x|\theta)$.  </li>
                                                        <br>
                                                        <ul>
                                                                <li> Automatic differentiation: tools to facilitate inference </li>
                                                                <li> Algorithms for high-dimensional inference
                                                                        <ul>
                                                                                $\rightarrow$ Variational Inference (VI) <br>
                                                                                $\rightarrow$ Hamiltonian Monte-Carlo (HMC)
                                                                        </ul>
                                                                </li> 
                                                                <li> Advances in HMC and VI. </li>
                                                        </ul>
                                                        <br>
                                                        <li> Implicit Inference: when we do not have access to the data likelihood explicitly. </li>
                                                        <br> 
                                                        <li> Putting it all together </li>
                                                </ul>
                                        </div>
                                        
                                </section>

				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				<section data-background-color="black">


                                        <div style="font-size:40px">
                                                Explicit inference: automatic differentiation
                                        </div>
                                        
                                </section>

				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				<section>
                                        <section data-background-color="black">

					<h3 class='slide-title' style="position:absolute;top:0;"> Differentiable probabilistic models </h3>

						<br>
						<br>
						<div class="slide-text">
							
							<div class="container">
                                                        	<div class="col" style="flex: 0 0 30em;" >
									<ul>
										<li class=" plain " > High-dimensional inference<br>
											<div style="font-size:20px">  Initial conditions at all points in the Universe $\sim$ over a million unknown parameters </div>
											
  										</li>
										<br>
										<li class="fragment" data-fragment-index="1"> Gradient based inference algorithms <br>
											<div style="font-size:20px">
												E.g. gradient descent, Hamiltonian Monte Carlo (HMC) <br>
											</div>
										</li>
										<br>
                                                                                <li class="fragment " data-fragment-index="1"> 	 Response of likelihood with respect to underlying parameters. </li>
                                                                                <br>
										<div class="fragment " data-fragment-index="1" style="position:relative; left:100px ">
											$g = \frac{\partial\, p(x| \theta)}{\partial\, \theta}$
											<br> 
										</div>
                                                                                <!-- <li class="fragment " data-fragment-index="3"> 	Hammer behind the machine learning revolution. </li> -->
                                                                                <br>
										<br>
									</ul>
								</div>
								<div class="col" style="flex: 0 0 21em; text-align:center">
									<div  class="plain fragment fade-in" data-fragment-index="3" style="position:absolute; top:200px; right:120px; width:400px; font-size:20px">
                                                                                <img data-src="assets/pmwd_table_closed.png" />
                                                                                <br>
                                                                                <em> Examples of differentiable codes upto 2017 </em>
                                                                        </div>

                                                                        <br>
									<div class="fragment " data-fragment-index="4" style="position:absolute; top:430px; right:20px; width:600px; font-size:20px">
										<b> Automatic differentiation:</b> the hammer behind deep learning <br>
										$\longrightarrow$  TensorFlow, JAX and more
										<br>
									<img class=" plain fragment " data-fragment-index="4" style="position:absolute; top:50px; right:300px; width:200px"
									     data-src="assets/TF_FullColor_Horizontal.png" />
									<img class=" plain fragment " data-fragment-index="4" style="position:absolute; top:50px; right:100px; width:100px; height:50px"
									     data-src="https://raw.githubusercontent.com/google/jax/master/images/jax_logo_250px.png"  />
 									
									</div>
									

								</div>
								<div  class="fragment"  data-fragment-index="3" style="position:absolute; top:600px; right:20px; font-size:16px; text-align:right">
									Jasche & Lavaux (2018) <br>
									Wang, Mo, Yang, Bosch (2014) <br>
								</div>
							</div>
							
						</div>
					</section>
                                        
                                        <!-------------------------------------------------------------------------------->
					<!-------------------------------------------------------------------------------->
					
					<section>
						<h3 class='slide-title'> Differentiable cosmological simulations</h3>

						<br>
						<div class='container'>
							<div class='col slide-text' style="flex: 0 0 28em; font-size:22px">
								<ul>
									<li>
										<b class="alert "> FlowPM</b>: the first particle-mesh simulations in TensorFlow <br>
										<ul class="plain" data-fragment-index="1" style="font-size:20px">
											<li> Automatic differentiation
											</li>
											<li> Access to SOTA inference algorithms
											</li>
											<li>  Seamless interfacing with deep-learning tools 
											</li>
										</ul>
									</li>
									<br>
									
									<li class="fragment" data-fragment-index="3"> 
										Reconstructing the Universe in 10 lines
									</li>

                                                                        <br>

									<li class="fragment" data-fragment-index="4"> Memory limited
										<ul class="fragment" data-fragment-index="4" style="font-size:20px ">
											<li> <b class="alert" style="font-size:22px"> $pmwd$</b><font color="white">: particle mesh with derivatives </font></li>
											<li > Exploit reversibility of leapfrog integration. </li>
											<li> Constant memory frootprint  </li>
										</ul>
									</li>

									<br>
                                                                        <li class="fragment" data-fragment-index="6" style="">	GPU accelerated simulations
                                                                                <br>
                                                                                <br>
                                                                                <div style="position:relative; top:20px; font-size: 18px; left:-220px; text-align:center;" >
											Timings for <br> 1 step of <br> 256$^3$ sim.
										</div>
                                                                                <div style=" position:relative; top:-80px; left:0px; font-size:20px">
                                                                                        <table   style=" font-size:20px; width:300px">
                                                                                                <tbody>
                                                                                                        <tr>
                                                                                                                <td>FastPM</td>
                                                                                                                <td>1 CPU</td>
                                                                                                                <td>40s</td>
                                                                                                        </tr>
                                                                                                        <!-- <tr> -->
                                                                                                        <!--         <td>FastPM</td> -->
                                                                                                        <!--         <td>32 CPU</td> -->
                                                                                                        <!--         <td>3s</td> -->
                                                                                                        <!-- </tr> -->
                                                                                                        <tr>
                                                                                                                <td>FlowPM</td>
                                                                                                                <td>1 GPU</td>
                                                                                                                <td>1s</td>
                                                                                                        </tr>
                                                                                                        <!-- <tr> -->
                                                                                                        <!--         <td>FlowPM</td> -->
                                                                                                        <!--         <td>32 GPU</td> -->
                                                                                                        <!--         <td>0.4s</td> -->
                                                                                                        <!-- </tr> -->
                                                                                                        <tr>
                                                                                                                <td>$pmwd$</td>
                                                                                                                <td>1 GPU</td>
                                                                                                                <td>0.01s</td>
                                                                                                        </tr>
                                                                                                </tbody>
                                                                                        </table>
                                                                                        <div style=" position:relative; top:-65px; left:450px;" >
                                                                                                <!-- $\Big\}$ 10x faster -->
                                                                                                $\rightarrow$ 10x faster
                                                                                                <br>
                                                                                                <div style="position:relative; top:11px" >
                                                                                                        $\rightarrow$ 100x faster </div>
                                                                                        </div>
                                                                                </div>
										<br>
										<em  class="plain fragment " data-fragment-index="7" style="position:relative;font-size:20px; top:-140px; left:20px" >$pmwd$ is faster than deep learning emulators   </em>

									</li>
								</ul>
								
								<br>
								
								<div class="container" style="position:relative; top:-450px">
									<div class="col fragment current-visible" data-fragment-index="3">
										<img class="plain" data-src="assets/reconim_init.gif" style='height:120px;' />
									</div>
									
									<div class="col fragment current-visible" data-fragment-index="3">
										<img class="plain" data-src="assets/reconim_fin.gif" style='height:120px;' />
									</div>
									
									<div class="col fragment current-visible " data-fragment-index="3">
										<img class="plain" data-src="assets/fin_field.png" style='height:120px;' />
									</div>
									<br>
								</div>
								
								
								
							</div>
							
							<div class='col' style="flex: 0 0 28em;">

								<div style="">
								
									<img  class="plain  fragment fade-out" data-fragment-index="3" style="position:absolute; top:150px; right:100px; width:450px"
									      data-src="assets/pmwd_table_flowpm.png" />
									<img  class="plain fragment current-visible" data-fragment-index="4" style="position:absolute; top:150px; right:100px; width:450px"
									      data-src="assets/pmwd_table_flowpm.png" />
									<img  class="plain fragment"  data-fragment-index="4" style="position:absolute; top:150px; right:100px; width:450px"
									      data-src="assets/pmwd_table.png" />
									
									<div class="fragment current-visible" data-fragment-index="3" style="position:absolute; top:130px; right:20px">
									  <pre  ><code data-trim data-noescape style="height:80em;width:49em;">
									  import tensorflow as tf
									  import flowpm

									  #Run simulation from variable initial conditions
									  linear = tf.get_variable('linear', shape=(nc, nc, nc),
												 initializer=tf.random_normal_initializer(), trainable=True)
									  initial_conditions = flowpm.lpt_init(linear, name='icstate')
									  final_state = flowpm.nbody(initial_conditions, stages, nc, name='fnstate')
									  final_field = flowpm.cic_paint(tf.zeros_like(linear), final_state[0], boxsize=bs)

									  #Likelihood term: ((data-model)/noise)^2
									  residual = tf.multiply(tf.subtract(final_field, data), 1/sigma)
									  neg_log_likelihood = tf.reduce_sum(tf.multiply(residual, residual))

									  #Prior: (linear_modes^2 / linear_power_spectrum)
									  lineark = flowpm.r2c3d(linear, norm=nc**3)
									  neg_log_prior = tf.square(tf.cast(tf.abs(lineark), tf.float32))
									  neg_log_prior = tf.reduce_sum(tf.multiply(neg_log_prior, 1/priorwt))j

									  #Loss & optimize
									  loss = tf.add(neg_log_likelihood, neg_log_prior, name='loss')
									  optimizer = ScipyOptimizerInterface(loss, var_list=[linear], 'L-BFGS-B')
									  with tf.Session() as session:
									      optimizer.minimize(session)
									      recon = session.run(linear)
									  </code></pre>
								</div>

 							
								<img  class="plain fragment " data-fragment-index="4"
								      style="position:absolute; top:350px; right:190px; width:300px" data-src="assets/pmwd_logo.svg" />
								
								<!-- <img  class="plain fragment current-visible" data-fragment-index="6" style="position:absolute; top:200px; right:30px; width:600px" -->
								<!--       data-src="assets/flowpm_lptcompare.png"/> -->
								<!-- <div  class="plain fragment " data-fragment-index="6" style="position:absolute; top:130px; right:100px; width:460px; font-size:16px" > -->
								<!--         <img data-src="assets/pmwd_timing.png" /> -->
                                                                <!--         <em style="position:relative; top:-10px"> time-scaling for $pmwd$ simulations<br> -->
                                                                <!--         <span class="plain fragment " data-fragment-index="7" > $\rightarrow pmwd$ is faster than deep learning emulators </span>   </em>  -->
                                                                <!-- </div> -->
								

								<div   style="position:absolute; top:580px; right:20px; font-size:16px; text-align:right">
									<span class="plain fragment fade-out " data-fragment-index="4" > 
										<b> <u>Modi</u></b>, Lanusse, Seljak (2020) <br>
									        Seljak, Aslanyan, Feng, <b> <u>Modi</u></b> (2017) <br>
										<a href="https://github.com/DifferentiableUniverseInitiative/flowpm">https://github.com/DifferentiableUniverseInitiative/flowpm</a> <br>
									</span>
									<img  class="plain fragment" data-fragment-index="4"
									      style="border:none; width:130px; height:110px; position:absolute; top:-50px; left:0px "
									      data-src="../assets/epod.jpg" />
									
									<span  class="plain fragment" data-fragment-index="4" style="position:relative; top:-100px; font-size:16px">
										<b> <u>Modi</u></b>, Lanusse, Seljak (2020) <br>
									        Seljak, Aslanyan, Feng, <b> <u>Modi</u></b> (2017) <br>
										Li, <b><u>Modi</u></b> et al. (2022) <br>
										Kwan, <b><u>Modi</b></u>, et al. (2022) <br>
										Li, Lu, <b><u>Modi</u></b> et al. (2022) <br>
									        <a href="https://github.com/eelregit/pmwd">https://github.com/eelregit/pmwd</a> <br>
										<a href="https://github.com/DifferentiableUniverseInitiative/flowpm">https://github.com/DifferentiableUniverseInitiative/flowpm</a> <br>
									</span>
									
								</div>
								
								</div>
							</div>
							
							
						</div>
					</section>
                                        
                                </section>

				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				<section data-background-color="black">
                                        

                                        <div style="font-size:40px">
                                                Explicit inference:<br>
                                                Hamiltonian Monte Carlo (HMC)
                                        </div>
                                        
                                </section>

                                
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				<section>

					<section>
						<h3 class='slide-title'> Markov Chain Monte Carlo (MCMC) </h3>
						
						<br>
						<div style="position:absolute; top:30px; right:20px; width:600px; text-align:right; font-size:20px">
                                                        Goal: Generate samples from the posterior <span style="font-size:20px" > $p(\theta|x)$ </span> <br>
                                                        to approximate expectations  <span style="font-size:20px" > $\int f(\theta) p(\theta | x) \mathrm{d}\theta$</span>.
                                                </div>
						<br>
						<div class="container" style="font-size:20px">

							<div class="col" style="flex:0 0 38em;"> 
								<div class="plain " >
                                                                        <u><b>Metropolis Hastings:</b></u>
                                                                        <br>
                                                                        <br>
                                                                        <div style="text-align:left; margin-left:20px" >
                                                                                Construct a Markov chain with probabilistic transition kernel <span style="font-size:18px" >  $\, k(\theta \rightarrow \theta')$</span>.
                                                                                <br>
                                                                                Accept the proposed point with probability
                                                                                <span style="font-size:18px" >
                                                                                        $\alpha = \mathrm{min}\Big(1, \frac{p(\theta'|x)\, k(\theta' \rightarrow \theta)}{p(\theta|x)\, k(\theta \rightarrow \theta')}\Big)$
                                                                                </span>
                                                                        </div>
                                                                </div>
                                                                
                                                                <br>
                                                                <br>
                                                                
								<div class="plain fragment" data-fragment-index="1">
                                                                        
                                                                        <u><b>Hamiltonian Monte Carlo:</b></u>
                                                                        <br>
                                                                        <br>
                                                                        <div style="text-align:left; margin-left:20px" >
                                                                                
                                                                                Construct an Hamiltonian system:  <span style="font-size:18px" >  $H(\theta, u) = U(\theta) + K(u)$ </span>
                                                                                <br>
                                                                                <br>
									        $\rightarrow$ interpret parameters as positions with potential energy
									        <span style="font-size:18px" > $U(\theta) = -\log p(\theta|x)$ </span> 
                                                                                <br>
									        $\rightarrow$ introduce auxillary momentum, $u$, with kinetic energy $K(u)= \frac{u^TM^{-1}u}{2}$ <br>
								                <br>
									        <!-- <li class="fragment" data fragment-index="2">introduce an auxiliary momentum $(p)$ for each parameter & construct Hamiltonian -->
									                <!-- 	$$H(x) = H(q, p) = U(q) + \frac{1}{2}p^TMp$$ -->
									                <!-- </li> -->
								                <span class="fragment" data fragment-index="2"> Generate proposals for the Markov chain by simulating Hamiltonian dynamics
                                                                                        <span style="font-size:20px" >
                                                                                                $$
                                                                                                \dot{\theta} = M^{-1}u; \quad \dot{u} = -\frac{\partial U}{\partial \theta}
                                                                                                $$
                                                                                        </span>
                                                                                        Numerically evolved using leapfrog integrator with step-size $\epsilon$, for $L$ steps: $k= \mathcal{T}(\epsilon, L)$.
                                                                                        
								                </span>
                                                                        </div>
								        <br>
                                                                </div>
							</div>		
														
							<div class="col" >
								<div style="position:relative; width:700px; height:500px; top:200px; left:50px;  margin:1 auto">
									
									<!-- <Img  style="position:absolute;top:-150px;left:0px;" data-src="assets/hmc_algo.png"/> -->
									<img  class="fragment fade-out" data-fragment-index="1" style="position:absolute; top:-150px; right:250px; height:300px;" data-src="assets/rwmh.gif"/>
									<img  class="fragment fade-in" data-fragment-index="1" style="position:absolute; top:-150px; right:250px; height:300px;" data-src="assets/hmc.gif"/>

								</div>
								<div style="position:absolute; float:right; top:650px; right:00px; font-size: 20px; margin:0 auto">https://github.com/chi-feng/mcmc-demo</div>			
								
							</div>
							
						</div>
					</section>
				
				
					<!-------------------------------------------------------------------------------->
					<!-------------------------------------------------------------------------------->
					<section>
						<h3 class='slide-title'> Inferring the initial conditions of the Universe</h3>

						<br>
						<div class="container"  style="font-size:20px; margin-left:20px">

							<div class="col"  style="flex:0 0 28em;"> 
									<div class="plain"  style="text-align:left">
										Data ($x$): 3D dark matter density data
										<br>
										<br>
										Parameters ($\theta$): $\,z$, initial conditions at $64^3$ resolution
										<br>
										<br>
										Likelihood $p(x|\theta) = \mathcal{N}(f(z), \sigma)$
										<br>
										$f$: particle-mesh simulation

										<br>
									</div>

									<br>
									<br>
									<div class="plain fragment" data-fragment-index="1" style="text-align:left" >
										
										Quantitative comparision with summary statistics:<br>
										Power spectrum: $P(k) \sim \delta_D(k - k') \langle \delta(k) \delta(k')\rangle $
									<br>
									<br>
									<ul class="fragment" data-fragment-index="1"> $\rightarrow$ Cross Correlation: $r_c(k) = \frac{P_{ab}(k)}{\sqrt{P_a(k)P_b(k)}}$
										<br>
										<em> Expectation: 1 on large scales, 0 on small scales</em> 
									</ul>
									<br>
									<br>
									<ul class="fragment" data-fragment-index="1">$\rightarrow$ Transfer Function: $t_f (k) = \sqrt{\frac{P_a(k)}{P_b(k)}}$
										<br>
										<em> Expectation: 1 on all scales </em>
									</ul>
									<br>
									<!-- <p class="fragment" data-fragment-index="2" > Iff both $t_f$ and $r_c$ are 1 on all scales, the fields are identical </p> -->

									
									</div>							

									<br>
							</div>		
														
							<div class="col"  style="flex:0 0 35em;">

								<div>
									<br>
									<img class="plain" src="../assets/ic_gif.png"   width="200" />
									&nbsp;
									<img  class="plain" src="../assets/ic.gif"   width="200" />
									&nbsp;
									<img  class="plain" src="../assets/dm_data.png"   width="200" />

								</div>
								<img  class="fragment plain" data-fragment-index="2" height="300px" width="700px" data-src="assets/hmc_posterior.png" />
																
							</div>
						
						</div>
						<br><br>
						
					</section>

					<!-------------------------------------------------------------------------------->
					<!-------------------------------------------------------------------------------->
					<section>
						<h3 class='slide-title'> Cost of the algorithm </h3>

						<div  style="font-size:20px">
							Auto-correlation length ($a_c$) for every mode i.e. $k$-bin
							$$
							\rho_j(t)  = \frac{1}{n} \sum_{i=t+1}^n \big(P_i(k_j) - \bar{P}(k_j)\big) \big(P_{i-t}(k_j) - \bar{P}(k_j)\big); \quad a_c :=  \rho_j(a_c) \leq 0.1
							$$

						</div>
						
						<img  class="fragment plain" data-fragment-index="1" data-src="assets/hmc_ac.png" height="300"/>
						
						<ul class="fragment" data-fragment-index="2" style="font-size:20px; text-align:center">

							Auto-correlation lengths can be 1000 samples long,
							<br>
							<b class="alert">~10,000 simulations </b> for a single independent sample!!
						</ul>

					</section>

				</section>
				

				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				<section data-background-color="black">
                                        

                                        <div style="font-size:40px">
                                                Explicit inference: variational inference
                                        </div>
                                        
                                </section>

				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
                                
                                <section>
                                        <section data-background-color="black">
                                                
                                                <h3 class='slide-title' style="position:absolute;top:0;"> Variational Inference </h3>

						<div style="position:absolute; top:20px; right:20px; width:600px; text-align:right; font-size:20px">
                                                        Goal: Generate samples from the posterior <span style="font-size:20px" > $p(\theta|x)$ </span> <br>
                                                        to approximate expectations  <span style="font-size:20px" > $\int f(\theta) p(\theta | x) \mathrm{d}\theta$</span>.
                                                </div>
						
                                                <br> 
                                                <br>
						<br>
						<div style="text-align:center; font-size:21px"> Approximate the posterior with a simpler parametric distribution
							<br>
							<span style="font-size:20px" > $$ p(\theta | x) \approx q_{\phi} (\theta) $$ </span>
							Fit parameters $\phi$ to minimize a dissimilarity metric $d(q;p)$
						</div>
                                                
						<div class="container" style="font-size:20px">
							<br>
							<div class="col" style="text-align:left; margin-left:20px">

								<br>
								<br>
								E.g. $q_\phi = \mathcal{N}(\mu, \Sigma)$, then
								$\phi = (\mu, \Sigma)$
								<br>
								<br>
								<span class="fragment" data-fragment-index="2">
									<u>Reverse Kullback-Leibler Divergence</u>
									<div class="block-content" style="font-size:20px">
										\begin{align}
										D_{\mathrm{KL}}(q||p) &= \mathbb{E}_{q}(\log q - \log p) \nonumber \\
										& \approx \sum_{\theta_i \sim q} \bigl[ \log q_{\phi}(\theta) - \log p(\theta | x) \bigr] \nonumber \\
										& \leq  \sum_{\theta_i \sim q} \bigl[ \log q_{\phi}(\theta) - \log p(\theta,  x) \bigr] 
										\end{align}
									</div>
								</span>
								
								<br>
								<br>

							</div>
							<div class="col" >
								<img class="fragment plain" data-fragment-index="2"  style="position:relative; top:20px" data-src="assets/vi_cartoon.png" width="500"/>
								
								
							</div>
							
							
						</div>
						
					</section>
					
 					<!-------------------------------------------------------------------------------->
                                        
					<section data-background-color="black">
						
                                                <h3 class='slide-title' style="position:absolute;top:0;"> Inferring initial conditions of the Universe with VI </h3>
						
                                                <br>
                                                <br>
                                                <div class="slide-text" style="text-align:left; margin-left:20px; font-size:20px">
							Choice of variational distribution:
                                                        <br>
							<br>
							<ul>
								<li class="fragment strike" data-fragment-index="1"> Gaussian with diagonal covariance (mean-field) </li>
								<br>
								<li class="fragment" data-fragment-index="2"> Normalizing flows <br>
									$\rightarrow$ sequence of bijective functions parameterized with neural networks
									<br>
									<span class="fragment" data-fragment-index="3">
										$\rightarrow$ symmetry-based flows using Fourier space convolutions
                                                                                <br>
                                                                                (capable of learning the distribution of samples from HMC)
									</span>
								</li>
                                                        </ul>
							<br>
							<br>
							<br>
							<span class="fragment" data-fragment-index="5">
								$D(q||p)$: Reverse KL matches entropy, is mode-seeking. <br>
								$D(p||q)$: Froward KL matches variance.
								<br>
								<span class="fragment" data-fragment-index="6">
									... but requires samples from the target distribution.
								</span>
							</span>
							
                                                </div>
								
						<img class="plain fragment" data-fragment-index="2" style="position:absolute; top:100px; right:75px; width:450px"
						     data-src="assets/nf_cartoon.png" />
						<img class="fragment plain" data-fragment-index="4"  style="position:absolute; top:300px; right:20px; width:600px"
						     data-src="assets/vi_posterior.png"/>
						<img class="fragment plain" data-fragment-index="5"  style="position:absolute; top:420px; left:100px; width:400px"
						     data-src="assets/mfvb.png"/>

					</section>
				
                                </section>
				

                                
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->

				
                                <section>
					<h3 class="slide-title">Variational self-Boosted Sampling (VBS)</h3>
					
 					<div style="font-size:22px"> Combine HMC and VI to generate samples from the target with smaller auto-correlation length.
					</div>
					<br>
					<div class="container">
						<br>
						<div class="col"  style="flex">
							
							<div class="block fragment " data-fragment-index="1">
								<div class="block-title">
									Motivation
								</div>
								<div class="block-content" style="font-size:20px">
									<ul>
										<li class=" plain "> HMC generates samples from the target.
										</li>
										<li class="plain " > Samples generated from the variational distribution are independent.
										</li>
									</ul>
									
								</div>
								
							</div>
							<br>
							<div class="block fragment " data-fragment-index="2">
								<div class="block-title">
									Strategy
								</div>
								<div class="block-content" style="font-size:20px">
									<ul>
										<li class=" fragment " data-fragment-index="2">Train NF with samples generated from HMC on-the-fly. 
										</li>
										<br>
										<li class=" fragment " data-fragment-index="2">Alternately generate proposals from HMC kernel and the variational distribution. <br>
										</li>
									</ul>
								</div>
							</div>
							<br>
							<em class="fragment" data-fragment-index="3" style="position:relative; top:0px; font-size:20px"> VBS reduces auto-correlation length of MCMC chains
								<br>as compared to HMC by more than <b class="alert"> 10x </b> </em>
							
							
						</div>
						<div class="col" style="flex">
							<img class="plain fragment fade-in" data-fragment-index="2" style="position:absolute; top:150px; right:60px; width:500px"
							     data-src="assets/vsbs_posterior.png" />
							
							<div class="plain fragment fade-in" data-fragment-index="3" style="position:absolute; top:400px; right:0px; font-size:20px" >
								<img style="right:30px; width:650px; ", data-src="assets/vsbs_ac_200_64.png" />
								<br>
							</div>
							
							<span  class="plain fragment" data-fragment-index="3" style="position:absolute; top:640px; right:20px; font-size:16px; text-align:right">
								<b><u>Modi</u></b>, Li, Blei (2022) <br>
								Dai and Seljak (2022)
								
							</span>
							
						</div>
					</div>
					<br> 
					<span class="plain fragment" data-fragment-index="4" style="position:relative;  font-size:20px"> Similar techniques can be used to sample from multi-modal distributions, e.g. detecting phase transitions.
					</span>
					
				</section>
				
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				

                                <section>
					<h3 class="slide-title">Summary so far</h3>
					
                                        <ul>
						<li> Automatic differentiation for using inference algorithms.
						</li>
						<li> HMC is expensive.
						</li>
						<li> VI is fast, but can be inaccurae.
						</li>
						<li> Combinations of HMC and VI can be fast and accurate.
						</li>
					</ul>

					<br>
					Focused on inferring initial conditions, not the cosmology parameters. Why?
					Hierarchical distribution!
                                </section>

                                
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->

                                <section> 

                                        <div style="font-size:40px">
                                                Advances in HMC and VI 
                                        </div>
					<br>
					<div class="container fragment"  data-fragment-index="2" style="margin:auto; width:600px; font-size:26px">
						<div class="col">
							<div class="boxonly alert" style="background-color:#44444;  border-radius: 100px; width:200px">
								<br>1.<br>Delayed rejection <br> HMC <br>  </div></div>
						<!-- <div class="col"> -->
							<!-- 	<div class="boxonly alert" style="border-radius: 100px; width:160px">  <br>2.<br>Joint<br>analysis<br><br> </div> </div> -->
						<div class="col">
							<div class="boxonly alert" style="border-radius: 100px; width:200px; ">  <br>2.<br> Score matching VI<br><br> </div>
						</div>
					</div>

                                </section>

				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->

                                <section> 
                                        <section data-background-color="black">

                                                <h3 class='slide-title' style=""> Hierarchical models </h3>

                                                <div class="slide-text">
                                                        <div style="text-align:center">
                                                                $$\mu, \sigma \sim p(\mu, \sigma)$$
                                                                $$\mu_i, \sigma_i \sim p(\mu_i, \sigma_i | \mu, \sigma)$$
                                                        </div>
                                                        <br>
                                                        <div class="plain fragment" data-fragment-index="1" >
                                                                Strongly coupled individual and population parameters.
                                                                <br>
                                                                <u> Multiscale distribution</u>: condition number varies over orders of magnitude.

                                                        </div>
                                                        <br>
                                                        <div class="plain fragment" data-fragment-index="2" >
								HMC & NUTS are <b class="alert" > not able </b>  to robustly sample these distributions.
								<br>
								<br>
								<span class="fragment" data-fragment-index="3" > $\rightarrow$ Need very different step-sizes for leapfrog integration in HMC. </span>
                                                        </div>
							<div class="plain " style="position:absolute; top:100px; right:0px; " >
								<img style="border:none; height:280px; width:450px", data-src="assets/hierarchical_model.png" />
                                                        </div>
							<div class="plain fragment" data-fragment-index="1"  style="position:absolute; top:400px; right:100px; ">
                                                                <img style="height:250px; width:300px; border:none; ", data-src="assets/funnel2.png" />
                                                        </div>
							<div class="plain fragment" data-fragment-index="2"  style="position:absolute; top:400px; left:250px; ">
                                                                <img style="height:250px; width:250px; border:none; ", data-src="assets/funnel_nuts.png" />
                                                        </div>
                                                </div>
                                                <br>
                                                <br>
                                                <br>
                                        </section>

				        <!-------------------------------------------------------------------------------->

                                        <section data-background-color="black">

                                                <h3 class='slide-title' style=""> Delayed rejection approaches </h3>

                                                <br>
                                                <br>
                                                <div style="font-size:20px">
                                                        When faced with a rejection, make another proposal<br>
							with a <u>different transition kernel</u> that has a better chance of  getting accepted.
                                                </div>
						<br>
                                                <div class="slide-text">
                                                        <br>
                                                        <div class="plain fragment" data-fragment-index="1" >
                                                                Strongly coupled individual and population parameters.
                                                        </div>
                                                        
                                                                
							<div class="plain fragment" data-fragment-index="1"  style="position:absolute; top:400px; right:100px; ">
                                                                <img style="height:250px; width:300px; border:none; ", data-src="assets/funnel2.png" />
                                                        </div>
                                                </div>
						<div style="position:absolute; top:200px; right:50px; font-size:20px">
							HMC: $\quad x$  <span style="position:relative; font-size:30px; top:5px" > $\longrightarrow$ </span> $y$ 
							<span style="position:relative; top:-20px; left:-70px"> $\mathcal{F}_1$ 
						</div>
						
						<div style="position:absolute; top:250px; right:50px; font-size:20px">
							<!-- $x$  $\xrightarrow{\mathcal{F}_1}$  $y$  -->
							DRHMC: $\quad x$  <span style="position:relative; font-size:30px; top:5px" > $\longrightarrow$ </span> $y$ 
							<span style="position:relative; top:-20px; left:-70px"> $\mathcal{F}_1$ 
						</div>
						<div style="position:absolute; top:280px; right:130px; font-size:20px">
							<span style="font-size:40px" > $\downarrow$ </span><br> $\quad y$ 
							<span style="position:relative; top:-50px; left:-20px"> $\mathcal{F}_2$ 
						</div>
                                                <br>
                                                <br>
                                                <br>
                                        </section>

                                </section>

                                
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
                                <section data-background-color="black">
                                        
                                        <h3 class='slide-title' style="position:absolute;top:0;"> Summary of Explicit methods </h3>
                                        
                                        <br>
                                        <br>
                                        <div class="slide-text">
                                                <ul>
                                                </ul>
                                        </div>
                                        
                                </section>
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->

                                <section data-background-color="black">
                                        
                                        <h3 class='slide-title' style="position:absolute;top:0;"> Simulation based inference </h3>
                                        
                                        <br>
                                        <br>
                                        <div class="slide-text">
                                                <ul>
                                                </ul>
                                        </div>
                                        
                                </section>
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->

                                <section data-background-color="black">
                                        
                                        <h3 class='slide-title' style="position:absolute;top:0;"> Putting it all together </h3>
                                        
                                        <br>
                                        <br>
                                        <div class="slide-text">
                                                <ul>Neutron star example with HMC and SBI
                                                </ul>
                                        </div>
                                        
                                </section>
				<!-------------------------------------------------------------------------------->


                                
				<section data-background-color="black">

					<h3 class='slide-title' style="position:absolute;top:0;"> The story of our Universe </h3>

					<div class="container">

						<div class="col" style="flex: 0 0 33em;">
							<img class="plain" src="assets/WMAP_timeline.jpg" width="800px"/>
						</div>
						
						<div class="plain  fragment current-visible" data-fragment-index="1" style="position:absolute; top:150px; right:30px; height:400px; text-align:right; font-size:20px">
							<img class="plain" data-src="assets/sdss_pie2.jpg" />
							<br>
							Credits: M. Blanton and SDSS
						</div>
						<div class="col" style="flex: 0 0 20em;">

							<br>
							
							<div class="fragment" data-fragment-index="2" style="">
 							        Standard model:<b class="alert"> $\Lambda$-CDM </b> <br>  
							        $\Lambda$: cosmological constant dark energy <br>
                                                                CDM: Cold dark matter

							</div>
							<br>
							<!-- <div class="block fragment" data-fragment-index="1" > -->
							<!-- 	<div class="block-title"> -->
							<!-- 		Assumptions -->
							<!-- 	</div> -->
							<!-- 	<div class="block-content" style="font-size:20px"> -->
							<!-- 		<br> -->
							<!-- 		<ol> -->
							<!-- 			<li>$\Lambda$: cosmological constant dark energy</li> -->
							<!-- 			<li>$CDM$: cold dark matter</li> -->
							<!-- 			<li>$Gravity$: General relativity</li> -->
							<!-- 			<li>Homogeniety</li> -->
							<!-- 			<li>Isotropy</li> -->
							<!-- 		</ol> -->
							<!-- 		<br> -->
							<!-- 	</div> -->
								
							<!-- </div> -->
							
							<!-- <div class="block fragment" data-fragment-index="2" > -->
							<!-- 	<div class="block-title"> -->
							<!-- 		6 unknowns in $\Lambda$-CDM model -->
							<!-- 	</div> -->
							<!-- 	<div class="block-content" style="font-size:20px"> -->
							<!-- 		<ol> -->
							<!-- 			<li>baryon fraction</li> -->
							<!-- 			<li>fraction of dark matter</li> -->
							<!-- 			<li>age of the Universe</li> -->
							<!-- 			<li>optical depth at reionization</li> -->
							<!-- 			<li>amplitude of curvature fluctuation</li> -->
							<!-- 			<li>scalar spectral index</li> -->
							<!-- 		</ol> -->
							<!-- 		<br> -->
							<!-- 	</div> -->
								
							<!-- </div> -->
							<br>

							<img class="plain fragment current-visible" data-fragment-index="2" data-src="assets/lcdm.png" />
							
							<div class="block fragment" data-fragment-index="3" style="position:absolute; top:250px; right:30px; width:400px">
								<div class="block-title">
									Open questions
								</div>
								<div class="block-content" style="font-size:20px">
									<ul>
										<li>What is dark energy?</li>
										<li>What is dark matter made of?</li>
										<li>How did inflation happen?</li>
										<li>What are the masses of neutrinos?</li>
										<li>Is GR the theory of gravity?</li>
										<li>...</li>
									</ul>
									<br>
								</div>
								
							</div>
							
						</div>
					</div>
				</section>
				
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
                                
				<section >

					<!-------------------------------------------------------------------------------->
					<!-------------------------------------------------------------------------------->

										
					<section>
						<h3 class='slide-title'>Next generation of cosmology</h3>
						<br>
							<div class="container" style="font-size:20px; ">
								<div class="col" style="">
									<div class="plain" style="position:absolute; top:90px; left:200px">
										<img src="assets/desi_telescope.jpg" class="plain" height="150" width="250" style="border:none"></img>
										<div style="position:relative; top:-75px; left:-60px; " > DESI </div>
									</div>
									<div class="plain" style="position:absolute; top:90px; left:500px">
										<img src="assets/euclid_telescope.jpg" class="plain"  height="150" width="250" style="border:none"></img>	
										<div style="position:relative; top:-75px; left:50px" > Euclid </div>
									</div>
									<div class="plain" style="position:absolute; top:90px; left:800px">
										<img src="assets/spherex_telescope.jpg" class="plain" height="150" width="250" style="border:none"></img>
										<div style="position:relative; top:-75px; left:70px" > SphereX</div>
									</div>
									
									<div class="plain" style="position:absolute; top:280px; left:350px">
										<img src="assets/lsst_telescope.jpg" class="plain" height="150" width="250" style="border:none"></img>
										<div style="position:relative; top:-160px; left:-80px" > LSST</div>
									</div>
									<div class="plain" style="position:absolute; top:280px; left:650px">
										<img src="assets/SO_telescope.jpg" class="plain" height="150" width="250" style="border:none"></img>
										<div style="position:relative; top:-105px; left:-60px" >Simons<br>Observatory</div>
									</div>
																		
									<div class="plain" style="position:absolute; top:480px; left:200px">
										<img src="assets/roman_telescope.jpg" class="plain" height="150" width="250" style="border:none"></img>
										<div style="position:relative; top:-75px; left:-70px" > Roman<br>Telescope</div>
									</div>
									<div class="plain" style="position:absolute; top:480px; left:500px">
										<img src="assets/hirax_telescope.jpg" class="plain" height="150" width="250" style="border:none"></img>
										<div style="position:relative; top:-50px; left:-70px; color:white" > HIRAX </div>
									</div>
									<div class="plain" style="position:absolute; top:480px; left:800px">
										<img src="assets/cmbs4_telescope.jpg" class="plain" height="150" width="250" style="border:none"></img>
										<div style="position:relative; top:-50px; left:-60px; color:black;" >CMB-S4</div>
									</div>

								</div>

							</div>
							<br>
							
					</section>
					
					<!-------------------------------------------------------------------------------->
					<!-------------------------------------------------------------------------------->

					<section data-background-image="assets/Mayall2r.jpg" >
					<!-- <section data-background-image="assets/LSST.jpg"> -->
						<h3 class='slide-title'>A paradigm shift</h3>

						<div class="" style="font-size:24px"> Large amount of high precision data from the next generation of cosmological surveys. </div>
						
						<div class="container" style="font-size:22px">
							<div class="col" >
								<br>
								<div class="fragment" data-fragment-index="1">
									<b class="alert"> Dark Energy Spectroscopic Instrument (DESI) </b>
									<br>
									<ul style="">
										<li> 14,000 square degrees over 5 years</li>
										<li> 35 million galaxies and quasars</li>
										<li class="fragment" data-fragment-index="2"> In its first year, it has mapped out <b><u> more galaxies than all of the previous 3D surveys combined.</u></b>
									</ul>
								</div>
								<br>
								<img class="plain fragment fade-in"  data-fragment-index="1" data-src="assets/sdss_vs_desi.jpg" style="position:absolute;left:50px; width:500px; height:250px" data-fragment-index="0" />
								<br>
 								<div class="fragment"  data-fragment-index="1" style="position:absolute; font-size: 16px; top:650px; left:400px">
									DESI Collaboration: 1611.00036</div>
							</div>
							
							
							<div class="col" >
								<div class="fragment" data-fragment-index="3">
									<b class="alert"> Vera C. Rubin Observatory<br>
										(Large Synoptic Survey Telescope, LSST) </b>
									<br>
									<ul style="">
										<li> 18,000 square degrees over next 10 years</li>
										<li> Observe each patch of the sky 10 times</li>
										<li> 38 billions of objects: 20 billion galaxies, 17 billion stars </li>
 									</ul>
								</div>
								<br>
								<!-- <img class="plain fragment fade-in"  data-fragment-index="3" data-src="assets/lsst_footprint.png" style="position:absolute;right:100px; width:400px;" data-fragment-index="0" /> -->
								<img class="plain fragment fade-in"  data-fragment-index="3" data-src="assets/lsst_visits.png" style="position:absolute;right:100px; width:400px;" data-fragment-index="0" />
 								<div class="fragment"  data-fragment-index="3" style="position:absolute; font-size: 16px; top:650px; right:20px">
									LSST Collaboration</div>
							</div>
								<br>
							</div>
					</section>

					<!-------------------------------------------------------------------------------->
					<!-------------------------------------------------------------------------------->
					
					<section>
						<h3 class='slide-title'>Promise of the modern cosmological surveys </h3>

						<br>
						<div style="font-size:24px" > Unprecedented constraints on all  cosmological parameters </div>
						<br>

						<div class="container">
							<div class="col slide-text" style="flex:0 0 25em; font-size:22px">

								<ol>
									<!-- <li class=""  > Unprecedented constraints on all  cosmological parameters  -->
                                                                        <!--         <\!-- <ul> <li  >Neutrino mass (Forecast for DESI $\sim$0.02 eV)</li> </ul> -\-> -->
                                                                        <!-- </li> -->
									<br>
									<li class="fragment" data-fragment-index="1" > Answer fundamental questions 
                                                                                <ul> <li> E.g., masses of neutrinos, <br> models of inflation</li> </ul>
                                                                        </li>

									<br>
 									<li class="fragment" data-fragment-index="2" > Study tensions in $\Lambda$-CDM model
										<ul>
											<li class="fragment" data-fragment-index="2" >E.g., $\sim$4 $\sigma$ Hubble tension
												<br>lensing is low
											</li>
											<!-- <li class="fragment" data-fragment-index="3" >Lensing is low $\sim$2 $\sigma$</li> -->
										</ul>
									</li>
									<br>
									<li class="fragment" data-fragment-index="4" > Discover new physics
										<ul>
											<li > E.g., nature of dark energy, dark matter </li>
										</ul>
									</li>
								</ol>
								<br>
								<br>
								<div class="fragment" data-fragment-index="5" style="text-align:center">
									<b class="alert">Challenge:</b> <br>can our models and analyses extract all the information in the data?
								</div>
							</div>
							
							
							<div class="col" style="flex:0 0 25em">
								
								<div class="fragment fade-out"   data-fragment-index="0"  style="position:absolute; top:150px; right:100px; font-size:20px" >
									<img data-src="assets/desi_hz0.png" />
									<br>
									<em style="position:relative; top:-20px"> Constraints on H(z), expansion rate<br>  Baryon Oscillation Spectroscopic Survey(BOSS) Survey </em>
								</div>
								
								<span class="fragment fade-in" data-fragment-index="0">
									<span class="fragment fade-out" data-fragment-index="2">
										<div class="plain"    style="position:absolute; top:150px; right:100px; font-size:22px" >
											<img data-src="assets/desi_hz1.png" />
											<br>
											<em style="position:relative; top:-20px" > Forecast for constraints on H(z) from DESI survey </em>
										</div>
									</span>
								</span>
								
								<span class="fragment fade-in "   data-fragment-index="2" >
									<span class="fragment fade-out "   data-fragment-index="4" >
										<div  style="position:absolute; top:150px; right:100px; width:500px; font-size:20px">
										      <img class="plain" data-src="assets/hubble_tension2.png" />
										      <em style="position:relative; top:-20px; width:500px;"> Hubble tension from early & late time Universe </em>
										</div>

									</span>
								</span>
								<!-- <img class="fragment current-visible"   data-fragment-index="3"  style="position:absolute; top:350px; left:100px; " -->
								<!--      data-src="assets/lensing_tension.png" /> -->
								<div class="fragment"   data-fragment-index="4"  style="position:absolute; top:150px; right:130px; width:400px; font-size:20px" >
									<img data-src="assets/lsst_y10_forecast2.png" />	
									<em style="position:relative; top:-20px"> Forecast for dark energy equation of state parameters from LSST </em>
								</div>

								
								<div style="position:absolute; right:20px; top:620px; text-align:right; font-size: 16px">
									<div class="plain  " data-fragment-index="0" style="font-size: 16px"> DESI whitepaper (Aghamousa et al. (2016))</div>
									<div class="plain fragment " data-fragment-index="2" style="font-size: 16px"> Verde, Treu, Riess (2019)</div>
									<!-- <div class="plain fragment " data-fragment-index="3" style=""> Hilderbrant et al. (KIDS collaboration) (2016)</div> -->
									<div class="plain fragment " data-fragment-index="4" style="font-size: 16px"> LSST Collaboration (2018)</div>
								</div>
							</div>
					</section>


					
				</section>

				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
					
				<!-------------------------------------------------------------------------------->
	                        <!-------------------------------------------------------------------------------->
                                <section>
                                                
					<h3  class='slide-title'>Outline of this talk</h3>
					
                                        <br>
					In the next 3 parts, I will discuss how to do cosmological analysis for the next generation of surveys.
					<br>
					<br>
					<br>

					
                                        <div class="slide-text" style="font-size:22px" >
                                                
						<ol> 
							<li class="plain fragment" data-fragment-index="1" > Current approaches to cosmological analysis
								<ul> $\rightarrow$ need to think about forward modeling </ul>
							</li>
							<br>
							<li class="plain fragment" data-fragment-index="2" > Simulation-based inference (SBI)
								<ul> $\rightarrow$ advantages, current status, challenges </ul>
							</li>
							<br>
							<li class="plain fragment" data-fragment-index="3" > Field-level inference
								<ul> $\rightarrow$ advantages, current status, challenges </ul>

							</li>
							<br>
						</ol>
					</div>
					
					</section>

				<!-------------------------------------------------------------------------------->
	                        <!-------------------------------------------------------------------------------->
                                <section class="" data-background="">
                                        
				        <section>
					        <div style="font-size:40px">1. With great data,<br>comes great responsibility.</div>
				        </section>
                                </section>
                                
				<!-------------------------------------------------------------------------------->
	                        <!-------------------------------------------------------------------------------->

				<section>
                                        <section>
                                                
						<h3  class='slide-title'>How do we do galaxy clustering analysis?</h3>
						<div class="header-right">
							<font color="orange"> Traditional Analysis<br>
							$\rightarrow$ Introduction </font> <br>
							Simulation-based Inference<br>
							Field-level Inference
						</div>

                                                <div class="plain " data-fragment-index="1"> <b> Data</b>: a catalog of galaxies with their positions. </div>

                                                <br>
                                                <br>
                                                <div class='container'>
								<div class="col" style="flex:0 0 25em; margin-left:20px; font-size:22px">

                                                                        <ol> 
									        <li class="plain fragment" data-fragment-index="1" > Compute <b class="alert"> summary statistics </b> of choice
                                                                                        <ul style="font-size:20px"> $\rightarrow$ generally 2-point correlation function or power spectrum</ul>
                                                                                </li>
										<div class="plain fragment current-visible" data-fragment-index="1" style="position:absolute; top:300px; left:200px; height:150px">
											$$\xi_2(|x_1-x_2|) = \langle \delta(x_1) \delta(x_2) \rangle$$ 
											<img class="plain " data-fragment-index="1" style="position:relative; left:50px" data-src="assets/2ptcorrelation.png" />
										</div>
										<br>
                                                                                <li class="plain fragment" data-fragment-index="2" > Develop <b class="alert"> theoretical predictions </b> for these statistics
                                                                                        <ul style="font-size:20px"> $\rightarrow$ generally based on effective field theory (EFT) </ul>
                                                                                </li>
                                                                                <br>
                                                                                <li class="plain fragment" data-fragment-index="3" > Construct an  <b class="alert">analytic likelihood</b> model 
                                                                                        <ul style="font-size:20px"> $\rightarrow$ generally assumed to be Gaussian </ul>
                                                                                </li>
                                                                                <br>
                                                                                <li class="plain fragment" data-fragment-index="4"> Profit: run <b class="alert"> MCMC </b> to infer posterior on model parameters,
											<span style="font-size:20px"> $\,p(\theta | x ) \propto p(x | \theta)  \ p(\theta)$ </span>

                                                                                </li>
                                                                        </ol>
									<br>
									<br>
									<br>
									<div class="plain fragment" data-fragment-index="5" style="text-align:center">
										<!-- <div class="alert "  > Moving ahead, each of these steps is a limiting factor! </div> -->
										<em  > Moving ahead, each of these steps is a limiting factor! </em>
									</div>

								</div>
						
								<div class="col" style="font-size:20px">
									 <!-- <img class="plain  fragment fade-out" data-fragment-index="1" style="position:absolute; top:150px; left:180px;;" data-src="assets/desi.gif" /> -->
									 <img class="plain  fragment fade-out" data-fragment-index="1" style="position:absolute; top:150px; left:390px; height:500px" data-src="assets/sdss_pie2.jpg" />
									 <!-- <img class="plain fragment current-visible" data-fragment-index="1" style="position:absolute; top:200px; right:100px; height:300px;" data-src="assets/boss_dr12_data.png" /> -->
									 <div class="plain fragment current-visible" data-fragment-index="1" style="position:absolute; top:200px; right:100px; height:300px; font-size:20px">
										 <img  data-src="assets/boss_dr12_fit_corr.png" />
										 <br>
										 <em> Measurement of 2-pt correlation function from BOSS survey </em>
									 </div>
									 
									 <div class="plain fragment current-visible" data-fragment-index="2" style="position:absolute; top:200px; right:100px; width:500px; font-size:20px">
										 <img data-src="assets/pk_eqn3.png" />
										 <br>
										 <em> An example of effective field theory integrals </em>

									 </div>
									 <div class="plain fragment current-visible" data-fragment-index="3" style="position:absolute; top:200px; right:100px; width:500px; font-size:20px;">
										 <img src="assets/pk_likelihood.png" />
										 <br>
										 <em> Gaussian likelihood function for power spectrum </em>
									 </div>
									 <div class="plain fragment" data-fragment-index="4" style="position:absolute; top:150px; right:120px; height:450px;; font-size:20px;">
										 <img src="assets/misha_constraints.png" />
										 <br>
										 <em style="position:relative; top:-10px"> Example constraints from BOSS data analysis </em>
									 </div>
									 
									 <div class="plain fragment fade-out" data-fragment-index="1" style="position:absolute; bottom:10px; right:20px; font-size: 16px"> Credit: M. Blanton and the Sloan Digital Sky Survey.</div>
									 <div class="plain fragment current-visible" data-fragment-index="1" style="position:absolute; bottom:-20px; right:20px; font-size: 16px; text-align:right">
										 Ross et al. (2016)<br>
										 Beutler et al. (including <b><u> CM</b></u>) (2016)</div>
									 <div class="plain fragment current-visible" data-fragment-index="2" style="position:absolute; bottom:0px; right:20px; font-size: 16px; text-align:right">
										 Ross et al. (2016)<br>
										 Beutler et al. (including <b><u> CM</b></u>) (2016)</div>
									 <div class="plain fragment current-visible" data-fragment-index="3" style="position:absolute; bottom:0px; right:20px; font-size: 16px">
										 Kobayashi, Nishimichi et al. (2022)</div>
									 <div class="plain fragment" data-fragment-index="4" style="position:absolute; bottom:-60px; right:20px; font-size: 16px">
										 Ivanov, Simonovic, Zaldarriaga (2020)</div>
								</div>
						</div>
					</section>

					<!-------------------------------------------------------------------------------->
                                        
                                        <section>
                                                
						<h3  class='slide-title'>Limitations of current analyses #1</h3>
						<div class="header-right">
							<font color="orange"> Traditional Analysis<br>
							$\rightarrow$ Introduction </font> <br>
							Simulation-based Inference<br>
							Field-level Inference
						</div>

                                                <br>
                                                <div class="boxonly" style="width:550px; padding:8px; font-size:22px" >We need to choose a <b class="alert"> summary </b> statistic.</div> 
						<div class="slide-text">
                                                        
							<ul>
                                                                <br>
								<li class="fragment" data-fragment-index="0"> Power spectrum (and 2-point correlation function) is <em> no longer </em>  sufficient.
                                                                </li>
                                                                <br>
                                                                <li class="fragment" data-fragment-index="4"> Other summary statistics extract more information from the non-Gaussian data. </li>
                                                                <br>
								<br>
								<br>
                                                        </ul>
                                                        
						</div>
						
                                                <span class="container fragment fade-in" data-fragment-index="0" style="position:absolute; top:230px; left:120px; width:1000px; height:300px; font-size:20px; " >
                                                        <!-- <span class= "fragment fade-out" data-fragment-index="4" > -->
							<!-- 	<img class="plain" style="position:absolute; top:260px; left:170px; width:320px; ;" data-src="assets/ngfield0.png" /> -->
                                                        <!--         <img class="plain" style="position:absolute; top:260px; left:450px; width:320px;" data-src="assets/gfield0.png" /> -->
                                                        <!--         <\!-- <img class="plain" style="position:absolute; top:260px; left:680px; width:320px;" data-src="assets/ngfield0_pk.png" /> -\-> -->
                                                        <!--         <img class="plain" style="position:absolute; top:290px; left:800px; width:230px;" data-src="assets/ngfield0_pk_white.png" /> -->
                                                        <!-- </span> -->

							
							<div class='col fragment fade-out' data-fragment-index='4' style="top:50px">
								<img data-src="assets/ngfield0.png" class="plain" style="top:10px; height:240px;"/>
								<span style="position:relative; top:-20px;" >
									Our Universe
								</span>
							</div>
							<div class='col fragment fade-out' data-fragment-index='4' style="top:50px">
								<img data-src="assets/gfield0.png" class="plain " style="height:240px;"/>
								<span style="position:relative; top:-20px;" > Gaussian random field </span>
                                                                
							</div>
							<div class='col fragment fade-out' data-fragment-index='4'  style="top:50px">
								<br>
								<img data-src="assets/ngfield0_pk_white.png" class="plain " style="height:190px;"/>
								<br>
								<br>
								<span style="position:relative; top:-20px;" > Power spectrum </span>
							</div>
							
                                                </span>

                                                <div class="block fragment " data-fragment-index="5" style="position:absolute; bottom:-260px; right:100px; width:400px">
							<div class="block-title" , style="text-align:center; font-size:22px">
								But which of these statistics?
							</div>
							<div class="block-content", style="text-align:center; font-size:20px">
                                                                wavelets <br>
                                                                bispectrum <br>
                                                                trispectrum <br>
                                                                peak counts <br>
                                                                density splits <br>
                                                                k-nearest neighbor <br>
                                                                Minkowski functionals <br>
                                                                marked power spectrum <br>
                                                                reconstructed power spectrum <br>
                                                                ...
							</div>
                                                        
						</div>
                                                
                                                <img class="plain fragment" data-fragment-index="4" style="position:absolute; bottom:-280px; left:50px; width:400px; ;" data-src="assets/wavelets_eickenberg_mfieldsub.png" />
                                                <div class="plain fragment" data-fragment-index="4" style="position:absolute; bottom:-270px; left:460px; width:300px; font-size:20px; text-align:left">
							<em>
								Fisher forecast for <br>
								constraining various <br>
								cosmological<br>
								parameters.<br>
								<br>
								Red: power spectrum<br>
								Others: wavlet analysis<br>
								<br>
							</em>
							<span style="font-size:16px" >
								Eickenberg et al. (2022)
							</span>
						</div>
                                                <div class="plain fragment current-visible" data-fragment-index="4">
							<img class="plain fragment" data-fragment-index="4" style="position:absolute; top:180px; right:120px; width:300px; ;" data-src="assets/morlet_wavelet.png" />
							<br>
							<img class="plain fragment" data-fragment-index="4" style="position:absolute; top:380px; right:50px; width:450px; ;" data-src="assets/conv_wavelets_sub.png" />
						
							<span style="font-size:16px; position:absolute; top:650px; right:20px; " >
								Cheng et al. (2022)
							</span>
						</div>
					</section>


					<!-------------------------------------------------------------------------------->
                                        
                                        <section>
                                                
						<h3  class='slide-title'>Limitations of current analyses #2</h3>
						<div class="header-right">
							<font color="orange"> Traditional Analysis<br>
							$\rightarrow$ Introduction </font> <br>
							Simulation-based Inference<br>
							Field-level Inference
						</div>

                                                <br>
                                                <div class="boxonly" style="width:600px; padding:8px; font-size:22px" > We need <b class="alert"> theoretical </b>  models of the summary statistics. </div>
                                                
                                                <div class="slide-text" style="width:750px">
                                                        
							<ul>
                                                                <br>
                                                                <br>
								<br>
								<li class="ragment" data-fragment-index="0"> Effective field theory-  assumes small perturbations from Gaussian random field.
                                                                        <ul class="fragment" data-fragment-index="1"> <li> Cannot model the small, non-linear scales </li>
										<li> Hard to include survey systematics e.g.,  masks </li> 
									</ul>
                                                                </li>
                                                                <br>
                                                                <li class="fragment" data-fragment-index="3">  Cannot model summary statistics other than N-point functions
                                                                </li>
								<br>
                                                                <li class="fragment" data-fragment-index="3">  How to model neural-network-based summary statistics?
                                                                </li>
								<br>
                                                      </ul>
 						</div>
                                                <div class="plain fragment" data-fragment-index="1" style="position:absolute; top:180px; right:-40px; width:600px; font-size:20px" >
							<img  style=" width:450px;" data-src="assets/ptfit_shifan.png" />
							<br>
							<em style="position:relative; top:-15px"> Breakdown of perturbation theory on <br>small scales ($k\geq0.2$ h/Mpc) </em>
						</div>
						
                                                <!-- <img class="plain fragment current-visible" data-fragment-index="2" style="position:absolute; top:400px; left:50px; width:700px; text-align:center;" data-src="assets/desi_text.png" /> -->
                                                <div style="position:relative; float:right; margin-right:20px; text-align:right; font-size:16px; top:130px">
                                                        <div class="plain fragment " data-fragment-index="1" style=""> 
                                                                <b><u> Modi</b></u>, White, Vlah (2017) <br>
                                                                Chen, Vlah et al. (2021)
                                                        </div> 
                                                </div>

					</section>
                                        

					<!-------------------------------------------------------------------------------->
                                        
                                        <section>
                                                
						<h3  class='slide-title'>Limitations of current analyses #3</h3>
						<div class="header-right">
							<font color="orange"> Traditional Analysis<br>
							$\rightarrow$ Introduction </font> <br>
							Simulation-based Inference<br>
							Field-level Inference
						</div>
						
                                                <br>
                                                <div class="boxonly" style="width:600px; padding:8px; font-size:22px"> We need an <b class="alert"> analytic </b> likelihood model. </div>
						<div class="slide-text">

							<ul>
                                                                <br>
								<li  class="plain  fade-in" data-fragment-index="0"> Assumed to be a Gaussian likelihood based on central limit theorem.
                                                                        <br>
									<br>
									<ul class="plain  fade-in" data-fragment-index="0">
                                                                                <li> Not true in all the regimes even for power spectrum. </li>
                                                                        </ul>
                                                                </li>
								<br>
								<br>
								<li  class="plain fragment fade-in" data-fragment-index="2"> Estimating covariance matrix is expensive! <br>
                                                                        <br>
									<ul>
                                                                                <li class="plain fragment fade-in" data-fragment-index="2">  Number of simulations needed $\propto\, N_{data}^2$ 
										</li>
                                                                                <li class="plain fragment fade-in" data-fragment-index="2"> Combining different observables & surveys is challenging
											<br>
											$\rightarrow$ 10 x 2pt analysis
										</li>
                                                                        </ul>
								</li>
                                                                <br>
                                                                <!-- <li  class="plain fragment fade-in" data-fragment-index="4"> Combining different observables & surveys becomes challenging. </li> -->
								
                                                        </ul>
						</div>
                                                <!-- <span class="plain fragment fade-in" data-fragment-index="0"> -->
                                                <!--         <span class="plain fragment fade-out" data-fragment-index="2"> -->
                                                <!--                 <img class="plain " style="position:absolute; top:150px; right:50px; width:400px;" data-src="assets/pl_divergence.png" /> -->
                                                <!--         </span> -->
                                                <!-- </span> -->
                                                <div class="fragment plain" data-fragment-index="2" style="position:absolute; top:170px; right:50px; width:400px; font-size:20px" >
							<img data-src="assets/cov.png" />
							<br>
							<em> Example of joint covariance matrix for galaxy shear, density and number count </em>
                                                </div>
						
                                                <div style="position:absolute; top:600px; right:20px; text-align:right; font-size: 16px">
                                                        <!-- <span class="plain fragment fade-in" data-fragment-index="0"> -->
								<!--                 Hahn, Beutler et al. (2019) -->
								<!-- </span> -->
							<br>
                                                        <div class="plain fragment" data-fragment-index="2" >Krause &amp; Eifler (2016)</div>
                                                        <div class="plain fragment" data-fragment-index="2" > Fang, Krause, Eifler et al. (2024) </div>
                                                </div>

					</section>
                                </section>
                                        
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
                                
				<section>

                                        <section>
                                                                                        
						<h3  class='slide-title'>Beyond traditional approaches to analysis</h3>
						<div class="header-right">
							<font color="orange"> Traditional Analysis<br>
							$\rightarrow$ Introduction </font> <br>
							Simulation-based Inference<br>
							Field-level Inference
						</div>
						
                                                <br>
						<div class="block " data-fragment-index="1">
							<div class="block-title">
								Current Limitations
							</div>
							<div class="block-content" style="font-size:22px">
                                                                <ol>
                                                                        <span class="" data-fragment-index="1">
                                                                                <span class="fragment highlight-current-green " data-fragment-index="5">
                                                                                        <li> Need to choose a summary statistic
                                                                                                <br> $\rightarrow$ which one to use?
                                                                                        </li>
                                                                                </span>
                                                                        </span>
                                                                        <br>
                                                                        <span class="" data-fragment-index="1">
                                                                                <span class="fragment semi-fade-out " data-fragment-index="3">
                                                                                        <li> Need a theoretical model
                                                                                                <br> $\rightarrow$ infeasible on small scales, or for new statistics
                                                                                        </li>
                                                                                </span>
                                                                        </span>
                                                                        <br>
                                                                        <span class="" data-fragment-index="1">
                                                                                <!-- <span class="fragment highlight-current-blue " data-fragment-index="4"> -->
                                                                                        <span class="fragment highlight-current-green " data-fragment-index="4">
                                                                                                <li> Need an analytic likelihood for inference
                                                                                                        <br> $\rightarrow$ limited to Gaussian approximation
                                                                                                </li>
                                                                                <!-- </span> -->
                                                                        </span>
                                                                        <br>
                                                                        <span class="" data-fragment-index="1">
                                                                                <span class="fragment semi-fade-out " data-fragment-index="3">
                                                                                                <li> Joint analysis of different statistics and surveys is challenging </li>
                                                                                </span>
                                                                        </span>
                                                                </ol>
							</div>
						</div>

                                                <br>
						<div class="box fragment" data-fragment-index="2">
							<div class="box-title" style="padding:8px">
								A different approach: forward modeling
							</div>
							<div class="box-content" style="font-size:22px">
                                                                <br>
                                                                Instead of theoretical models, use computational simulation as the underlying physical models for inference.
                                                                <br>
                                                                <br>
                                                                <div class="fragment fade-in " data-fragment-index="4">
                                                                        <div class="fragment highlight-current-green" data-fragment-index="4">  1. Simulation-based Inference / Likelihood Free Inference / Implicit Inference  
                                                                        </div>
                                                                </div> 
                                                                <div class="fragment fade-in " data-fragment-index="5">
                                                                        <div class="fragment highlight-current-green" data-fragment-index="5"> 2. Field-level Inference / Bayesian Hierarchical Modeling </div>
                                                                </div> 
							</div>
                                                </div>
                                                <br>
                                                
                                                                                                
                                                                                                
				        </section>

				        <!-------------------------------------------------------------------------------->

                                       <section>
                                                <h3  class='slide-title'>Example: forward modeling for galaxy clustering</h3>
						<div class="header-right">
							<font color="orange"> Traditional Analysis<br>
							$\rightarrow$ Introduction </font> <br>
							Simulation-based Inference<br>
							Field-level Inference
						</div>
                                                                                                
                                                <br>
						$x \sim  f(\Lambda)$ <br>
						<div style="font-size:20px" > data $\sim$ forward model (cosmology) </div>

						<div class="container" style="font-size:20px">
                                                        <div class='col fragment' data-fragment-index="1" >
								<br>
								<br>
                                                                $\Lambda$
                                                                <br>
								<b class="alert"> Cosmology </b>
								<div style="font-size:30px"> + </div>
								<img data-src="assets/modes.png" class="plain" style="position:relative; top:-30px; height:150px;"/>
								<br>
								<b class="alert" style="position:relative; top:-50px; ;"> Initial phases <br> $z \sim {N}(0, 1)$</b>
							</div>

							<div class='col fragment' data-fragment-index='2'>
								<img data-src="assets/fieldinit.png" class="plain" style="height:200px;"/>
                                                                <br>
								<b class="alert"> Initial (Linear) <br>Dark Matter </b>
							</div>
							<div class='col fragment' data-fragment-index='3'>
								<img data-src="assets/fieldfin.png" class="plain " style="height:200px;"/>
								<br>
                                                                <b class="alert"> Final (Evolved) <br> Dark Matter </b>
							</div>
							<!-- <div class='col fragment' data-fragment-index='4'> -->
							<!-- 	<img data-src="assets/fieldhalo.png" class="plain " style="height:200px;"/> -->
							<!-- 	<br> -->
                                                        <!--         <b class="alert"> Dark Matter <br> Halos </b> -->
							<!-- </div> -->
							<div class='col fragment' data-fragment-index='5'>
								<img data-src="assets/fieldgal.png" class="plain " style="height:200px;"/>
                                                                <br>
                                                                <b class="alert"> Galaxies <br> (Tracers) </b>
							</div>
							<div class='col fragment' data-fragment-index='6'>
                                                                $x = f(\Lambda)$
								<br>
                                                                <br>
                                                                <b class="alert"> Data </b>
							</div>
                                                        
						</div>
                                                
						<img class="plain fragment" data-fragment-index="0" style="position:absolute; top:90px; right:20px; width:300px;" data-src="assets/pk_eqn3.png" />
						
						<div class="container" style="position:absolute; top:325px; width:1100px; height:50px; left:90px; font-size:35px">
							<div class='col fragment' data-fragment-index='2'>  $\rightarrow$ </div>
							<div class='col fragment' data-fragment-index='3'>  $\rightarrow$ </div>
							<!-- <div class='col fragment' data-fragment-index='4'>  $\rightarrow$ </div> -->
							<div class='col fragment' data-fragment-index='5'>  $\rightarrow$ </div>
							<div class='col fragment' data-fragment-index='6'>  $\rightarrow$ </div>
						</div>
                                                                                                
						<div class="container" style="position:relative; top:10px; width:1100px; height:50px; margin:0 auto; font-size:18px">
							<div class='col fragment' data-fragment-index='2'>  Boltzmann <br> equations </div>
							<div class='col fragment' data-fragment-index='3'>  Gravity evolution <br> (N-Body simulations) <br> ($\mathbf{\Lambda}$) </div>
							<!-- <div class='col fragment' data-fragment-index='4'>  Group Finding <br> algorithms <br>  ($\mathbf{\theta}$) </div> -->
							<div class='col fragment' data-fragment-index='5'>  Halo finding + <br>Galaxy models <br> ($\mathbf{\theta}$)  </div>
							<div class='col fragment' data-fragment-index='6'>  Survey systematics <br> & summarize<br> ($\mathbf{\theta}$)  </div>
						</div>
                                                                                                
                                                
				        </section>

					<!-------------------------------------------------------------------------------->
					<!-------------------------------------------------------------------------------->

                                        <section>
                                                <h3  class='slide-title'>21$^{\mathrm {st}}$ century data requires 21$^{\mathrm {st}}$ century methods</h3>
						<div class="header-right">
							<font color="orange"> Traditional Analysis<br>
							$\rightarrow$ Forward Modeling</font> <br>
							Field-level Inference<br>
							Simulation-based Inference
						</div>
						
                                                <br>
                                                <div style="font-size:22px">
							Advances in computation, statistics and machine learning over the last 5-10 years <br> have finally made forward modeling approaches feasible.
						</div>
						
                                                <div class="container">
							<img class="fragment fade-out" data-fragment-index="1" style="position:absolute; top:190px; right:460px; width:350px;"
							     data-src="assets/ml_cartoon.png" />

                                                </div>
                                                <div class="container">
                                                        <div class="col slide-text" style="font-size:22px">
								<ol>
									<br>
									<br>
									<li class="fragment plain" data-fragment-index="1" > GPU accelerated computations <br>
										<div style = "font-size:20px" > $\rightarrow$ supercomputers with thousands of GPUs  </div> 
									</li>
									<br>
									<li class="fragment plain" data-fragment-index="2"> Bayesian inference algorithms <br>
										<div style = "font-size:20px" > $\rightarrow$ HMC, VI  for high dimensional inference  </div> 
									</li>
									<br>
									<li class="fragment plain" data-fragment-index="3"> Automatic differentiation frameworks <br>
										<div style = "font-size:20px" > $\rightarrow$ gradient information from simulators </div> 
									</li>
									<br>
									<li class="fragment plain" data-fragment-index="4"> Deep learning tools <br>
										<div style = "font-size:20px" > $\rightarrow$ CNN, transformers, neural density estimators </div> 
									</li>
									<br>
									<li class="fragment plain" data-fragment-index="5"> Large scale resource investment<br>
										<div style = "font-size:20px" > $\rightarrow$ collaboration and funding opportunities <br>
											E.g. UArizona Data Science Institute (Data7)
										</div> 
									</li>
									<br>
								</ol>
								
							</div>
							<div class="col "> 
								<img class="fragment plain" data-fragment-index="1" style="position:absolute; top:190px; right:380px; width:300px;"
								     data-src="assets/perlmutter.jpg" />
								<img class=" plain fragment" data-fragment-index="2" style="position:absolute; top:220px; right:20px; width:320px;"
								     data-src="assets/nuts.png"  />
								<img class=" plain fragment" data-fragment-index="3" style="position:absolute; top:420px; right:480px; width:230px;"
								     data-src="assets/TF_FullColor_Horizontal.png" />
								<img class=" plain fragment" data-fragment-index="3" style="position:absolute; top:400px; right:350px; width:110px; height:60px;"
								     data-src="assets/jax_logo.png"  />
								<img class="plain fragment" data-fragment-index="4" style="position:absolute; top:400px; right:20px; width:300px;"
								     data-src="assets/maf_example.png"  />
								<img class="plain fragment" data-fragment-index="5" style="position:absolute; top:480px; right:390px; width:280px;"
								     data-src="assets/nsf_ai.png"  />
							</div>
						</div>
						<div class="plain" style="position:absolute; bottom:-50px; right:20px; font-size:16px; text-align:right">
							<div class="plain fragment" data-fragment-index="2" > Hoffmann & Gelman (2011)</div>
							<div class="plain fragment" data-fragment-index="4" > Kingma & Dhariwal (2018)</div>
						</div>
						
				        </section>
                                        
					
                                        
				</section>
                                
                                <!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
                                <section class="" data-background="">
					<div style="font-size:70px">2. Simulation-based Inference</div>
				</section>

				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				

				<section >
                                        <section> 
                                                <h3 class='slide-title'>Beyond traditional analysis</h3>
						<div class="header-right">
							Traditional Analysis<br>
							<font color="orange"> Simulation-based Inference <br>
							$\rightarrow$ Introduction </font> <br>
							Field-level Inference
						</div>


                                                <br>
                                                <span style="font-size:22px" >
							Goal: extract more information from the non-linear, non-Gaussian regimes of the cosmological fields.
						</span>
                                                <br>
                                                <br>
                                                <br>
                                                <div class="slide-text" style="width:700px">

                                                        <ul>
                                                                <li class="fragment " data-fragment-index="1" >Higher order statistics promise to extract more information
                                                                        <!-- <ul style="font-size:20px"> -->
                                                                        <!--         <li> E.g., wavelet moments, marked power spectrum, k-nearest neighbors </li> -->
                                                                        <!--         <li> ML based summary statistics </li> -->
                                                                        <!-- </ul> -->
                                                                </li>
                                                                <br>
                                                                <li class="fragment " data-fragment-index="1">Challenge:
                                                                        <ul style="font-size:20px">
                                                                                <!-- <li> Lack theoretical model connecting these to cosmology parameters </li> -->
                                                                                Lack analytic likelihood model
                                                                                <br>
                                                                                $$ p(\theta|x) \propto \color{red}{p(x | \theta)}\, p(\theta)$$
                                                                        </ul>
                                                                </li>
                                                        </ul>
                                                        <br>
                                                        <br>
							<div class="plain fragment" data-fragment-index="2" style="text-align:center">
								How does simulation-based inference overcome this challenge?
							</div>

							
							
                                                        <img class="plain fragment " data-fragment-index="1" style="position:absolute; top:150px; right:30px; width:450px"
                                                             data-src="assets/wavelets_eickenberg_mfieldsub.png" width="450" />
							<div class="plain fragment" data-fragment-index="1" style="position:absolute; top:600px; right:20px; font-size:16px;"> Eickenberg et al. (2022) </div>
                                                </div>
                                   
                                        </section>


				        <!-------------------------------------------------------------------------------->
				        <!-------------------------------------------------------------------------------->

                                
                                        <!-- <section > -->
                                        <!--         <h3 class='slide-title'>Simulation-based inference: theory</h3> -->
					<!-- 	<div class="header-right"> -->
					<!-- 		Traditional Analysis<br> -->
					<!-- 		<font color="orange"> Simulation-based Inference <br> -->
					<!-- 		$\rightarrow$ Introduction </font> <br> -->
					<!-- 		Field-level Inference -->
					<!-- 	</div> -->

                                        <!--         <br> -->
					<!-- 	<div class="boxonly " data-fragment-index="1" style="width:1100px; padding:8px; font-size:20px;" > -->
					<!-- 		A simulator defines the likelihood $p(x|\theta)$ as an <b class="alert"> implicit distribution </b> i.e we can sample from it but cannot evaluate it. -->
					<!-- 	</div> -->
                                        <!--         <\!-- <div class="block fragment " data-fragment-index="1" style=";" > -\-> -->
                                        <!--         <\!--         <div class="block-title" > -\-> -->
                                        <!--         <\!--                 Motivation -\-> -->
                                        <!--         <\!--         </div> -\-> -->
                                        <!--         <\!--         <div class="block-content" style="font-size:20px"> -\-> -->
                                        <!--         <\!--                 <ol> -\-> -->
                                        <!--         <\!--                         <li class=" fragment " data-fragment-index="1"> We can computationally evaluate these summary statistics.</li> -\-> -->
                                        <!--         <\!--                         <li class=" fragment" data-fragment-index="2"> A simulator defines $p(x|\theta)$ as an <em> implicit likelihood </em> distribution i.e we can sample from it but cannot evaluate it.</li> -\-> -->
                                        <!--         <\!--                 </ol> -\-> -->
                                        <!--         <\!--         </div> -\-> -->
                                        <!--         <\!-- </div> -\-> -->

                                        <!--         <br> -->
                                        <!--                 <img class="plain fragment" data-fragment-index="3" style="" -->
                                        <!--                      data-src="assets/lfi_sim.png" width="700" /> -->
                                        <!--                 <div class="plain fragment" data-fragment-index="3" style="position:absolute; top:263px; left:310px; font-size:14px"> Model  </div>  -->
                                        <!--                 <div class="plain fragment" data-fragment-index="3" style="position:absolute; top:330px; left:300px; font-size:14px"> $\theta \sim p(\theta)$ </div>  -->
                                        <!--                 <div class="plain fragment" data-fragment-index="3" style="position:absolute; top:330px; left:570px; font-size:14px; color:black"> $z \sim p(z)$ </div>  -->
                                        <!--                 <div class="plain fragment" data-fragment-index="3" style="position:absolute; top:330px; left:910px; font-size:14px"> $x \sim p(x|\theta)$ </div>  -->
							
                                        <!--         <div class="slide-text fragment " data-fragment-index="3" style="font-size:20px"> -->
					<!-- 		<br> -->
                                        <!--                 <center> Generating simulations is equivalent to sampling from the joint distribution, i.e., $\mathcal{D} = \{x_i, \theta_i\} \sim p(x, \theta)$ </center> -->
                                        <!--                 <br> -->
                                        <!--                 <\!-- Inference: Assume the target posterior $p(\theta|x)$ can be modeled by a parametric conditional distribution $q_\phi(\theta | x)$. -\-> -->
                                        <!--                 <\!-- Minimizing the KL divergence between them is equivalent to -\-> -->
                                        <!--                 <\!--         $$  \min_\phi D_{KL}(p||q) \approx \max_{\phi} \sum_i \log q_{\phi}(\theta_i | x_i) $$ -\-> -->


                                        <!--         </div> -->
						
					<!-- 	<div class="container"> -->
					<!-- 		<div class="col"  style="flex: 0 0 40em"> -->
					<!-- 			<div class="block  fragment " data-fragment-index="5" style="" > -->
					<!-- 				<div class="block-title" > -->
					<!-- 					How to infer $p(\theta|x)$? -->
					<!-- 				</div> -->
					<!-- 				<div class="block-content" style="font-size:20px; height:130px"> -->
					<!-- 					Assume the target posterior can be modeled by a parametric conditional distribution $q_\phi(\theta | x)$. -->
					<!-- 					<br> -->
					<!-- 					<div class="plain fragment" data-fragment-index="8"> -->
					<!-- 						The distribution $q\rightarrow p(\theta|x)$ is matched  by maximizing the conditional probability -->
					<!-- 						$$  \max_{\phi} \sum_i \log q_{\phi}(\theta_i | x_i) \quad \forall \theta_i,x_i \sim p(x, \theta)$$ -->
											
					<!-- 						<\!-- Then, minimizing the Kullback Leibler  divergence between them leads to -\-> -->
					<!-- 						<\!-- $$  \min_\phi D_{KL}(p||q) \approx \max_{\phi} \sum_i \log q_{\phi}(\theta_i | x_i) $$  -\-> -->
					<!-- 						<\!-- <center> $  \min_\phi D_{KL}(p||q) \approx \max_{\phi} \sum_i \log q_{\phi}(\theta_i | x_i) $ </center> -\-> -->
					<!-- 					</div> -->
					<!-- 				</div> -->
					<!-- 			</div> -->
					<!-- 		</div> -->
					<!-- 		<div class="col fragment"  data-fragment-index="6" style="flex: 0 0 15em; text-align:left;font-size:20px; position:relative; top:-15px; left:-10px"> -->
					<!-- 			Example for a Gaussian posterior -->
					<!-- 			<br> -->
					<!-- 			<br> -->
								
					<!-- 			$ q \longleftarrow \mathcal{N}(\mu, \sigma^2)$ -->
					<!-- 			<br> -->
					<!-- 			<br> -->
					<!-- 			<span class="fragment"  data-fragment-index="6" > -->
					<!-- 			$\mu = f_{\phi_1}(x)$<br> -->
					<!-- 			$\sigma^2 = g_{\phi_2}(x)$ -->
					<!-- 			</span> -->
								
					<!-- 		</div> -->
					<!-- 	</div> -->
							
					<!-- 	<div class="plain"  style="position:absolute; right:20px; width:300px; font-size:16px;"> Cranmer et al. (2020) </div> -->
                                        <!-- </section> -->


				        <!-------------------------------------------------------------------------------->
				        <!-------------------------------------------------------------------------------->
					
                                        <section >
                                                <h3 class='slide-title'>Simulation-based inference: theory</h3>
						<div class="header-right">
							Traditional Analysis<br>
							<font color="orange"> Simulation-based Inference <br>
							$\rightarrow$ Introduction </font> <br>
							Field-level Inference
						</div>

                                                <br>
                                                <br>
						<div class="boxonly " data-fragment-index="1" style="width:1100px; padding:8px; font-size:20px;" >
							A simulator defines the likelihood $p(x|\theta)$ as an <b class="alert"> implicit distribution </b> i.e we can sample from it but cannot evaluate it.
						</div>

                                                <br>
                                                <br>
                                                        <img class="plain fragment" data-fragment-index="3" style=""
                                                             data-src="assets/lfi_sim.png" width="700" />
                                                        <div class="plain fragment" data-fragment-index="3" style="position:absolute; top:325px; left:310px; font-size:14px"> Model  </div> 
                                                        <div class="plain fragment" data-fragment-index="3" style="position:absolute; top:395px; left:300px; font-size:14px"> $\theta \sim p(\theta)$ </div> 
                                                        <div class="plain fragment" data-fragment-index="3" style="position:absolute; top:395px; left:570px; font-size:14px; color:black"> $z \sim p(z)$ </div> 
                                                        <div class="plain fragment" data-fragment-index="3" style="position:absolute; top:395px; left:910px; font-size:14px"> $x \sim p(x|\theta)$ </div> 
							
                                                <div class="slide-text fragment " data-fragment-index="3" style="font-size:20px">
                                                        <center> Generating simulations is sampling from the joint distribution, i.e., ${D} = \{x_i, \theta_i\} \sim p(x, \theta)$ </center>
                                                        <br>

                                                <!-- </div> -->
						<!-- <div class="container" style="position:absolute"> -->
						<!-- 	<div class="col"  style="flex: 0 0 37em"> -->
						<!-- 		<div class="block  fragment " data-fragment-index="5" style=" " > -->
						<!-- 			<div class="block-title" style="font-size:22px" > -->
						<!-- 				Q. How to use this for inference? -->
						<!-- 				<\!-- <span class="plain fragment" data-fragment-index="6"> $\,$A. Density estimation problem!</span> -\-> -->
						<!-- 			</div> -->
						<!-- 			<div class="block-content" style="font-size:20px; height:200px"> -->
						<!-- 				<span class="plain fragment" data-fragment-index="6"> Density estimation problem! -->
						<!-- 					<span class="plain fragment" data-fragment-index="7" style="font-size:20px"> -->
						<!-- 						Learn the likelihood distribution. -->
						<!-- 						<br> -->
						<!-- 						Model the likelihood with a parametric distribution $q_\phi$ -->
												
						<!-- 						e.g., -->
						<!-- 						<span class="plain"  style="font-size:18px">$\, {N}(\mu = f_\phi(\theta), \sigma = g_\phi(\theta))$ -->
						<!-- 						</span> -->
						<!-- 					</span> -->
						<!-- 				</span> -->
						<!-- 				<br> -->
						<!-- 				<br> -->
										
						<!-- 				<div class="plain fragment" data-fragment-index="8"> -->
						<!-- 					Fit $\phi$ to match the likelihood -->
						<!-- 					<span style="font-size:16px"> -->
						<!-- 					$q_{\phi}\rightarrow p(x|\theta) : -->
						<!-- 					\quad  \phi^* = \max_{\phi} \sum_i \log q_{\phi}(x_i | \theta_i) $ -->
						<!-- 					</span> -->
						<!-- 				</div> -->
						<!-- 				<div class="plain fragment" data-fragment-index="9"> -->
						<!-- 					Or<br> -->
						<!-- 					Learn the posterior! -->
						<!-- 					<span style="font-size:16px"> -->
						<!-- 					      $\,q_{\phi}\rightarrow p(\theta|x) : -->
						<!-- 					      \quad \phi^* =  \max_{\phi} \sum_i \log q_{\phi}(\theta_i | x_i) $ -->
						<!-- 					</span> -->
						<!-- 				</div> -->
						<!-- 				<br> -->
						<!-- 				<div class="plain fragment" data-fragment-index="10"> -->
						<!-- 					Sufficiently flexible $q_\phi$ $\rightarrow$ parameterized as neural networks like normalizing flows -->
						<!-- 				</div> -->
						<!-- 			</div> -->
						<!-- 		</div> -->
						<!-- 	</div> -->
						<!-- 	<div class="col fragment"  data-fragment-index="5" style="flex: 0 0 20em; text-align:left; font-size:20px; " > -->
								
						<!-- 		<span class="plain fragment fade-in" data-fragment-index="6"> -->
						<!-- 			<img class="plain fragment fade-out" data-fragment-index="7" style="position:absolute; top:-15px; right:-380px; width:250px;" -->
						<!-- 			     data-src="assets/sbi_joint_samples.png" /> -->
						<!-- 		</span> -->

						<!-- 		<span class="plain fragment fade-in" data-fragment-index="7"> -->
						<!-- 			<img class="plain fragment fade-out" data-fragment-index="9" style="position:absolute; top:-15px; right:-380px; width:250px;" -->
						<!-- 			     data-src="assets/sbi_joint.png" /> -->
						<!-- 		</span> -->
								
						<!-- 		<img class="plain fragment current-visible" data-fragment-index="9" style="position:absolute; top:-15px; right:-380px; width:250px" -->
						<!-- 		     data-src="assets/sbi_joint_posterior.png" /> -->
								
						<!-- 		<img class="plain fragment" data-fragment-index="10" style="position:absolute; top:20px; right:-430px; width:400px" -->
						<!-- 		     data-src="assets/nf_cartoon.png" /> -->
								
						<!-- 	</div> -->
						<!-- </div> -->
							
						<div class="plain"  style="position:absolute; top:680px; right:0px; width:300px; font-size:16px; text-align:right"> Cranmer et al. (2020) </div>
						<div class="plain"  style="position:absolute; top:700px; right:0px; width:300px; font-size:16px; text-align:right"> Papamakarios et al. (2017)
						</div>
                                        </section>


				        <!-------------------------------------------------------------------------------->
				        <!-------------------------------------------------------------------------------->

					
                                        <section >
                                                <h3 class='slide-title'>Simulation-based inference: theory</h3>
						<div class="header-right">
							Traditional Analysis<br>
							<font color="orange"> Simulation-based Inference <br>
							$\rightarrow$ Introduction </font> <br>
							Field-level Inference
						</div>


                                                <br>
							
                                                <div class="slide-text " data-fragment-index="3" style="font-size:20px">
                                                        <center> Generating simulations is sampling from the joint distribution, i.e., ${D} = \{x_i, \theta_i\} \sim p(x, \theta)$ </center>
                                                        <br>

                                                </div>
						<div class="container" style="position:absolute">
							<div class="col"  style="flex: 0 0 37em">
								<div class="block   " data-fragment-index="5" style=" " >
									<div class="block-title" style="font-size:22px" >
										Q. How to use this for inference?
										<!-- <span class="plain fragment" data-fragment-index="6"> $\,$A. Density estimation problem!</span> -->
									</div>
									<div class="block-content" style="font-size:20px; height:480px">
										<span class="plain fragment" data-fragment-index="6"> Density estimation problem!

											<br>
											<br>
											<span class="plain fragment" data-fragment-index="7" style="font-size:20px">
												Learn the likelihood distribution.
												<br>
												Model the likelihood with a parametric distribution $q$<span style="color:red" >$_\phi$</span>,
												e.g.,
												<span class="plain"  style="font-size:18px">$\, {N}(\mu = f$<span style="color:red" >$_\phi$</span>$(\theta), \sigma = g$<span style="color:red" >$_\phi$</span>$(\theta))$
												</span>
												<!-- Model the likelihood with a parametric distribution $q_\phi$, -->
												<!-- e.g., -->
												<!-- <span class="plain"  style="font-size:18px">$\, {N}(\mu = f_\phi(\theta), \sigma = g_\phi(\theta))$ -->
												<!-- </span> -->
											</span>
										</span>
										<br>
										<br>
										
										<div class="plain fragment" data-fragment-index="8">
											Fit $\phi$ to match the likelihood
											<span style="font-size:17px">
											$q_{\phi}\rightarrow p(x|\theta)$
											$$ \phi^* = \max_{\phi} \sum_i \log q_{\phi}(x_i | \theta_i) \quad \quad \{x_i, \theta_i\} \sim p(x, \theta)$$
											</span>
										</div>
										<div class="plain fragment" data-fragment-index="9">
											Or
											<br>
											Learn the posterior
											<span style="font-size:17px">
											      $\,q_{\phi}\rightarrow p(\theta|x) :$
											      $$ \phi^* =  \max_{\phi} \sum_i \log q_{\phi}(\theta_i | x_i)  \quad \quad \{x_i, \theta_i\} \sim p(x, \theta)$$
											</span>
										</div>
										<br>
										<div class="plain fragment" data-fragment-index="10">
											Sufficiently flexible $q_\phi$ $\rightarrow$ parameterized as neural networks like normalizing flows
										</div>
									</div>
								</div>
							</div>
							<div class="col "  data-fragment-index="5" style="flex: 0 0 20em; text-align:left; font-size:20px; " >
								
								<span class="plain " data-fragment-index="6">
									<img class="plain fragment fade-out" data-fragment-index="7" style="position:absolute; top:15px; right:-350px; width:250px;"
									     data-src="assets/sbi_joint_samples.png" />
								</span>

								<span class="plain fragment fade-in" data-fragment-index="7">
									<img class="plain fragment fade-out" data-fragment-index="9" style="position:absolute; top:15px; right:-350px; width:250px;"
									     data-src="assets/sbi_joint.png" />
								</span>
								
								<img class="plain fragment" data-fragment-index="9" style="position:absolute; top:15px; right:-350px; width:250px"
								     data-src="assets/sbi_joint_posterior.png" />
								
								<img class="plain fragment" data-fragment-index="10" style="position:absolute; top:300px; right:-420px; width:390px"
								     data-src="assets/nf_cartoon.png" />
								
							</div>
						</div>
							
						<div class="plain"  style="position:absolute; top:620px; right:0px; width:300px; font-size:16px; text-align:right"> Cranmer et al. (2020) </div>
						<div class="plain"  style="position:absolute; top:640px; right:0px; width:300px; font-size:16px; text-align:right"> Papamakarios et al. (2017)
						</div>
                                        </section>


				        <!-------------------------------------------------------------------------------->
				        <!-------------------------------------------------------------------------------->

                                
                                        <section >
                                                <h3 class='slide-title'>Simulation-based inference: in practice </h3>
						<div class="header-right">
							Traditional Analysis<br>
							<font color="orange"> Simulation-based Inference <br>
							$\rightarrow$ Introduction </font> <br>
							Field-level Inference
						</div>

                                                <br>
						

						<div class="container">
							<div class="col slide-text"  style="flex: 0 0 38em; font-size:20px">
								<div class="" data-fragment-index="1">
 									<br>
									<u> 1. Training data </u>
									<br>
									Generate a dataset of simulations
									$$ D = \{x_i, \theta_i\}_{i\in N} \sim p(x, \theta)$$
								</div>

								<div class="fragment" data-fragment-index="2">
									<br>
									<u> 2. Learn the posterior </u>
									<br>
									Choose a parametric distribution $q_\phi(\theta | x)$
                                                                        <br>
									Optimize to fit $\phi$
									$$\phi^* = \max_{\phi} \sum_i \log q_{\phi}(\theta_i | x_i) $$
								</div>
								
								<!-- <div class="fragment" data-fragment-index="3"> -->
								<!-- 	In the limit of <b class="plain fragment highlight-current-green" data-fragment-index="5" > large number of samples</b>, $N$, and  <b class=" fragment highlight-green" data-fragment-index="6" > sufficient flexibility </b> of $q_\phi$, -->
								<!-- 	$$ q_{\phi^*}(\theta | x) \approx  p(\theta | x) $$ -->
									<!-- </div> -->
								<div class="fragment" data-fragment-index="3">
									With large number of samples
									$$ q_{\phi^*}(\theta | x) \approx  p(\theta | x) $$
								</div>

								
								<div class="fragment" data-fragment-index="4">
									<u> 3. Inference</u>
 									<br>
									Given observed data: $x_{\rm obs}$
									$$\theta \sim q_{\phi^*}(\theta | x_{\rm obs})$$
								<br>
								</div>
							</div>
							
							<div class="col"  style="flex: 0 0 30em">

								<img class="plain fragment fade-out"  data-fragment-index="2" style="position:absolute; top:100px; right:50px; width:500px "
								     data-src="assets/sbi_pipeline0.png"  />
								<img class="plain fragment current-visible"  data-fragment-index="2" style="position:absolute; top:100px; right:50px; width:500px "
								     data-src="assets/sbi_pipeline2.png"  />
								<img class="plain fragment current-visible"  data-fragment-index="3" style="position:absolute; top:100px; right:50px; width:500px "
								     data-src="assets/sbi_pipeline_trained.png"  />
								<div class="plain fragment "  data-fragment-index="4" style="position:absolute; top:250px; right:50px; width:500px; font-size:20px "
								     data-src="assets/sbi_inference.png" >
									<em> Inference with observed data </em>
									<br>
									<img class="plain  "  data-src="assets/sbi_inference2.png"/ >
								</div>
								

								
							</div>
						</div>
						
						<br>
						<div class="plain"  style="position:absolute; top:650px; right:20px; width:300px; font-size:16px; text-align:right">
							Cranmer et al. (2020)
							<br>
							Papamakarios et al. (2017)
						</div>
						
                                        </section>
                                
                                        <!-- <section > -->
                                        <!--         <h3 class='slide-title'>Simulation-based inference: in practice </h3> -->
					<!-- 	<div class="header-right"> -->
					<!-- 		Traditional Analysis<br> -->
					<!-- 		<font color="orange"> Simulation-based Inference <br> -->
					<!-- 		$\rightarrow$ Introduction </font> <br> -->
					<!-- 		Field-level Inference -->
					<!-- 	</div> -->

                                        <!--         <br> -->
						

					<!-- 	<div class="container"> -->
					<!-- 		<div class="col slide-text"  style="flex: 0 0 30em; font-size:22px"> -->
					<!-- 			<div class="" data-fragment-index="1"> -->
					<!-- 				Generate a dataset of simulations -->
					<!-- 				$$\mathcal{D} = \{x_i, \theta_i\}_{i\in N} \sim p(x, \theta)$$ -->
					<!-- 			</div> -->
					<!-- 			<div class="fragment" data-fragment-index="2"> -->
					<!-- 				Assume conditional, parametric distribution $q_\phi(\theta | x)$ and <br> -->
                                        <!--                                 optimize the distribution parameters $\phi$ -->
					<!-- 				$$\max_{\phi} \sum_i \log q_{\phi}(\theta_i | x_i) $$ -->
					<!-- 			</div> -->
								
					<!-- 			<div class="fragment" data-fragment-index="3"> -->
					<!-- 				In the limit of <b class="plain fragment highlight-current-green" data-fragment-index="5" > large number of samples</b>, $N$, and  <b class=" fragment highlight-green" data-fragment-index="6" > sufficient flexibility </b> of $q_\phi$, -->
					<!-- 				$$ q_{\phi^*}(\theta | x) \approx  p(\theta | x) $$ -->
					<!-- 			</div> -->
					<!-- 		</div> -->
							
					<!-- 		<div class="col"  style="flex: 0 0 30em"> -->

					<!-- 			<img class="plain fragment fade-out"  data-fragment-index="2" style="position:absolute; top:100px; right:50px; width:500px " -->
					<!-- 			     data-src="assets/sbi_pipeline0.png"  /> -->
					<!-- 			<img class="plain fragment current-visible"  data-fragment-index="2" style="position:absolute; top:100px; right:50px; width:500px " -->
					<!-- 			     data-src="assets/sbi_pipeline.png"  /> -->
					<!-- 			<img class="plain fragment current-visible"  data-fragment-index="3" style="position:absolute; top:100px; right:50px; width:500px " -->
					<!-- 			     data-src="assets/sbi_pipeline.png"  /> -->
					<!-- 			<div class="plain fragment "  data-fragment-index="4" style="position:absolute; top:250px; right:50px; width:500px; font-size:20px " -->
					<!-- 			     data-src="assets/sbi_inference.png" > -->
					<!-- 				<em> Inference with observed data </em> -->
					<!-- 				<br> -->
					<!-- 				<img class="plain  "  data-src="assets/sbi_inference.png"/ > -->
					<!-- 			</div> -->
								

								
					<!-- 		</div> -->
					<!-- 	</div> -->
						
					<!-- 	<br> -->
					<!-- 	<div class="slide-text fragment" data-fragment-index="6" style="position:relative; left:50px; font-size:22px"> -->
                                        <!--                 $q_\phi$ is parameterized as a neural network, e.g. normalizing flows <br> -->
					<!-- 		<\!-- $\rightarrow$ Neural posterior estimation (NPE) -\-> -->
					<!-- 		<br> -->
					<!-- 		<\!-- <img class="plain " data-fragment-index="3" style="position:absolute; top:480px; left:520px" -\-> -->
					<!-- 		<\!--              width="320px" data-src="assets/maf_example.png"  /> -\-> -->
                                        <!--         </div> -->
					<!-- 	<img class="plain fragment"  data-fragment-index="6" style="position:absolute; top:450px; right:150px " -->
                                        <!--              width="300px" data-src="assets/maf_example.png"  /> -->

					<!-- 	<div class="plain"  style="position:absolute; top:650px; right:20px; width:300px; font-size:16px; text-align:right"> -->
					<!-- 		Cranmer et al. (2020) -->
					<!-- 		<br> -->
					<!-- 		<span class="plain fragment"  data-fragment-index="6"> -->
					<!-- 			Papamakarios et al. (2017) -->
					<!-- 		</span> -->
					<!-- 	</div> -->
						
                                        <!-- </section> -->

                                </section>
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->

				<section >
					<h3 class='slide-title'>Example application: <font style="font-variant:small-caps"> SimBIG</font> collaboration</h3>
						<div class="header-right">
							Traditional Analysis<br>
							<font color="orange"> Simulation-based Inference <br>
							$\rightarrow$ Application </font> <br>
							Field-level Inference
						</div>
					
                                        <br>
                                        First galaxy clustering analysis with SBI on survey data.
                                        <br>
                                        <br>

                                        <div class="container">
						<div class="col"  style="flex: 0 0 30em">
                                                        <div class="slide-text">
								<ul>
									<li class="plain " data-fragment-index="1"> Data
										<ul  style="font-size:20px">
											
											<!-- <li> BOSS: SDSS III survey, spectra of $\sim$1.4 million galaxies from 2008-2014 </li>  -->
											<li> ~100,000 galaxies mapped by BOSS from 2008-2014 (total ~1.4 million). </li>
										</ul>
									</li>
									<br>
									<li class="plain fragment " data-fragment-index="2" > Simulations
										<ul style="font-size:20px">
											<li> 2000 N-Body simulations of Quijote suite</li>
											<li> Populate galaxies and impose survey realism- geometry, mask</li>
										</ul>
									</li>
									<br>
									<li class="plain fragment " data-fragment-index="3" > Statistics
										<ul style="font-size:20px">
											<li> <u>Traditional:</u> Power spectrum,
												bispectrum
											</li>
											<li> <u>New:</u> Wavelets, CNN-based statistics
											</li>
											<!-- <li> Up to small scales $k_{\mathrm max} \leq 0.5$ h/Mpc instead of $k_{\mathrm max} \leq 0.25$ h/Mpc -->
											<li> Push to much smaller scales
											</li>
											<!-- <li> Constrain 5 cosmology, 9 HOD and 1 nuisance parameter   </li> -->
										</ul>
									</li>
									<br>
									<li class="plain fragment " data-fragment-index="4" > Results 
										<ul style="font-size:20px">
											
								
											<li  >  1.6, 1.5, 1.7, 1.2, and 2.3x tighter constraints on $\Omega_b, h, n_s, \Omega_m, \sigma_8$</b>
											</li>
								
								
												<!-- $\rightarrow$  $\approx$  gain from analyzing 60% larger galaxy sample </li> -->
											<!-- <li  > Going beyond perturbative analyses ($k_{\mathrm max} =0.25$ h/Mpc) </li> -->
										</ul>
									</li>
								</ul>
								<br>
								<br>
								<!-- <div class="plain fragment " data-fragment-index="6" style="font-size:20px" > Ongoing work with other statistics, e.g. wavelets, marked power spectrum </div> -->
									

                                                        </div>
						</div>
						
						<div class="col" style="flex: 0 0 25em">
							<img class="plain fragment fade-out" data-fragment-index="2" style="position:absolute; top:180px; right:30px"
                                                             data-src="assets/boss_telescope.jpg" width="360" />
							<img class="plain fragment current-visible" data-fragment-index="2" style="position:absolute; top:180px; right:30px"
                                                             data-src="assets/simbig_fwmodel.png" width="490" />
							<img class="plain fragment current-visible" data-fragment-index="3" style="position:absolute; top:180px; right:30px"
                                                             data-src="assets/simbig_pell2.png" width="520" />
							<img class="plain fragment" data-fragment-index="4" style="position:absolute; top:180px; right:70px"
                                                             data-src="assets/simbig_constraint2.png" width="380" />
						</div>
						<div class="plain " data-fragment-index="1" style="position:absolute; bottom:-80px; right:20px; font-size: 16px; text-align:right">
							Hahn et al. (including <b><u> Modi</b></u>) (2022a, 2022b, 2023) <br>
							Rgaldo-Saint Blancard et al. (including <b><u> Modi</b></u>) (2023) <br>
							Lemos et al. (including <b><u> Modi</b></u>) (2023) <br>
							<span class="fragment" data-fragment-index="2" > Villaescusa-Navarro et al. (2019) </span>
						</div>

						<br>
						
					</div>
                                        
        				
				</section>


				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				<section>
					<div style="font-size:28px">Simulation-based inference finally allows us to use powerful summary statistics<br>without access to explicit likelihood.
						<br>
						<!-- Can we just apply this to the upcoming cosmological surveys? -->
						<br>
						<br>

						<div  class='fragment fade-out' data-fragment-index="1">
							<img style="position:absolute; top:150px; right:500px; width:300px; border:none"
							     data-src="assets/its_over.png"  />
						</div>
						<div class="plain fragment" data-fragment-index="1">
							But, two <u>fundamental</u> challenges for SBI moving ahead</div>
						<br>
						<div class="container fragment " data-fragment-index="1" style="width:800px; font-size:24px; margin:auto">
							<div class="col">
								<div class="boxonly alert" style="background-color:#44444;  border-radius: 100px; width:250px"> <br>1. Number of <br>simulations<br><br> </div>
							</div>
							<div class="col">
								<div class="boxonly alert" style="background-color:#44444;  border-radius: 100px; width:250px"> <br>2. Model<br>misspecification<br> <br></div>
							</div>
						</div>
						<br>
						<br>
						<!-- <div class="fragment" style="font-size:24px"> -->
						<!-- 	Other open questions, e.g.,  which SBI methodology to use, how to construct optimal summary statistic, how to efficiently sample prior distribution? -->
						<!-- </div> -->
					</div>
				</section>

                                <!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->

				<section >

					<section>
					<h3 class='slide-title'>Challenges to SBI #1</h3>
						<div class="header-right">
							Traditional Analysis<br>
							<font color="orange"> Simulation-based Inference <br>
							$\rightarrow$ Challenge #1 </font> <br>
							Field-level Inference
						</div>
						<br>
						<div class="boxonly" style="width:1000px; padding:8px; font-size:22px"> <b class="alert"> High fidelity simulations:</b> SBI training converges in the limit of a large number of samples. </div>
						<br>
						<br>
						<div class="slide-text" style="font-size:22px">
							<ul>
								<li  class="plain" data-fragment-index="1" style="font-size:20px"> Why did <font style="font-variant:small-caps">  SimBIG</font> only analyze 100,000 galaxies <br>
									of the ~1 million galaxies mapped by BOSS?
  									<div class="plain fragment" data-fragment-index="2", style="font-size:20px" > 
										$\quad \rightarrow$ limited by the simulation suite <br>
										$\quad \rightarrow$ Quijote, the  <b> largest</b> simulation suite
									</div>
								</li>
								<br>
								<li  class="plain fragment" data-fragment-index="2" style="font-size:20px"> Upcoming surveys like DESI, LSST, Euclid
  									<div class="plain fragment" data-fragment-index="2", style="font-size:20px" > 
										$\quad \rightarrow$ probe larger volume, <br>
										$\quad \rightarrow$ require higher resolution simulations <br>
										<!-- $\quad \rightarrow$ at higher fidelity of galaxy models <br> -->
									</div>
									<br>
							</ul>
							
							<br>
							<br>
							<br>

							<div  class='fragment' data-fragment-index="3">
								<img style="position:absolute; top:170px; right:50px; width:450px"
								     data-src="assets/cartoon_resources.jpeg"  />
							</div>
							<div class='fragment' data-fragment-index="3" style="position:absolute; top:480px; left:20px; width:750px; text-align:center">
								
								<b class="alert"> We do not have the computational resources </b><br>
								to generate training simulations
								for the upcoming cosmological surveys.
							</div>
							
						</div>
						<br>
						
					</section>
       					
					<!-------------------------------------------------------------------------------->
					
					<section>
					<h3 class='slide-title'>So how do we scale SBI?</h3>
						<div class="header-right">
							Traditional Analysis<br>
							<font color="orange"> Simulation-based Inference <br>
							$\rightarrow$ Challenge #1 </font> <br>
							Field-level Inference
						</div>
                                        <br>
                                        <div style="font-size:22px"> SBI is needed to push to smaller scales, with higher order summary statistics.
						<br>
						On the largest scale, SBI is not necessary.
					</div>
                                        <br>
                                        <!-- <div class="boxonly" style="width:1000px; padding:8px"> SBI is needed to push to smaller scales, with higher order summary statistics. -->
						<!-- 	<br> -->
						<!-- 	On the largest scale, SBI is not necessary. -->
						<!-- </div> -->
					<div class="container">
						<div class="col"  style="flex: 0 0 29em">
							
							<div class="block fragment" data-fragment-index="1" style="" >
								<div class="block-title" style="font-size:22px">
									<b> Hybrid SBI</b>: Combine EFT with SBI (<u>Modi</u> and Philcox 2023)
								</div>
								<div class="block-content" style="font-size:20px">
									Split the data vector into two components:  $\,{x} = \{{x_L}, {x_S}\}$
									$$
									p(x | \theta) = p(x_L | \theta) \times  p(x_S |x_L,  \theta)
									$$
									<ul>
										<li class="fragment " data-fragment-index="2"> $ p(x_L | \theta)$ <br>
											$\rightarrow$ modeled with EFT <br>
											$\rightarrow$ $ x_L$ : any $N$-point statistic
										</li>
										<br>
										<li class="fragment " data-fragment-index="2"> $p(x_S |x_L,  \theta)$  <br>
											$\rightarrow$ modeled with SBI<br>
											$\rightarrow$ using <u> customized  small volume simulations </u> <br>
											$\rightarrow$ $ x_S$ : any higher order statistic, e.g,. wavelets
										</li>
									</ul>
									<br>

								</div>
							</div>
							<br>
						</div>
						<div class="col"  style="flex: 0 0 30em">
							<span  class="plain fragment fade-in" data-fragment-index="1" style="position:absolute; top:230px; right:10px; width:600px">
								<span  class="plain fragment fade-out" data-fragment-index="3" >
									<img data-src="assets/hysbi_method2.png"  />
								</span>
							</span>
							<span  class="plain fragment fade-in" data-fragment-index="3" style="position:absolute; top:190px; right:70px; width:450px" >
								<img data-src="assets/hysbi_corner_eighth.png"  />
								<div style="font-size:16px; text-align:left; margin-left:30px; position:relative; top:-15px">
									<!-- $x_L$ : P($k$), $k \leq 0.15$ h/Mpc <br> -->
									<!-- $x_S$ : P($k$), $0.15 \leq k \leq 0.5$ h/Mpc <br> -->
									<!-- $\quad\,$ Wavelets -->
								</div>
								<br>
								<!-- <em style='font-size:16px'> Hybrid-SBI trained on 1/8$^{th}$ the simulation volume outperforms standard analyses </em>  -->
							</span>

							<span class="plain fragment fade-in" data-fragment-index="3"
							      style="font-size:16px; text-align:right; position:absolute; bottom:70px"> <b><u>Modi</b></u> and Philcox 2023 
							</span>
						</div>
					</div>
					<br>
					<div class="fragment " data-fragment-index="3" style="text-align:center; font-size:22px">
						Hybrid SBI outperforms traditional analyses with training only on small ($1/8^{th}$) simulation volumes.
					</div>
					</section>
					
					<!-------------------------------------------------------------------------------->

					<!-------------------------------------------------------------------------------->
					
					<section>
						<h3 class='slide-title' >Roadmap for Hybrid SBI</h3>
						<div class="header-right">
							Traditional Analysis<br>
							<font color="orange"> Simulation-based Inference <br>
							$\rightarrow$ Challenge #1 </font> <br>
							Field-level Inference
						</div>
						<br>
						<br>
						<div class="slide-text" style="font-size:22px">
							<ul>
								<li> Developing customized multi-scale simulations to train SBI with small volumes <br>
									
								</li>
								<br>
								<li> Consistently marginalize over nuisance parameters of EFT and SBI model parameters
								</li>
								<br>
								<!-- <li> Model survey systematics in hybrid SBI framework -->
								<!-- </li> -->
							</ul>
							<br>
							<br>
							<br>
							<br>
							<br>
							<br>
							<br>
							<div class="" style="font-size:22px; text-align:center">
								<em> Realistic approach to scale SBI to upcoming cosmological surveys. </em>
							</div>
							<span  class="plain " style="position:absolute; top:140px; right:90px; width:250px" >
								<img  style="border:none"  data-src="assets/zoom_in.png"  />
							</span>
							<span  class="plain " style="position:absolute; top:260px; right:350px; width:100px; font-size:14px" >
								<img style="border:none" data-src="assets/gemma.jpg"  />
								<br>
								<div style="position:relative; top:-15px; " > Gemma Zhang </div>
							</span>
							<br>
							<br>
							<br>
							
						</div>
						
					</section>
				</section>

                                <!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->


				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				
				<section >
					<h3 class='slide-title'>Challenges to SBI #2</h3>
						<div class="header-right">
							Traditional Analysis<br>
							<font color="orange"> Simulation-based Inference <br>
							$\rightarrow$ Challenge #1 </font> <br>
							Field-level Inference
						</div>
					
                                        <br>
					<div class="boxonly" style="width:1200px; padding:8px; font-size:22px">
						<b class="alert"> Model misspecification:</b> SBI assumes that the observed data is generated from the same model (simulation).
					</div>
                                        <br>
					
                                        <div class="plain fragment" data-fragment-index="1" style="font-size:22px" > Inference is unreliable if the simulation & data-model are different. </div>

					<br>
					<div class="container">
						<div class="col"  style="flex: 0 0 34em">
                                                        <div class="slide-text" style="font-size:22px">
								<br> 
								<div class="block fragment" data-fragment-index="2" style="position:relative; top:-20px" >
									<div class="block-title" >
										How do we use SBI when we do not have the exact model?
									</div>
									<div class="block-content" style="font-size:20px">
										We have multiple models for the same data.
										<br>
										<span class="fragment " data-fragment-index="3" style="font-size:20px">
											$\quad \rightarrow$ <u>Data-cuts</u>: confident in regimes where these agree.
											<br>
											$\quad \rightarrow$ <u>Robust algorithms</u>:  construct invariant statistics.
											
										</span>
										
										<br>
										<br>
										
										<span class="plain fragment" data-fragment-index="4" >
											<!-- Better galaxy models! -->
											<!-- <br> -->
											<span style="font-size:20px">
												<span class="fragment highlight-green " data-fragment-index="7">
													Physically motivated</span> semi-analytic models for cosmology. </span>
												
												<br>
											<span class="plain fragment" data-fragment-index="6" style="font-size:20px">
												$\quad \rightarrow$ Learn generative models for halo-merger trees.
											</span>
											<br>
											<br>
											<span class="plain fragment" data-fragment-index="7" style="font-size:20px">
												 Constrain <u>galaxy formation</u> with  cosmology
											</span>
                                                                                </span>

									</div>
								</div>
								<br>
							</div>
						</div>
						
						<div class="col" style="flex: 0 0 25em">
							<span  class="plain fragment fade-in" data-fragment-index="1" style="position:absolute; top:220px; right:50px; width:360px">
								<span class="plain fragment fade-out" data-fragment-index="2" > 
									<img data-src="assets/sbi_diffhod.png"  />
									<br>
									<em style="font-size:20px; position:relative; top:-16px"> SBI predictions for 2 different datasets.
										<br>
									Train: 5 parameter galaxy model.</em>
								</span>
							</span>
					                <span class="fragment fade-in" data-fragment-index="2" >
								<span class="fragment fade-out" data-fragment-index="5" >
									<div class="block " style="position:absolute; top:270px; right:10px; width:420px" >
										<div class="block-content" style="font-size:20px">
											E.g., models for populating galaxies:
											<br>
											<br>
											<u>Empirical models</u>
											<ul>
												<span class="fragment highlight-green " data-fragment-index="4">
													<li> Halo occupation distribution (HOD) </li>
													<li> Subhalo abundance matching (SHAM)</li>
												</span>
											</ul>
											<br>
											<br>
											<u>Physical models</u>
											<ul>
												<span class="fragment highlight-red " data-fragment-index="4">
													<li> Semi-analytic models (SAM)</li>
												</span>
												<span class="plain ">
													<li> Hydro simulations </li>
												</span>
											</ul>
										</div>
									</div>
								</span>
							</span>
							
							<div class="plain fragment fade-in" data-fragment-index="5" style="position:absolute; top:240px; right:10px;">
								<span class="plain fragment fade-out" data-fragment-index="6">
									<img class="plain" data-src="assets/merger_tree_example.png" width="420px" /><br>
									<span style="font-size:20px; position:relative; top:-20px">
										Halo merger-trees.<br>
									</span>
									<span style="font-size:16px ; position:relative; top:-370px; right:-90px">
										Credits: Frank van den Bosch
									</span>
									<span style="text-align:center; font-size:18px ; position:relative; top:-180px; left:-280px; color:black">
										$\Bigg\downarrow$<br>
										<em style='position:relative ; left:110px'> time</em>
									</span>
									
								</span>
							</div> 

							<div class="plain fragment fade-in" data-fragment-index="6" style="position:absolute; top:230px; right:10px;">
								<span class="plain fragment fade-out" data-fragment-index="7">
									<img class="plain" data-src="assets/merger_trees.png" width="420px" /><br>
								<span style="font-size:20px; position:relative; top:-20px"> Ensemble of ML generated & N-Body trees </span>
								</span>
							</div>

							<div class="plain fragment fade-in" data-fragment-index="7" style="position:absolute; top:280px; right:10px; ">
								<span class="plain fragment fade-out" data-fragment-index="8">
									<img class="plain" data-src="assets/sam_cartoon.png" width="450px" /><br>
								<span style="font-size:20px; position:relative; top:-20px"> Physical processes in semi-analytic models. </span>
								</span>
							</div>

							
							<span class="fragment fade-in" data-fragment-index="8" >
								<span class="" >
									<img class="plain fragment grow"  data-fragment-index="7"  style="position:absolute; top:180px; right:-100px"
									     height="380px" width="700px" data-src="assets/sbi_robust.png"  />
								</span>
							</span>

                                                        <div  class="plain fragment " data-fragment-index="1" style="position:absolute; top:620px; right:20px; font-size:16px; text-align:right; ">
								<b><u>Modi</b></u> et al. (2023)<br>
								<span  class="plain fragment " data-fragment-index="3">
									Arjovsky, Bottou et al. (2019) <br>
								</span>
								<span  class="plain fragment " data-fragment-index="5">
									Behroozi, Wechsler et al. (2011) <br>
								</span>
								<span  class="plain fragment " data-fragment-index="6">
									Nguyen, <b><u>Modi</b></u>, Li, Somerville <br>
									<img class="plain fragment fade-out " data-fragment-index="7" style="position:relative; top:-110px; left:-280px; width:100px"
									     data-src="assets/tringyun.jpg"  /><br>
								</span>
								
							</div>
							
						</div>
						<br>
						
					</div>
					<br>
                                        <div  class="fragment" data-fragment-index="8" style="font-size:22px">
                                                Inter-disciplinary collaboration is necessary to move forward.
					</div>

        				
				</section>

                                <!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->

				<!-- <section> -->

				<!-- 	<h3 class='slide-title'>Story of simulation-based inference in cosmology</h3> -->
					

				<!-- 	<br> -->
				<!-- 	<div class="slide-text" style="font-size:22px"> -->
				<!-- 			<ul> -->
				<!-- 				<li> Use simulations to -->
				<!-- 					<ul> -->
				<!-- 						<li> push to small scales </li> -->
				<!-- 						<li> use higher order statistics </li> -->
				<!-- 					</ul> -->
				<!-- 				</li> -->
				<!-- 				<br> -->
				<!-- 				<li> First application on galaxy clustering data with SimBIG collaboration <br> -->
				<!-- 					<ul> -->
				<!-- 						<li> BOSS south-galacitc cap data </li> -->
				<!-- 						<li> power spectrum, bispectrum, wavelets, CNN   </li> -->
				<!-- 					</ul> -->
				<!-- 				</li> -->
				<!-- 				<br> -->
				<!-- 				<li> Challenge #1: No computational resources for training simulations <br> -->
				<!-- 					<ul> -->
				<!-- 						<li> Hybrid SBI: combine EFT on large scales with SBI on small scales  <br> -->
				<!-- 						$\quad \rightarrow$  Develop multi-scale simulations, consistent marginalization of parameters -->

				<!-- 						</li> -->
				<!-- 					</ul> -->
				<!-- 				</li> -->
				<!-- 				<br> -->
				<!-- 				<li> Challenge #2: Model-misspecification <br> -->
				<!-- 					<ul> -->
				<!-- 						<li> Develop robust algorithms, invariant to different models </li> -->
				<!-- 						<li> Scale galaxy models like SAM to cosmological scales. <br> -->
				<!-- 							$\quad \rightarrow$ also allows to learn galaxy formation -->
				<!-- 						</li> -->
				<!-- 					</ul> -->
				<!-- 				</li> -->
                                <!--                         </ul> -->
				<!-- 		</div> -->
 				<!-- 	<br> -->
					
				<!-- </section> -->

				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				
                                <section>
					
					<h3 class='slide-title'>Story of simulation-based inference in cosmology</h3>
					

					<br>
					<div class="slide-text" style="font-size:22px">
						<div class="block-title" , style="text-align:left; font-size:22px">
							Current status
						</div>
						<div class="block-content", style="text-align:left; font-size:20px">
							<ul>
								<li> Use simulations to push to small with higher order summary statistics </li>
								<br>
								<li> First application on data: BOSS survey  with SimBIG collaboration
								</li>
							</ul>
						</div>
                                                        
						<!-- <div class="block-title" , style="text-align:left; font-size:22px"> -->
						<!-- 	Application -->
						<!-- </div> -->
						<!-- <div class="block-content", style="text-align:left; font-size:20px"> -->
						<!-- </div> -->
                                                
                                                <br>        
						<div class="block-title" , style="text-align:left; font-size:22px">
							Challenges ahead
						</div>
						<div class="block-content", style="text-align:left; font-size:20px">
							
							<ol>
								<li> No computational resources for training simulations. <br>
									<ul>
										<li> Hybrid SBI: combine EFT on large scales with SBI on small scales.  <br>
										</li>
									</ul>
								</li>
								<br>
								<li>  Model-misspecification <br>
									<ul>
										<li> Better galaxy models like semi-analytic models for cosmology. <br>
										<li> Develop robust algorithms, invariant to different models. </li>
										</li>
									</ul>
								</li>
                                                        </ol>

						</div>
                                                
					</div>
 					<br>
					
				</section>
				
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				
				
                                <section class="" data-background="">
					<div style="font-size:35px">
						SBI is promising.
						<br>
                                                <!-- <img class="plain" " data-src="assets/best_can_do.png" style='position:absolute; left:60px; top:0px; height:250px;' /> -->
                                                <img class="plain" data-src="assets/best_can_do.png" style=' height:300px;' />
						<br>
						<div class="data fragment" style="font-size:70px">3. Field-level Inference</div>
						<br>
						<br>
					</div>
				</section>

				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->

                                <section>
						<h3 class='slide-title'> Field-level Inference </h3>
						<div class="header-right">
							Traditional Analysis<br>
							Simulation-based Inference <br>
							<font color="orange"> Field-level Inference<br>
							$\rightarrow$ Introduction </font> 
						</div>

                                                <br>
                                                <div class="">
							<div class="boxonly" style="width:1100px; padding:10px; font-size:22px">
                                                                Use simulations to model the field-level data <b class="alert" >without any compression. </b> <br>
								<div class="fragment" data-fragment-index="2">
									$\rightarrow$ Simultaneously infer the initial conditions of the Universe and the cosmological parameters.
								</div>
                                                        </div>

                                                        <br>
                                                        <!-- <div class="plain fragment",  data-fragment-index="3", style="font-size:22px;"> -->
							<!-- 	$$ \log p(z | x) \propto  \log p(x| f(z)) \ + \log p(z) $$ -->
							<!-- 	E.g., infer the initial conditions ($z$) by maximizing the posterior: $\hat{z} =  \max_z \log p(z | x)$ -->
                                                        <!-- </div> -->
                                                        <div class="plain fragment",  data-fragment-index="3", style="font-size:22px; text-align:left; margin-left:100px">
								<b> Bayesian inference </b>
								$$ \log p(z, \Lambda | x) \propto  \log p(x| f(z, \Lambda)) \ + \log p(z) \ + \log p(\Lambda) $$
								<!-- E.g., infer the initial conditions ($z$) by maximizing the posterior: $\hat{z} =  \max_z \log p(z | x)$ -->
                                                        </div>
							<br>
							
                                                        <span class="plain fragment fade-in" data-fragment-index="1">
								<span class="plain fragment fade-out" data-fragment-index="3">
									<!-- <img class="plain" style="position:absolute; left:-300px; top:250px" data-src="assets/fwdmodel.png" style='height:500px;' /> -->
									<img class="plain" style="position:absolute; left:50px; top:380px; width:900px" data-src="assets/fwdmodel2.png"  />
								</span>
							</span>
                                                </div>
						
                                                <div class="block fragment current-visible" data-fragment-index="0" style="position:absolute; bottom:30px; left:100px; width:400px">
							<div class="block-title" , style="text-align:center; font-size:22px">
								But which summary statistic?
							</div>
							<div class="block-content", style="text-align:center; font-size:20px">
                                                                wavelets <br>
                                                                bispectrum <br>
                                                                trispectrum <br>
                                                                peak counts <br>
                                                                density splits <br>
                                                                k-nearest neighbor <br>
                                                                Minkowski functionals <br>
                                                                marked power spectrum <br>
                                                                reconstructed power spectrum <br>
                                                                ...
							</div>
                                                        
						</div>
                                                

                                                <div class="container" style="font-size:22px">
                                                                <div class="col fragment" data-fragment-index="3">
                                                                        <img class="plain" data-src="assets/init_field.png" style='height:250px;' />
                                                                        <br> True initial conditions <br> $z_0$
                                                                </div>

                                                                <div class="col fragment" data-fragment-index="3">
                                                                        <img class="plain" data-src="assets/reconim_init.gif" style='height:250px;' />
                                                                        <br> Reconstructed initial conditions<br>$z$
                                                                </div>

                                                                <div class="col fragment" data-fragment-index="3">
                                                                        <img class="plain" data-src="assets/reconim_fin.gif" style='height:250px;' />
                                                                        <br> Reconstructed data <br> $x = f(z)$
                                                                </div>
								
                                                                <div class="col " data-fragment-index="1">
                                                                        <img class="plain" data-src="assets/fin_field.png" style='height:250px;' />
                                                                        <br> Data <br> $x = f(z_0)$
                                                                </div>
                                                        <br>
                                                </div>
                                </section>
                                                
                                                
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				<section>
					<div style="font-size:32px">
						<!-- In addition to inferring a handful of cosmology parameters, <br> -->
						<!-- we now also wish to estimate millions of latent parameters.<br> -->
						<!-- <div class="fragment"> Why? -->
						<!-- </div> -->
						In addition to inferring a handful of cosmology parameters, <br>
						we now also wish to estimate millions of latent parameters.<br>
						<div class="fragment"  data-fragment-index="1"> Why?
						</div>
						<br>
						<br>
						<div class="container fragment"  data-fragment-index="2" style="margin:auto; width:600px; font-size:26px">
							<div class="col">
								<div class="boxonly alert" style="background-color:#44444;  border-radius: 100px; width:200px"> <br>1.<br>Optimal<br>analysis<br><br> </div></div>
							<!-- <div class="col"> -->
							<!-- 	<div class="boxonly alert" style="border-radius: 100px; width:160px">  <br>2.<br>Joint<br>analysis<br><br> </div> </div> -->
							<div class="col">
								<div class="boxonly alert" style="border-radius: 100px; width:200px; ">  <br>2.<br> New science<br>cases<br><br> </div>
							</div>
						</div>
                                                <img class="plain fragment" data-fragment-index="1" data-src="assets/cartoon_goodidea.jpeg" style='position:absolute; left:60px; top:180px; height:250px;' />
                                                <img class="plain fragment" data-fragment-index="2" data-src="assets/cartoon_goodidea2.jpeg" style='position:absolute; right:60px; top:180px; height:250px;' />

					</div>
				</section>

                                <!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				<section>


                                        <section>
                                                
                                                <h3 class='slide-title'> Why field-level inference #1 </h3>
						<div class="header-right">
							Traditional Analysis<br>
							Simulation-based Inference <br>
							<font color="orange"> Field-level Inference<br>
							$\rightarrow$ Advantages </font> 
						</div>
                                                
                                                <br>
						<div class="boxonly" style="width:600px; padding:10px; font-size:22px">
							It is the  <b class="alert"> optimal </b>  approach to cosmological analysis
						</div>
						
                                                <div class="slide-text", style="position:relative;">
                                                        <br>
							<br>
							
                                                                <span class="fragment " data-fragment-index="1"> No information is lost by compressing data into low-dimensional summary statistics.
                                                                </span>
								<br>
                                                                <span class="fragment " data-fragment-index="1"> Robust: develop null tests by forward modeling the initial conditions.
                                                                </span>
                                                        <br>
                                                        <img class="fragment plain"   data-fragment-index="1" width="350px" height="300px" style="position:relative;top:50px;left:450px" data-src="assets/field_level_prelim.png" />
							<br>
							
							<div class="fragment  " data-fragment-index="1" style="font-size: 16px; position:relative;left:1050px"><b><u>Modi</u></b> et al. (in preparation)</div>
							<div class="fragment  " data-fragment-index="1" style="font-size: 16px; position:relative;left:1050px">Boruah and Rozo (2023)</div>
							<div class="fragment  " data-fragment-index="1" style="font-size: 16px; position:relative;left:1050px"> Leclercq and Heavens (2021)</div>
                                                </div>
                                                
                                        </section>
					

					<!-------------------------------------------------------------------------------->
					<!-------------------------------------------------------------------------------->

					
                                        <!-- <section> -->
                                                
                                        <!--         <h3 class='slide-title'> Why field-level inference #1 </h3> -->
					<!-- 	<div class="header-right"> -->
					<!-- 		Traditional Analysis<br> -->
					<!-- 		Simulation-based Inference <br> -->
					<!-- 		<font color="orange"> Field-level Inference<br> -->
					<!-- 		$\rightarrow$ Advantages </font>  -->
					<!-- 	</div> -->
                                                
                                        <!--         <br> -->
					<!-- 	<div class="boxonly" style="width:600px; padding:10px; font-size:22px"> -->
					<!-- 		It is the  <b class="alert"> optimal </b>  approach to cosmological analysis -->
					<!-- 	</div> -->
						
                                        <!--         <div class="slide-text", style="position:relative;"> -->
                                        <!--                 <br> -->
                                        <!--                 <ul> -->
                                        <!--                         <li class="fragment " data-fragment-index="1"> Statistical perspective: no information is lost by compressing data<br>into summary statistics. -->
                                        <!--                         </li> -->
                                        <!--                         <br> -->
                                        <!--                         <li class="fragment " data-fragment-index="2"> Cosmologist: undo non-linear evolution to recover the Gaussian initial conditions. <br> -->
                                        <!--                                 <ul class="fragment " data-fragment-index="2"> -->
					<!-- 				     $\rightarrow$ standard reconstruction for Baryon Acoustic Oscillations (BAO)<br>$\rightarrow$ BOSS & DESI -->
					<!-- 				</ul> -->
					<!-- 			</li> -->
                                        <!--                 </ul> -->
                                        <!--                 <br> -->
                                        <!--         </div> -->
					<!-- 	<br> -->
                                        <!--         <div class="container" style="margin:auto; width:950px;"> -->

					<!-- 		<div class="col" > -->
                                        <!--                         <img class="fragment plain"   data-fragment-index="1" width="320px" height="280px" style="position:relative;top:-120px;" data-src="assets/field_level_prelim.png" /> -->
								
					<!-- 			<div class="fragment  " data-fragment-index="1" style="position:absolute; float:right; ; right:600px; font-size: 16px; margin:0 auto"><b><u>Modi</u></b> et al. (in preparation)</div> -->

					<!-- 		</div> -->
					<!-- 		<div class="col" > -->
					<!-- 			<img class="fragment plain" data-fragment-index="2" width="320px" height="150px" style="position:relative; right:-120px; top:-200px" data-src="assets/bao_damping.png" /> -->
					<!-- 			<img class="fragment plain" data-fragment-index="2" width="320px" height="280px" style="position:relative; right:-120px; top:-215px" data-src="assets/realbaofisher.png" /> -->
					<!-- 			<div class="fragment  " data-fragment-index="2" style="position:absolute; width:200px; top:450px; right:460px; font-size:20px;  text-align:right"> -->
					<!-- 				<em> Fisher information ($\mathcal{I}$) in BAO for different fields as a function of scales<br> <br>$\bar{n}$: number density of tracers -->
										
					<!-- 				</em> -->
					<!-- 			</div>	 -->
					<!-- 			<div class="fragment  " data-fragment-index="2" style="position:absolute; float:right;  bottom:190px; right:0px; font-size: 16px; margin:0 auto; text-align:right"> -->
					<!-- 				<b><u>Modi</u></b>, Feng, Seljak (2018) <br> -->
					<!-- 				Eisenstein et al. (2007) -->
					<!-- 				<br> Seo et al. (2007) -->
					<!-- 				Wang et al. (2017) <br> -->
					<!-- 			</div> -->
					<!-- 		</div> -->
                                        <!--         </div> -->
                                                
                                        <!-- </section> -->
					

					<!-------------------------------------------------------------------------------->
					<!-------------------------------------------------------------------------------->

                                        <!-- <section> -->
                                                
                                        <!--         <h3 class='slide-title'> Why field-level inference #2 </h3> -->
					<!-- 	<div class="header-right"> -->
					<!-- 		Traditional Analysis<br> -->
					<!-- 		<font color="orange"> Field-level Inference<br> -->
					<!-- 		$\rightarrow$ Advantages </font> <br> -->
					<!-- 		Simulation-based Inference  -->
					<!-- 	</div> -->


                                        <!--         <br> -->
					<!-- 	<div class="boxonly" style="width:800px; padding:10px; font-size:22px"> -->
					<!-- 		Enables  <b class="alert"> joint analysis </b>  of different cosmological probes and surveys. -->
					<!-- 	</div> -->
                                        <!--         <br> -->


                                        <!--         <div class="continer"> -->
                                        <!--                 <div class="slide-text"> -->
                                                                
                                        <!--                         <div class="col" style="flex:0 0 30em" > -->
					<!-- 		                <div class="plain fragment", data-fragment-index="1"> -->
								                
                                        <!--                                         <div style="position:relative; "> <u>2 datasets</u>: &ensp; $x_1$,  $x_2$ </div> -->
                                        <!--                                         <br> -->
                                        <!--                                         <u>Bottleneck of the traditional analysis</u> -->
                                        <!--                                         <br> -->
                                        <!--                                         <br> -->
                                        <!--                                         <ul style="font-size:20px"> -->
                                        <!--                                                 independent theoretical models: -->
                                        <!--                                                 <span style="">  &ensp; $x_1\sim t_1(\theta)$; &ensp; $x_2\sim t_2(\theta)$ </span>  -->
					<!-- 						<br> -->
					<!-- 						$\rightarrow$  need to model covariance matrix -->
					<!-- 					</ul> -->
					<!-- 					<br> -->
					<!-- 					<br> -->
					<!-- 			                <div style="font-size:20px"> -->
					<!-- 				                $ \log p(x_1, x_2 | \theta) \propto  - [x_{1} - t_1(\theta),\, x_2 - t_2(\theta)] ^\dagger \,  C ^{-1} \,   [x_{1} - t_1(\theta),\, x_2 - t_2(\theta)] $ -->
					<!-- 			                </div> -->
					<!-- 				</div> -->
									
					<!-- 				<br> -->
                                        <!--                                 <br> -->
					<!-- 		                <div class="plain fragment", data-fragment-index="2"> -->
                                        <!--                                         <u>Forward modeling</u> -->
                                        <!--                                         <br> -->
                                        <!--                                         <br> -->
                                        <!--                                         <ul style="font-size:20px"> -->
                                        <!--                                                 Capture correlations in the joint forward model<br> -->
                                        <!--                                                         $\rightarrow$ $x_1, x_2 \sim f(\theta)$ -->
                                                                                        
                                        <!--                                         </ul> -->
                                        <!--                                         <br> -->
                                        <!--                                         <br> -->
					<!-- 			                <div class="center" style="position:relative; left:150px; font-size:20px"> -->
                                                                                        
					<!-- 				                $ p( x_1, x_2 | \theta) \propto p(x_{1} | f(\theta))  \times p(x_{2} | f(\theta)) $ -->
					<!-- 			                </div> -->
					<!-- 		                </div> -->
                                        <!--                         </div> -->
					<!-- 		        <br> -->
							        
					<!-- 		</div> -->
					<!-- 		<div class="col" style="flex:0 0 25em" > -->
					<!-- 	                <div class="plain fragment", data-fragment-index="3" style="position:absolute; top:200px; right:100px; width:400px; font-size:20px" > -->
					<!-- 		                Joint reconstruction from<br> -->
                                        <!--                                 halo position & velocity data -->
					<!-- 		                <\!-- <br> -\-> -->
					<!-- 		                <\!-- <img class="plain"  style="position:relative; width:800px" -\-> -->
					<!-- 		                <\!--      data-src="assets/bayer_eqn.png"/> -\-> -->
					<!-- 				<br> -->
					<!-- 				<img class="plain",  style="width:350px;" -->
					<!-- 				     data-src="assets/bayer_velrecon.png"/> -->
					<!-- 				<br> -->
					<!-- 				<em style="font-size:20px"> Cross correlation as function of scales between reconstructed & true initial density field </em> -->
					<!-- 	                </div> -->
							        
                                                                
                                        <!--                 </div> -->
					<!-- 	</div> -->

						
					<!-- 	<div class="fragment  " data-fragment-index="3" style="position:absolute; float:right;  top:580px; right:0px; font-size: 16px; margin:0 auto; text-align:right"> -->
					<!-- 		<img class="plain "   style="height:80px " -->
					<!-- 		     data-src="assets/abayer.jpeg"/><br>  -->
					<!-- 		Bayer, <b><u>Modi</u></b>, Ferraro (2022) -->
					<!-- 	</div> -->
						
                                                
                                        <!-- </section> -->
                                        <!-------------------------------------------------------------------------------->
                                        <!-------------------------------------------------------------------------------->
                                        <section>
                                                
                                                <h3 class='slide-title'> Why field-level inference #2 </h3>
						<div class="header-right">
							Traditional Analysis<br>
							Simulation-based Inference <br>
							<font color="orange"> Field-level Inference<br>
							$\rightarrow$ Advantages </font> 
						</div>
                                                

                                                <br>
						<div class="boxonly" style="width:800px; padding:10px; font-size:22px">
							Reconstruct  unobserved  fields to enable <b class="alert"> new analyses.</b>
						</div>
						<br>
						<div style="font-size:22px">
							<b class="alert"  >Unique</b> to field-level inference!
						</div>
                                                <div class="container" style="position:relative; top:-20px">
							<div class="col"  style="flex: 0 0 32em;">

                                                                <div class="slide-text", style="position:relative;">
                                                                        <div class="plain fragment" data-fragment-index="1">
                                                                               E.g. probe neutral hydrogen with 21-cm surveys like HIRAX, PUMA
                                                                        </div>

                                                                        <ul>
                                                                                <br>
                                                                                <li class="fragment " data-fragment-index="2"> Bright foregrounds <br>
                                                                                        <div style="font-size:20px" >
												<!-- $\quad \rightarrow$ large scale modes perpendicular to the line of sight are lost<br> -->
												$\quad \rightarrow$ can lose 60-80% of the data on large scales
											</div>
                                                                                </li>
                                                                                <br>
                                                                                <li class="fragment " data-fragment-index="3"> Match field-level data on small scales <br>
                                                                                        <div style="font-size:20px" >
												$\quad  \rightarrow$ recover initial conditions
											</div>
                                                                                </li>
                                                                                <br>
                                                                                <li class="fragment " data-fragment-index="4"> Evolve initial conditions to reconstruct lost modes
											<br>
											<div class="fragment " data-fragment-index="4" style="font-size:20px">
                                                                                                $\quad  \rightarrow$ <b class="alert"> new science!</b> 
                                                                                                <br>
												$\quad  \rightarrow$ correlate with photometric surveys & CMB lensing
												<br>
                                                                                                $\quad \rightarrow$ explore high redshift Universe
                                                                                        </div>
                                                                                        
                                                                                </li>
                                                                        </ul>
                                                                        <br>
                                                                        <br>
                                                                        <br>
                                                                </div>
								<br>
                                                                <div class="plain fragment" data-fragment-index="5" style="font-size:20px; position:relative; top:-50px; left:20px">
                                                                        Other e.g. initial density for primordial physics, dark matter for galaxy formation.
                                                                </div>
                                                                
							
							</div>
							<div class="col" style="flex: 0 0 21em;">

								<div class="fragment  plain" style="position:absolute; top:-30px; right:0px; width:200px; font-size:20px" data-fragment-index="1">
                                                                        <em> HIRAX </em>
                                                                        <br>
									<img class="plain" style="position:relative; top:-15px; " data-src="assets/hirax.jpg" />
								</div>
								

                                                                <div style="position:relative; width:500px; height:600px; margin:0 auto; right:10px; top:10px">
                                                                        <div class="fragment  plain" style="position:absolute; top:100px; left:0px; width:150px; font-size:20px" data-fragment-index="1">
										True<br>Distribution
										<img class="plain" data-src="assets/21cmcorrupt_x.png" />
									</div>
                                                                        <div class="fragment  plain"  style="position:absolute; top:100px; left:175px; width:150px; font-size:20px;" data-fragment-index="2">
										Noisy<br>Data
										<img class="  plain"  data-src="assets/21cmcorrupt_x2.png" />
									</div>
									
                                                                        <div class="fragment  plain"  style="position:absolute; top:100px; left:350px;  width:150px; font-size:20px" data-fragment-index="4  ">
										Reconstructed Data
										<img class="  plain"  data-src="assets/21cmcorrupt_x3.png"/>
									</div>
                                                                        <!-- <img class="fragment  plain"  data-src="assets/21cmwedge.png" style="position:absolute; top:250px; left:10px;" data-fragment-index="2" /> -->
                                                                         <!-- <img class="fragment  current-visible plain"  data-src="assets/21cmwedge.png" style="position:absolute; top:200px; left:10px;" data-fragment-index="2" /> -->
	                                                                <!-- <img class="plaint fragment" data-fragment-index="3" style="position:relative; width:370px; top:160px; text-align:center" -->
								        <!--      data-src="assets/photocross-snr.png" /> -->
                                                                        <div  class="fragment  plain"  data-fragment-index="1" style="position:absolute; float:right; right:0px; top:400px; font-size:18px; text-align:right">
										<b><u>Modi</u></b>, White et al. (2019) <br>
										<b><u>Modi</u></b>, Castorina et al. (2019) <br>
										<b><u>Modi</u></b>, White et al. (2021) <br>
									</div>
							        </div>
							</div>
                                                </div>

                                        </section>
                                        

				
				</section>

				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				<section>
					<div style="font-size:30px">Field-level inference enables <br>
						<br>
						optimal cosmological analysis, <br>
						and unique opportunities for new science cases.
						<br>
						<br>
						<div class="" data-fragment-index="1"> So what do we need to enable it?</div>
						<!-- <div class="fragment" style="font-size:24px"> -->
						<!-- 	<div class="boxonly alert" style="background-color:#44444; position:absolute; top:300px; left:200px; border-radius: 100px; width:220px"> <br>1. Differentiable<br>Simulations<br><br> </div> -->
						<!-- 	<div class="boxonly alert" style="position:absolute; top:300px; left:550px; border-radius: 100px; width:220px"> <br>2. High dimensional<br>inference<br><br> </div> -->
						<!-- 	<div class="boxonly alert" style="position:absolute; top:300px; left:900px; border-radius: 100px; width:220px; "> <br>3. Data<br>likelihood<br><br> </div> -->
						<!-- </div> -->
						<br>
						<div class="container fragment"  data-fragment-index="1" style="font-size:24px; width:800px; margin:auto">
							<div class="col">
								<div class="boxonly alert" style="background-color:#44444;  border-radius: 100px; width:220px"> <br>1.<br> Differentiable<br>Simulations<br><br> </div></div>
							<div class="col">
								<div class="boxonly alert" style="border-radius: 100px; width:220px"> <br>2. <br>High dimensional<br>inference<br><br> </div> </div>
							<!-- <div class="col"> -->
							<!-- 	<div class="boxonly alert" style="border-radius: 100px; width:220px; "> <br>3. Data<br>likelihood<br><br> </div> -->
							<!-- </div> -->
						</div>

					</div>
					<!-- <div style="font-size:40px">Roadmap to field-level inference-<br> -->
					<!-- 	advances, challeges & the way ahead -->
					<!-- 	<div class="fragment"> </div> -->
					<!-- </div> -->
				</section>

                                <!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				<section>
					<section>
						<h3 class='slide-title'> Advances for field-level inference #1 </h3>
						<div class="header-right">
							Traditional Analysis<br>
							Simulation-based Inference <br>
							<font color="orange"> Field-level Inference<br>
							$\rightarrow$ Requirements </font> 
						</div>
                                                

						<br>
						<div class="boxonly" style="width:600px; padding:10px; font-size:22px">
							<b class="alert"> Fast, differentiable </b> cosmological simulations.
						</div>
						<br>
						<br>
						<div class="slide-text">
							
							<div class="container">
                                                        	<div class="col" style="flex: 0 0 30em;" >
									<ul>
										<li class=" ragment " data-fragment-index="2"> Infer initial conditions at all points in the Universe <br>
											<div style="font-size:20px"> $\sim$ over a million unknown parameters </div>
											
										</li>
										<br>
										<li class="fragment " data-fragment-index="2"> 	Gradient based inference algorithms <br>
											<div style="font-size:20px">
												E.g. gradient descent, <br>
												Hamiltonian Monte Carlo (HMC) <br>
											</div>
										</li>
										<br>
                                                                                <li class="fragment " data-fragment-index="2"> 	 Response of likelihood with cosmological parameters $\Lambda$ & <br> the initial conditions $z$. </li>
                                                                                <br>
										<div class="fragment " data-fragment-index="2" style="position:relative; left:100px ">
											$g_z = \frac{\partial\, p(x| z, \Lambda)}{\partial\, z},\, g_{\Lambda} = \frac{\partial\, p(x | z, \Lambda)}{\partial\, \Lambda}$
											<br> 
											<br>
											<!-- $g_z \sim \frac{\partial\ f(z, \Lambda)}{\partial\, z},\, g_{\Lambda} \sim \frac{\partial\, f(z, \Lambda)}{\partial\, \Lambda}$ -->
										</div>
                                                                                <!-- <li class="fragment " data-fragment-index="3"> 	Hammer behind the machine learning revolution. </li> -->
                                                                                <br>
										<br>
									</ul>
								</div>
								<div class="col" style="flex: 0 0 21em; text-align:center">
									<div  class="plain fragment fade-in" data-fragment-index="3" style="position:absolute; top:200px; right:120px; width:400px; font-size:20px">
                                                                                <img data-src="assets/pmwd_table_closed.png" />
                                                                                <br>
                                                                                <em> Examples of differentiable codes upto 2017 </em>
                                                                        </div>

                                                                        <br>
									<div class="fragment " data-fragment-index="4" style="position:absolute; top:430px; right:20px; width:600px; font-size:20px">
										<b> Automatic differentiation:</b> the hammer behind deep learning <br>
										$\longrightarrow$  TensorFlow, JAX and more
										<br>
									<img class=" plain fragment " data-fragment-index="4" style="position:absolute; top:50px; right:300px; width:200px"
									     data-src="assets/TF_FullColor_Horizontal.png" />
									<img class=" plain fragment " data-fragment-index="4" style="position:absolute; top:50px; right:100px; width:100px; height:50px"
									     data-src="https://raw.githubusercontent.com/google/jax/master/images/jax_logo_250px.png"  />
 									
									</div>
									

								</div>
								<div  class="fragment"  data-fragment-index="3" style="position:absolute; top:600px; right:20px; font-size:16px; text-align:right">
									Jasche & Lavaux (2018) <br>
									Wang, Mo, Yang, Bosch (2014) <br>
									<!-- Seljak, Aslanyan, Feng, <b> <u>Modi</u></b> (2017) <br> -->
								</div>
							</div>
							
						</div>
					</section>

                                        <!-------------------------------------------------------------------------------->
					
					<!-------------------------------------------------------------------------------->
					
					<section>
						<h3 class='slide-title'> Differentiable cosmological simulations</h3>
						<div class="header-right">
							Traditional Analysis<br>
							Simulation-based Inference <br>
							<font color="orange"> Field-level Inference<br>
							$\rightarrow$ Requirements </font> 
						</div>

						<br>
						<div class='container'>
							<div class='col slide-text' style="flex: 0 0 28em; font-size:22px">
								<ul>
									<li>
										<b class="alert "> FlowPM</b>: the first particle-mesh simulations in TensorFlow <br>
										<ul class="plain" data-fragment-index="1" style="font-size:20px">
											<li> Automatic differentiation
											</li>
											<li> Access to SOTA inference algorithms
											</li>
											<li>  Seamless interfacing with deep-learning tools 
											</li>
										</ul>
									</li>
									<br>
									
									<li class="fragment" data-fragment-index="3"> 
										Reconstructing the Universe in 10 lines
									</li>

                                                                        <br>

									<li class="fragment" data-fragment-index="4"> Memory limited
										<ul class="fragment" data-fragment-index="4" style="font-size:20px ">
											<li> <b class="alert" style="font-size:22px"> $pmwd$</b><font color="white">: particle mesh with derivatives </font></li>
											<li > Exploit reversibility of leapfrog integration. </li>
											<li> Constant memory frootprint  </li>
										</ul>
									</li>

									<br>
                                                                        <li class="fragment" data-fragment-index="6" style="">	GPU accelerated simulations
                                                                                <br>
                                                                                <br>
                                                                                <div style="position:relative; top:20px; font-size: 18px; left:-220px; text-align:center;" >
											Timings for <br> 1 step of <br> 256$^3$ sim.
										</div>
                                                                                <div style=" position:relative; top:-80px; left:0px; font-size:20px">
                                                                                        <table   style=" font-size:20px; width:300px">
                                                                                                <tbody>
                                                                                                        <tr>
                                                                                                                <td>FastPM</td>
                                                                                                                <td>1 CPU</td>
                                                                                                                <td>40s</td>
                                                                                                        </tr>
                                                                                                        <!-- <tr> -->
                                                                                                        <!--         <td>FastPM</td> -->
                                                                                                        <!--         <td>32 CPU</td> -->
                                                                                                        <!--         <td>3s</td> -->
                                                                                                        <!-- </tr> -->
                                                                                                        <tr>
                                                                                                                <td>FlowPM</td>
                                                                                                                <td>1 GPU</td>
                                                                                                                <td>1s</td>
                                                                                                        </tr>
                                                                                                        <!-- <tr> -->
                                                                                                        <!--         <td>FlowPM</td> -->
                                                                                                        <!--         <td>32 GPU</td> -->
                                                                                                        <!--         <td>0.4s</td> -->
                                                                                                        <!-- </tr> -->
                                                                                                        <tr>
                                                                                                                <td>$pmwd$</td>
                                                                                                                <td>1 GPU</td>
                                                                                                                <td>0.01s</td>
                                                                                                        </tr>
                                                                                                </tbody>
                                                                                        </table>
                                                                                        <div style=" position:relative; top:-65px; left:450px;" >
                                                                                                <!-- $\Big\}$ 10x faster -->
                                                                                                $\rightarrow$ 10x faster
                                                                                                <br>
                                                                                                <div style="position:relative; top:11px" >
                                                                                                        $\rightarrow$ 100x faster </div>
                                                                                        </div>
                                                                                </div>
										<br>
										<em  class="plain fragment " data-fragment-index="7" style="position:relative;font-size:20px; top:-140px; left:20px" >$pmwd$ is faster than deep learning emulators   </em>

									</li>
								</ul>
								
								<br>
								
								<div class="container" style="position:relative; top:-450px">
									<div class="col fragment current-visible" data-fragment-index="3">
										<img class="plain" data-src="assets/reconim_init.gif" style='height:120px;' />
									</div>
									
									<div class="col fragment current-visible" data-fragment-index="3">
										<img class="plain" data-src="assets/reconim_fin.gif" style='height:120px;' />
									</div>
									
									<div class="col fragment current-visible " data-fragment-index="3">
										<img class="plain" data-src="assets/fin_field.png" style='height:120px;' />
									</div>
									<br>
								</div>
								
								
								
							</div>
							
							<div class='col' style="flex: 0 0 28em;">

								<div style="">
								
									<img  class="plain  fragment fade-out" data-fragment-index="3" style="position:absolute; top:150px; right:100px; width:450px"
									      data-src="assets/pmwd_table_flowpm.png" />
									<img  class="plain fragment current-visible" data-fragment-index="4" style="position:absolute; top:150px; right:100px; width:450px"
									      data-src="assets/pmwd_table_flowpm.png" />
									<img  class="plain fragment"  data-fragment-index="4" style="position:absolute; top:150px; right:100px; width:450px"
									      data-src="assets/pmwd_table.png" />
									
									<div class="fragment current-visible" data-fragment-index="3" style="position:absolute; top:130px; right:20px">
									  <pre  ><code data-trim data-noescape style="height:80em;width:49em;">
									  import tensorflow as tf
									  import flowpm

									  #Run simulation from variable initial conditions
									  linear = tf.get_variable('linear', shape=(nc, nc, nc),
												 initializer=tf.random_normal_initializer(), trainable=True)
									  initial_conditions = flowpm.lpt_init(linear, name='icstate')
									  final_state = flowpm.nbody(initial_conditions, stages, nc, name='fnstate')
									  final_field = flowpm.cic_paint(tf.zeros_like(linear), final_state[0], boxsize=bs)

									  #Likelihood term: ((data-model)/noise)^2
									  residual = tf.multiply(tf.subtract(final_field, data), 1/sigma)
									  neg_log_likelihood = tf.reduce_sum(tf.multiply(residual, residual))

									  #Prior: (linear_modes^2 / linear_power_spectrum)
									  lineark = flowpm.r2c3d(linear, norm=nc**3)
									  neg_log_prior = tf.square(tf.cast(tf.abs(lineark), tf.float32))
									  neg_log_prior = tf.reduce_sum(tf.multiply(neg_log_prior, 1/priorwt))j

									  #Loss & optimize
									  loss = tf.add(neg_log_likelihood, neg_log_prior, name='loss')
									  optimizer = ScipyOptimizerInterface(loss, var_list=[linear], 'L-BFGS-B')
									  with tf.Session() as session:
									      optimizer.minimize(session)
									      recon = session.run(linear)
									  </code></pre>
								</div>

 							
								<img  class="plain fragment " data-fragment-index="4"
								      style="position:absolute; top:350px; right:190px; width:300px" data-src="assets/pmwd_logo.svg" />
								
								<!-- <img  class="plain fragment current-visible" data-fragment-index="6" style="position:absolute; top:200px; right:30px; width:600px" -->
								<!--       data-src="assets/flowpm_lptcompare.png"/> -->
								<!-- <div  class="plain fragment " data-fragment-index="6" style="position:absolute; top:130px; right:100px; width:460px; font-size:16px" > -->
								<!--         <img data-src="assets/pmwd_timing.png" /> -->
                                                                <!--         <em style="position:relative; top:-10px"> time-scaling for $pmwd$ simulations<br> -->
                                                                <!--         <span class="plain fragment " data-fragment-index="7" > $\rightarrow pmwd$ is faster than deep learning emulators </span>   </em>  -->
                                                                <!-- </div> -->
								

								<div   style="position:absolute; top:580px; right:20px; font-size:16px; text-align:right">
									<span class="plain fragment fade-out " data-fragment-index="4" > 
										<b> <u>Modi</u></b>, Lanusse, Seljak (2020) <br>
									        Seljak, Aslanyan, Feng, <b> <u>Modi</u></b> (2017) <br>
										<a href="https://github.com/DifferentiableUniverseInitiative/flowpm">https://github.com/DifferentiableUniverseInitiative/flowpm</a> <br>
									</span>
									<img  class="plain fragment" data-fragment-index="4"
									      style="border:none; width:130px; height:110px; position:absolute; top:-50px; left:0px "
									      data-src="../assets/epod.jpg" />
									
									<span  class="plain fragment" data-fragment-index="4" style="position:relative; top:-100px; font-size:16px">
										<b> <u>Modi</u></b>, Lanusse, Seljak (2020) <br>
									        Seljak, Aslanyan, Feng, <b> <u>Modi</u></b> (2017) <br>
										Li, <b><u>Modi</u></b> et al. (2022) <br>
										Kwan, <b><u>Modi</b></u>, et al. (2022) <br>
										Li, Lu, <b><u>Modi</u></b> et al. (2022) <br>
									        <a href="https://github.com/eelregit/pmwd">https://github.com/eelregit/pmwd</a> <br>
										<a href="https://github.com/DifferentiableUniverseInitiative/flowpm">https://github.com/DifferentiableUniverseInitiative/flowpm</a> <br>
									</span>
									
								</div>
								
								</div>
							</div>
							
							
						</div>
					</section>
					
					<!-------------------------------------------------------------------------------->

					<section>
						<h3 class='slide-title'> Roadmap for differentiable cosmological simulations</h3>
						<div class="header-right">
							Traditional Analysis<br>
							<font color="orange"> Field-level Inference<br>
								$\rightarrow$ Advances </font> <br>
							Simulation-based Inference
						</div>

						<br>
						<br>

						<!-- Extensions for the next generation of cosmological surveys. -->
						<!-- <br> -->
						<!-- <br> -->
						<div class="slide-text ragment" data-fragment-index="1">
							<ol   style="font-size:20px">
								<br>
								<li> Scaling-up to high performance computing <br>
									<ul> Model parallelism frameworks to run on many GPU nodes </ul>
								</li>
								<br>
								<!-- <li> Beyond particle mesh simulations <br> -->
								<!-- 	<ul> E.g. include baryonic physics, sub-grid physics </ul> -->
								<!-- </li> -->
								<!-- <br> -->
								<!-- <li > Beyond galaxy clustering with other observables -->
								<!-- 	<br> -->
								<!-- 	<ul>  E.g., weak lensing, Lyman-$\alpha$  </ul> -->
								<!-- </li> -->
								<!-- <br> -->
								<li> Beyond $\Lambda$-CDM cosmology
									<br>
									<ul>  E.g., massive neutrinos,
									dark matter & dark energy models  </ul>
								</li>
								<br>
							</ol>
							<br>
							<br>
							<br>
							<br>
							<br>
						</div>
						
						 <div class="plain"  style="position:relative; top:-120px; float:right; font-size:18px; text-align:right; margin-right:20px">
							<b><u>Modi</b></u>, Lanusse, Seljak (2020) <br>
							Li, <b><u>Modi</b></u>, et al. (2022) <br>
							Pandey, <b><u>Modi</b></u> et al. (2023) <br>
							Lanzieri, Lanusse, <b><u>Modi</b></u> et al. (2023) <br>
							Lanzieri, Lanusse, et al. (2021) <br>
							Dai and Seljak (2020) <br>
							<!-- Boehm, Feng, et al. (2020) <br> -->
                                                        <!-- Porqueres, Jasche, et al. (2019) -->
                                                        
						</div>

						
					</section>
						
						
				</section>
				
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->

				<!-------------------------------------------------------------------------------->
                                <!-------------------------------------------------------------------------------->

				
				<section>
						<h3 class='slide-title'> Advances for field-level inference #2 </h3>
						<div class="header-right">
							Traditional Analysis<br>
							Simulation-based Inference <br>
							<font color="orange"> Field-level Inference<br>
							$\rightarrow$ Requirements </font> 
						</div>
						
						<br>
						<div class="boxonly" style="width:700px; height:30px; padding:5px; font-size:22px">
							<div class= "fragment fade-out " data-fragment-index="4" >  Inference algorithms in high dimensions. </div>
							<div class= "fragment" data-fragment-index="4" style="position:relative; top:-28px"> <b class="alert"> Accelerated </b> inference algorithms  in high dimensions. </div>
						</div>
						<br>

						
						<div class="container" style="margin-left:20px; font-size:22px">
							<div class="col">
								<div class="box fragment" data-fragment-index="2" style="position:absolute;  width:580px">
									<div class="box-title", style="height:30px; font-size:20px">
										1. Hamiltonian Monte Carlo (HMC)
									</div>
									<div class="box-content" style="font-size:20px">
										Use gradients to obtain samples from the posterior.
										<br>
										<br>
										<!-- <div style="font-size:25px" > -->
										<!-- 	$  \frac{dz}{dt} = \frac{\partial H(z, \tilde{p})}{\partial  \tilde{p}},\, \frac{d\tilde{p} }{dt} = -\frac{\partial H(z, \tilde{p})}{\partial z}$ -->
										<!-- </div> -->
										<!-- <br> -->
										<div class="slide-text" style="font-size:20px">
											<b> Good</b>: Asymptotically explores the entire posterior
											<br>
											<b>Bad</b>: Consecutive samples are correlated
											<br>
											<div class="plain fragment" data-fragment-index="3" >
												<b>Ugly </b>: <b class="alert"> $\sim 10^4$ simulations </b> for every independent sample!!
											</div>

										</div>
									</div>
								</div>
						        </div>
							
							<div class="col">
								<div class="box fragment" data-fragment-index="5" style="position:absolute;  width:600px">
									<div class="box-title", style="height:30px; font-size:20px">
										2. Variational self-Boosted Sampling (VBS)
									</div>
									<div class="box-content" style="font-size:20px">
										Machine learning enhanced HMC sampling.
										<br>
										<br>
										<div class="slide-text" style="font-size:20px">
											1. Learn an approximate distribution on the fly. <br>
											<ul> $\rightarrow$ symmetry based normalizing flow (NF). </ul> <br>
											2. Use NF to generate independent proposals in MCMC chain. 
										</div>
									</div>
								</div>
							</div>
						</div>

						<div class="box fragment" data-fragment-index="6" style="position:absolute;  top: 423px; width:500px; left:20px">
							<div class="box-title", style="height:30px; font-size:20px">
								3. What next?
							</div>
							<div class="box-content" style="font-size:20px">
								Jointly sample cosmology parameters & density field
								<br>
								<div class="slide-text" style="font-size:20px">
									$\rightarrow$ hierarchical model<br>
									$\rightarrow$ multi-scale posterior geometry
									<br>
									<br>
									<span style="text-align:right; position:relative; left:200px"> <b><u>Modi</u></b>, Barnett, Carpenter (2021) </span>
									<br>
								</div>
							</div>
						</div>

						<span class="plain fragment fade-in" data-fragment-index="2" >
							<span class="plain fragment fade-out" data-fragment-index="6" >
								<div class="plain fragment" style="position:absolute; top:385px; left:20px; font-size:20px; text-align:center" data-fragment-index="2" >
									True Initial conditons <br>
									<img class="plain fragment" style="" data-fragment-index="2" src="../assets/ic_gif.png"   width="230" />
								</div>
								
								<div class="plain fragment" style="position:absolute; top:385px; left:320px; font-size:20px; text-align:center" data-fragment-index="2" >
									HMC Samples <br>
									<img  class="plain fragment" style="" data-fragment-index="2" src="../assets/ic.gif"   width="230" /> <!--  -->
								</div>
							</span>
						</span>
						
						<span class="plain fragment fade-in" data-fragment-index="3" >
							<span class="plain fragment fade-out" data-fragment-index="5" >
								<div  class=" plain" style="position:absolute; top:410px; left:550px; font-size:20px" >
									<img  class="plain" style="height:210px"  data-src="assets/hmc_ac.png" />
									<br>
									<em style="position:relative; top:-15px; font-size:20px" > Auto-correlation length of HMC samples as function of scales for 4 chains. </em>
								</div>
							</span>
						</span>
						<div class="plain fragment fade-in" data-fragment-index="5" style="position:absolute; top:410px; left:550px; font-size:20px" >
							<img style="", data-src="assets/vsbs_ac_200_64.png" />
							<br>
							<em style="position:relative; top:-15px; font-size:20px"> VBS reduces auto-correlation length as compared to HMC by more than <b class="alert"> 10x </b> </em>
						</div>
						
						<span  class="plain fragment" data-fragment-index="5" style="position:absolute; top:380px; right:20px; font-size:16px; text-align:right">
							<b><u>Modi</u></b>, Li, Blei (2022) <br>
							<span class="plain fragment" data-fragment-index="5" > Dai and Seljak (2022)</span>
							
						</span>
				</section>
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
					
				<!-- <section > -->
				<!-- 	<h3 class='slide-title'>Story of field-level inference</h3> -->
					

				<!-- 	<br> -->
				<!-- 	<div class="slide-text" style="font-size:22px"> -->
				<!-- 			<ul> -->
				<!-- 				<li> Model the field-level data directly without compression.<br> -->
				<!-- 					<ul> $\rightarrow$  infer the initial conditions of the Universe with the cosmological parameters. -->
				<!-- 					</ul> -->
				<!-- 				<br> -->
				<!-- 				<li> It enables <br> -->
				<!-- 					<ul>  -->
				<!-- 						<li> optimal analysis -->
				<!-- 							<\!-- <div style="float:right; right:50px; text-align:right; font-size:20px">  Modi, Feng et al. (2018) </div> -\-> -->
				<!-- 							</li> -->
				<!-- 						<li> new analysis with reconstructed fields -->
				<!-- 							<\!-- <div style="float:right; font-size:20px">   Modi, White et al. (2019a,b; 2021) </div> -\-> -->
				<!-- 						</li> -->
				<!-- 						<li> joint analyses -->
				<!-- 							<\!-- <div style="float:right; font-size:20px; text-align:right">    Bayer, Modi et al. (2022) </div> -\-> -->
				<!-- 						</li> -->
				<!-- 					</ul> -->
				<!-- 				<br> -->
				<!-- 				<li> Advances made <br> -->
				<!-- 					<ul> -->
				<!-- 						<li> open source fast, differentiable simulations: FlowPM & $pmwd$ -->
				<!-- 							<\!-- $\quad \quad \quad$ <div style="float:right; font-size:20px">  Modi, Lanusse et al. (2020); Li, Modi et al. (2022) </div> -\-> -->
				<!-- 						</li> -->
				<!-- 						<li> accelerated inference algorithms -->
				<!-- 							<\!-- <div style="float:right; font-size:20px">   Modi, Lanusse et al. (2021); Modi, Li et al. (2022) </div> -\-> -->
				<!-- 						</li> -->
				<!-- 					</ul> -->
				<!-- 				</li> -->
				<!-- 				<br> -->
				<!-- 				<li> Road ahead <br> -->
				<!-- 					<ul> -->
				<!-- 						<li> -->
                                <!--                                                         <\!-- <b class="alert">Short term:</b> -\-> -->
				<!-- 							*Extend current algorithms to parameter estimation  -->
				<!-- 							$\rightarrow$ application to survey data! -->
				<!-- 						</li> -->
				<!-- 						<li> -->
                                <!--                                                         <\!-- <b class="alert">Long term:</b> -\-> -->
				<!-- 							Enhancing differentiable simulations. -->
				<!-- 						</li> -->
				<!-- 						<li> -->
				<!-- 							<em> Learning the field-level data likelihood </em> -->
				<!-- 						</li> -->
				<!-- 					</ul> -->
				<!-- 					</ul> -->
				<!-- 				</li> -->
                                <!--                         </ul> -->
				<!-- 		</div> -->
					
				<!-- </section> -->

				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->

				<section >
					<h3 class='slide-title'>Story of field-level inference</h3>
					

					<br>

					<div class="slide-text" style="font-size:22px">
						
						<div class="block-title" , style="text-align:left; font-size:22px">
							Motivation
						</div>
						<div class="block-content", style="text-align:left; font-size:20px">
							<ul>
								<li> Model the field-level data directly without compression.<br>
									<ul >
										<li>  infer the initial conditions of the Universe. </li>
									</ul>
								</li>
								<br>
								<li> It enables <br>
									<ul >
										<li> optimal cosmological analysis
										</li>
										<li> new science cases with reconstructed fields
										</li>
									</ul>
									<br>
							</ul>
						</div>

                                                <div class="block-title" , style="text-align:left; font-size:22px">
							Current status
						</div>
						<div class="block-content", style="text-align:left; font-size:20px">
							<ul style=''>
								<li> Open source, GPU-accelerated, differentiable simulations: FlowPM & $pmwd$.
									<!-- $\quad \quad \quad$ <div style="float:right; font-size:20px">  Modi, Lanusse et al. (2020); Li, Modi et al. (2022) </div> -->
								</li>
								<li> ML accelerated algorithms for inferring initial conditions.
									<!-- <div style="float:right; font-size:20px">   Modi, Lanusse et al. (2021); Modi, Li et al. (2022) </div> -->
								</li>
							</ul>
						</div>

                                                
                                                <br>
						<div class="block-title" , style="text-align:left; font-size:22px">
							Road ahead
						</div>
						<div class="block-content", style="text-align:left; font-size:20px">
							
							<ul>
								<li>
                                                                        <!-- <b class="alert">Short term:</b> -->
									ML accelerated algorithms for parameter estimation
									$\rightarrow$ application to survey data!
								</li>
								<li>
                                                                        <!-- <b class="alert">Long term:</b> -->
									Enhancing differentiable simulations
								</li>
								<li>
									<em> Learning the field-level data likelihood </em>
								</li>
							</ul>
						</div>
                                                
					</div>
 					<br>


 					<br>
					
				</section>



				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->

                                <!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
                                <section class="" data-background="">
					<div style="font-size:80px">Summary</div>
				</section>


                                
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->



				<section >
					<section >
						<h3 class='slide-title'>Cosmology in the next decade</h3>

						<br>
						<span style="font-size:22px" >
							Surveys like DESI, LSST, Euclid, SPHEREX, CHIME, HIRAX, S0, CMB-S4 & more
						</span>
						<br>
						<br>
						<div class="container" >
							
							<div class="col slide-text" style="flex:0 0 25em">

								
								<br>
								<div class="block  " data-fragment-index="1" style="width:600px" >
									<div class="block-title" style="text-align:center">
										Promise of the next generation of surveys
									</div>
									<div class="block-content" style="font-size:20px">

										<ul>
											<li class="plain" data-fragment-index="1" > Answer fundamental questions 
											</li>
											<li class="plain" data-fragment-index="4" > Discovering new physics
											</li>
 											<li class="plain" data-fragment-index="2" > Study current tensions in $\Lambda$-CDM model
											</li>
										</ul>
									</div>
								</div>
								<br>
								<br>
								<br>
								<br>
								<div class="block fragment " style="width:600px" >
									<div class="block-title" style="text-align:center">
										Limited only by our ability to analyze it

									</div>
									<div class="block-content" style="font-size:20px">
										
										<ul>
											<li class="plain" data-fragment-index="1" > choice of summary statistics
											</li>
 											<li class="plain" data-fragment-index="2" > requires theoretical models
											</li>
											<li class="plain" data-fragment-index="4" > requires analytic likelihood
											</li>
											<li class="plain" data-fragment-index="4" > challenging to do joint analysis
											</li>

										</ul>
										
									</div>
								</div>
							</div>

							<div class="col" style="flex:0 0 25em">

								
								<div class="plain " data-fragment-index="1"   style="position:absolute; top:150px; right:290px; width:300px; font-size:20px" >
									<img data-src="assets/desi_hz1.png" />
									<br>
								</div>

								<div  class="plain " data-fragment-index="1"  style="position:absolute; top:250px; right:0px; width:300px; font-size:20px">
									<img class="plain" data-src="assets/hubble_tension2.png" />
								</div>
								
								<div class="plain " data-fragment-index="1"  style="position:absolute; top:380px; right:330px; width:300px; font-size:20px" >
									<img data-src="assets/lsst_y10_forecast2.png" />	
								</div>


								<!-- <div style="position:absolute; right:20px; top:620px; text-align:right; font-size: 18px"> -->
								<!-- 	<div class="plain  " data-fragment-index="0" style=""> DESI whitepaper (Aghamousa et al. (2016))</div> -->
								<!-- 	<div class="plain fragment " data-fragment-index="2" style=""> Verde, Treu, Riess (2019)</div> -->
								<!-- 	<\!-- <div class="plain fragment " data-fragment-index="3" style=""> Hilderbrant et al. (KIDS collaboration) (2016)</div> -\-> -->
								<!-- 	<div class="plain fragment " data-fragment-index="4" style=""> LSST Collaboration (2018)</div> -->
								<!-- </div> -->
							</div>


						<br>
						<br>

					</section>
					
					<!-------------------------------------------------------------------------------->

					<section >
						<h3 class='slide-title'>Forward modeling approaches to cosmological analysis</h3>

						<span style="font-size:22px" >
							Using computational forward models to overcome limitations of traditional analysis.
						</span> 
						<br>
						<br>

						<div class="block fragment " data-fragment-index="1" style="width:1250px" >
							<div class="block-title" style="text-align:center; font-size:22px" >
								1. Simulation-based Inference
							</div>
							<div class="block-content" style="font-size:20px">
								<div class="plain" style="text-align:center" >  Using new summary statistics without explicit likelihood to extract more information. </div>
								<br>
								<div class="container fragment " data-fragment-index="1" style="width:1200px; margin:auto">
									<div class="col">
										<ul>
										        <li> Hybrid-SBI to overcome computational bottleneck.</li>
                                                                                        <li> Better galaxy models and algorithms for robustness to model-misspecification.</li>
                                                                                </ul>
									</div>
								</div>

							</div>
						</div>
						<br>
						<div class="block fragment " data-fragment-index="2" style="width:1250px" >
							<div class="block-title" style="text-align:center; font-size:22px">
								2. Field-level Inference
							</div>
							<div class="block-content" style="font-size:20px">
								<div class="plain" style="text-align:center" > Model the data without any compression for optimal analyses, and new science cases. </div>
								<br>

								<div class="container fragment " data-fragment-index="1" style="width:1200px; margin:auto">
									<ul>
									        <li> Infer the initial conditions of the Universe.
									        </li>
									        <li> Differentiable simulations and ML enhanced inference algorithms.
									        </li>
									        <!-- <li> Learn data likelihood at the field level. </li> -->
                                                                        </ul> 
								</div>

							</div>
						</div>
						<br>


						<div class="plain fragment current-visible"   data-fragment-index="1" style="position:absolute;top: 350px; left:200px; width:320px;">
							<img data-src="assets/hysbi_corner_eighth.png" /><br>
							<em style='font-size:16px; position:relative; top:-20px'> Hybrid-SBI trained on 1/8$^{th}$ the simulation volume outperforms standard analyses </em>
						</div>
						<div class="plain fragment current-visible" data-fragment-index="1" style="position:absolute;top: 370px; right:100px; width:350px; " >
							<img class="plain" data-src="assets/merger_trees.png" width="400px" /><br>
							<em style="font-size:16px; position:relative; top:-20px"> Ensemble of ML generated & simulated<br>halo-merger trees </em>
						</div>
						

						<img class="plain fragment current-visible"   data-fragment-index="2" style="position:absolute;top: 505px; left:200px; width:200px; " data-src="assets/field_level_prelim.png" />

						<div class="plain fragment current-visible"   data-fragment-index="2"  style="position:absolute; top: 515px; right:150px; width:500px; height:600px; margin:0 auto;">
							
                                                        <div class="  plain" style="position:absolute;  left:0px; width:130px; font-size:16px" >
								True<br>Distribution
								<img class="plain" data-src="assets/21cmcorrupt_x.png" />
							</div>
                                                        <div class="  plain"  style="position:absolute; left:175px; width:130px; font-size:16px;" >
								Noisy<br>Data
								<img class="  plain"  data-src="assets/21cmcorrupt_x2.png" />
							</div>
							
                                                        <div class="  plain"  style="position:absolute;  left:350px;  width:130px; font-size:16px" >
								Reconstructed Data
								<img class="  plain"  data-src="assets/21cmcorrupt_x3.png"/>
							</div>
						</div>
						<br>
						<div class="fragment" style="position:relative; top:-15px; font-size:22px">
                                                        <!-- To fulfill the promise of the next generation of cosmological surveys in solving the mysteries of the Universe.  -->
							<!-- Bigger punchline at the end. We are spending billions of dollars getting incredible observations and I am developing the absolutely essential key tools that will UNLOCK these observations and allow us to make the most of them in order to actually LEARN the physics of our universe and show some gorgeous eye candy images -->
							<b>
								Essential tools to make the most of the upcoming cosmological surveys<br>in learning the fundamental physics of our universe.
							</b>
                                                        <br>
							<br>
                                                        <b class="alert" > Thank you! </b>
                                                </div>

					</section>
				</section>
                                
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->

				
				</div>
			</div>
			

		<style>
		.reveal .slides {
		    border: 1px solid red;
		    min-height: 100%;
		    width: 128mm;
		    height: 96mm;
                }
		
		.reveal .box {
			background-color: #191919;
			margin-left: 10px;
			margin-right: 10px;
			text-align: center;
		}
		.reveal .box-title {
			background-color: #333333;
			padding:1px 1px 1px 1px;
  		color: #FFAA7F;
  		font-weight: bold;
		}

		
		.reveal .block {
			background-color: #191919;
			margin-left: 20px;
			margin-right: 20px;
			text-align: left;
			padding-bottom: 0.1em;
		}
		.reveal .block-title {
			background-color: #333333;
			padding:8px 35px 8px 14px;
  		color: #FFAA7F;
  		font-weight: bold;
		}
		.reveal .block-content {
			padding:8px 35px 8px 14px;
		}
                
		.reveal .slide-title {
			border-left: 5px solid white;
			text-align: left;
			margin-left: 20px;
			padding-left: 20px;
			
                <!-- position: absolute; -->
                 <!-- top: 100px; -->
                <!-- left: 0; -->
                }
		
		.reveal .slide-title-black {
			border-left: 5px solid black;
			text-align: left;
			margin-left: 20px;
			padding-left: 20px;
		}
                
		.reveal .alert {
  		color: #FFAA7F;
  		font-weight: bold;
		}
                
		.reveal .slide-text {
		 text-align: left;
		 margin-left: 20px;
		 font-size: 20px;
		}
                
		.reveal .boxonly {
			background-color:  #333333;
			margin: auto;
			text-align: center;
			border-radius: 5px;

		}
                
		.reveal .inverted {
			filter: invert(100%);
		}

		.reveal div.header-left {
                position: absolute;
                top: 0;
                left: 0;
                padding: 0;
                margin: 20px;
		font-size: 14px;
		
            }
		.reveal div.header-right {
                position: absolute;
                top: 0;
                right: 0;
                padding: 0;
                margin: 20px;
		font-size: 14px;
		text-align:right
		
            }
		</style>


		<script src="reveal.js/js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				controls: true,

				//center: false,
				hash: true,
				// Visibility rule for backwards navigation arrows; "faded", "hidden"
				// or "visible"
				controlsBackArrows: 'hidden',
				// Display a presentation progress bar
				progress: true,
				// Display the page number of the current slide
				slideNumber: true,
				transition: 'slide', // none/fade/slide/convex/concave/zoom
				// The "normal" size of the presentation, aspect ratio will be preserved
				// when the presentation is scaled to fit different resolutions. Can be
				// specified using percentage units.
				width: 1280,
				height: 720,
				// Factor of the display size that should remain empty around the content
				margin: 0.1,
				// Bounds for smallest/largest possible scale to apply to content
				minScale: 0.2,
				maxScale: 1.5,

				dependencies: [
					{ src: 'reveal.js/plugin/markdown/marked.js' },
					{ src: 'reveal.js/plugin/markdown/markdown.js' },
					{ src: 'reveal.js/plugin/notes/notes.js', async: true },
					{ src: 'reveal.js/plugin/highlight/highlight.js', async: true },
					{ src: 'reveal.js/plugin/math/math.js', async: true },
					{ src: 'reveal.js/plugin/reveal.js-d3/reveald3.js' },
					{ src: 'reveal.js/plugin/reveal.js-plugins/chart/Chart.min.js' },
					{ src: 'reveal.js/plugin/reveal.js-plugins/chart/csv2chart.js' },
				]
			});
		</script>
	</body>
</html>


