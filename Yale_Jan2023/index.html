1<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Forward Modeling approaches for Cosmological Analysis</title>

		<meta name="description" content="Yale Presentation">
		<meta name="author" content="Chirag Modi">

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<link rel="stylesheet" href="reveal.js/css/reset.css">
		<link rel="stylesheet" href="reveal.js/css/reveal.css">
		<link rel="stylesheet" href="reveal.js/css/theme/darkenergy.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="reveal.js/lib/css/monokai.css">
		
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'reveal.js/css/print/pdf.css' : 'reveal.js/css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">

				<!-- <section  data-background-image="assets/lsst_stills_0009_crop.jpg" > -->
				<!-- <section  data-background-image="assets/backgroundweb1.jpg" data-background-size="2500px" data-background-color="black" data-background-position='right'> -->
				<section  data-background-image="assets/backgroundtrail2.jpg" data-background-size="cover" data-background-color="black" >

						<div class="container">
							<div class="title" style="border-radius: 20px; background-color:rgba(0, 0, 0, 0.4);">
								<h2> Forward Modeling approaches for Cosmological Analysis </h2>
								<h4> Yale Seminar, January 26th, 2023</h4>
							</div>
						</div>

						<hr>
						<div style="border-radius: 20px; background-color:rgba(0, 0, 0, 0);">
							<div class="container" >
								<div class="col">
									<div align="left" style="margin-left: 20px;">
										<br>
										<h3>Chirag Modi</h3>
										<p>Center for Computational Astrophysics<br>Center for Computational Mathematics<br>Flatiron Institute</p>
										
										<br>
										
									</div>
								</div>
								<div class="col">
									<img src="assets/logo_bccp.png" class="plain" height="100"></img>
									<br>
									<br>
									<!-- <img src="assets/bids-logo2.png" class="plain" height="150"></img>
									     <img src="assets/desc-logo-inv.png" class="plain" height="200"></img> -->
								</div>
							</div>
						</div>
				</section>
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				
				<!-- <section data-background-image="assets/WMAP_timeline.jpg" data-background-size="1100px" data-background-color="black"> -->
				<!-- 	<\!-- <h2 class='slide-title' style="position:absolute;top:0;"> the $\Lambda$CDM view of the Universe </h3> -\-> -->
				<!-- 	<h2 class='slide-title' style="position:relative;top:0;"> the $\Lambda$CDM view of the Universe </h2> -->
				<!-- 	<\!-- <img class="plain" data-src="assets/WMAP_timeline.jpg" /> -\-> -->
				<!-- 	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br> -->
				<!-- 	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br> -->
				<!-- 	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br> -->
				<!-- 	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br> -->

				
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				<section data-background-color="black">

					<h2 class='slide-title' style="position:absolute;top:0;"> the $\Lambda$CDM view of the Universe </h2>

					<div class="container">
						<div class="col" style="flex: 0 0 35em;">
							<img class="plain" src="assets/WMAP_timeline.jpg" height="700px"/>
						</div>
						<div class="col" style="flex: 0 0 15em;">

							<div class="fragment" data-fragment-index="1" style="text-align:left"> 6 fundamental parameters: </div>
							<br>

							<ol class="fragment" data-fragment-index="1">
								<li>physical baryon density parameter</li>
								<li>physical dark matter density parameter</li>
								<li>the age of the universe</li>
								<li>scalar spectral index</li>
								<li>curvature fluctuation amplitude</li>
								<li>reionization optical depth</li>
							</ol>

						</div>
					</div>
				</section>

				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
                                
				<section>

                                        <section data-background-image="assets/cmb.png" data-background-size="1400px" data-background-color="black">
						<h3 class='slide-title'> next generation of cosmological probes</h3>

						TODO : Insert a figure with timelines of different surveys
						
						<div class="container">
							<div class="col">
								<div class="fragment fade-up" data-fragment-index='0'>
									Galaxy Clustering  -  DESI, LSST, Euclid...
									<br>
									<img src="assets/sdss_pie2.jpg" class="plain" height="250"></img>
									<br>
								</div>
								<div class="fragment fade-up" data-fragment-index='0'>
									Gravitational Lensing - DES, HSC, LSST...
									<br>
									<img src="assets/lensing.jpg" class="plain" height="250"></img>
									<br>
								</div>
							</div>
							
							<div class="col">
								<div class="fragment fade-up" data-fragment-index='0'>
									Supernovae - DES, LSST, WFRIST...
									<br>
									<img src="assets/supernova2.jpg" class="plain" height="250"></img>
								</div>
								
								<div class="fragment fade-up" data-fragment-index='0'>
									21-cm Intensity Mapping - CHIME, HIRAX, PUMA...
									<br>
									<img src="assets/21cm.png" class="plain" height="250"></img>
									<br>
								</div>
								
							</div>
						</div>
					</section>
					<!-------------------------------------------------------------------------------->
					<section data-background-image="assets/Mayall.jpg">
						<h2 class='slide-title'> the Dark Energy Spectroscopic Instrument</h2>						
						<div class="container">
							<div class="col">
								<ul>
									<li class="fragment fade-up" data-fragment-index="0"> 14,000 square degrees over 5 years</li>
									<br>
									<li class="fragment fade-up" data-fragment-index="1"> 35 million galaxies and quasars in 0 &lt; z &lt; 3.5</li>
									<br>
									<li class="fragment fade-up" data-fragment-index="2"> Measuring growth of structures and Baryon Acoustic Oscillations</li>
								</ul>
								<br >
							</div>
							<div class="col">
								<div style="position:relative; width:480px; height:420px; margin:0 auto;">
								<!-- <img src="assets/desi_bao.png" class="fragment fade-up" height="400"></img> -->
								<img class="fragment current-visible plain"  data-src="assets/desi_first_sky.png" style="position:absolute;top:20px;left:20px;" data-fragment-index="0" />
								<img class="fragment current-visible plain"  data-src="assets/desi_first_sky.png" style="position:absolute;top:20px;left:20px;" data-fragment-index="1" />
								<img src="assets/desi_bao.png" class="fragment fade-up" data-fragment-index="2" height="400"></img>
								</div>
								<div class="fragment"  data-fragment-index="2" style="position:relative; float:right; font-size: 20px; top:0px; left:0px">DESI Collaboration: 1611.00036</div>
							</div>
					</section>
					<!-------------------------------------------------------------------------------->

					<section data-background-image="assets/LSST.jpg" >
						<font color='black'>
						<h2 class='slide-title-black'> <font color='black'> the Large Synoptic Survey Telescope </font> </h2>
						<div class="container">
							<div class="col">
								<ul>
									<li class="fragment fade-up"> 1000 images each night, 15 TB/night for 10 years</li>
									<br>
									<li class="fragment fade-up"> 18,000 square degrees, observed once every few days</li>
									<br>
									<li class="fragment fade-up"> Tens of billions of objects, each one observed $\sim1000$ times</li>
									<br>
									<li class="fragment fade-up"> Galaxy Clustering, Weak lensing, Supernovae and much more</li>
								</ul>
								<br >
							</div>
							<div class="col">
								<div class="fragment fade-up">
									<!-- <font color="white">LSST forecast on dark energy parameters </font> -->
									<img class="plain" data-src="assets/lsst_y10_forecast2.png" style="height :400px"/>
								</div>
							</div>
						</div>
						</font>
					</section>
					
				</section>
				
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				<!-- <section> -->
				<!-- 	<section> -->
				<!-- 		<h3 class='slide-title'> promise of the modern cosmological surveys </h3> -->
				<!-- 		<div class="container"> -->
				<!-- 			<div class="col" style="flex: 0 0 30em;"> -->

				<!-- 				<div class="block fragment" data-fragment-index="0"> -->
				<!-- 					<div class="block-title"> -->
				<!-- 						A Blessing -->
				<!-- 					</div> -->
				<!-- 					<div class="block-content"> -->
				<!-- 						<ul> -->
				<!-- 							<li>Unprecedented statistical power -->
				<!-- 							</li> -->
				<!-- 							<br> -->
				<!-- 							<li>Great potential for new discoveries -->
				<!-- 							</li> -->
				<!-- 						</ul> -->
				<!-- 					</div> -->
				<!-- 				</div> -->

				<!-- 				<br> -->
				<!-- 				<div class="block fragment" data-fragment-index="1"> -->
				<!-- 					<div class="block-title"> -->
				<!-- 						The challenge -->
				<!-- 					</div> -->
				<!-- 					<div class="block-content"> -->
				<!-- 						<ul> -->
				<!-- 							<li class="fragment" data-fragment-index="1">How to combine different cosmological probes </li> -->
				<!-- 							<br> -->
				<!-- 							<li class="fragment" data-fragment-index="2">What are the optimal summary statistics? <br> -->
				<!-- 								$\rightarrow$ <b>2 point function</b>, 3 point function, peak counts ... -->
				<!-- 							</li> -->
				<!-- 							<br> -->
				<!-- 							<li class="fragment" data-fragment-index="3"> MCMC to recover a posterior on model parameters <br> -->
				<!-- 								$\rightarrow$  <b class="alert">analytic likelihood</b> : -->
				<!-- 								$p(\theta | x ) \propto \underbrace{p(x | \theta)}_{\mathrm{likelihood}}  \  \underbrace{p(\theta)}_{\mathrm{prior}}$ -->
				<!-- 							</li> -->

				<!-- 						</ul> -->
				<!-- 					</div> -->

				<!-- 				</div> -->

				<!-- 			</div> -->
				<!-- 			<div class="col" > -->
				<!-- 				<div style="position:relative; width:480px; height:420px; margin:0 auto;"> -->
				<!-- 					<img class="fragment current-visible"  data-src="assets/lsst_y10_forecast2.png" style="position:absolute;top:0;left:0;" data-fragment-index="0" /> -->
				<!-- 					<img class="fragment current-visible plain"  data-src="assets/cov.png" style="position:absolute;top:0;left:0;" data-fragment-index="1" /> -->
				<!-- 					<img class="fragment current-visible plain" data-src="assets/nbody.png"  data-fragment-index="2" /> -->
				<!-- 					  <img class="fragment  plain" data-src="assets/hsc_constraints.png" style="position:absolute;top:0;left:0;" data-fragment-index="3" /> -->
				<!-- 				</div> -->
				<!-- 				<div class="fragment current-visible" data-fragment-index="0" style="position:absolute; font-size: 20px;  left:900px">DESC Collaboration: 1809.01669</div> -->
				<!-- 				<div class="fragment current-visible" data-fragment-index="1" style="position:absolute; font-size: 20px;  left:980px">Krause &amp; Eifler 2016</div> -->
				<!-- 				<div class="fragment"  data-fragment-index="3" style="position:absolute; font-size: 20px; top:500px; left:1030px">Hikage et al. 2018</div> -->
				<!-- 			</div> -->
				<!-- 		</div> -->
				<!-- 		<br> -->
				<!-- 		<div class="fragment"> -->
				<!-- 			$\Longrightarrow$ Dire need for <b class="alert">novel analysis techniques</b> to fully realize the potential of modern surveys. -->
				<!-- 		</div> -->


				<!-- 	</section> -->

				<!-- </section> -->
                                
				<!-------------------------------------------------------------------------------->
	                        <!-------------------------------------------------------------------------------->

                                <section>
                                        
				        <section>
					        <div style="font-size:80px">Traditional cosmological analysis</div>
				        </section>
                                </section>
                                
				<!-------------------------------------------------------------------------------->
	                        <!-------------------------------------------------------------------------------->

				<section>
                                        <section>
                                                
						<h3  class='slide-title'>how do we do galaxy clustering analysis?</h3>

                                                <div class="plain fragment" data-fragment-index="0"> <b> Data</b>: a catalog of galaxy positions and their associated weights </div>

                                                <br>
                                                <br>
                                                <div class='container'>
								<div class="col" style="flex:0 0 25em; margin-left:20px">

                                                                        <ol> 
									        <li class="plain fragment" data-fragment-index="1" > Compute <b class="alert"> summary statistics </b> of choice
                                                                                        <ul> $\rightarrow$ generally power spectrum/2-point function</ul>
                                                                                </li>
                                                                                <br>
                                                                                <li class="plain fragment" data-fragment-index="2" > Develop a <b class="alert"> theory prediction </b> for theses summary statistics
                                                                                        <ul> $\rightarrow$ generally based on perturbation theory </ul>
                                                                                </li>
                                                                                <br>
                                                                                <li class="plain fragment" data-fragment-index="3" > Construct an  <b class="alert">analytic likelihood</b> model 
                                                                                        <ul> $\rightarrow$ generally assumed to be Gaussian </ul>
                                                                                </li>
                                                                                <br>
                                                                                <li class="plain fragment" data-fragment-index="4"> Profit: run <b class="alert"> MCMC </b> to infer posterior on model parameters
                                                                                        <div style="position:absolute; left:100px" > $$p(\theta | x ) \propto \underbrace{p(x | \theta)}_{\mathrm{likelihood}}  \  \underbrace{p(\theta)}_{\mathrm{prior}}$$ </div>

                                                                                </li>
                                                                        </ol>
									<br>

								</div>
						
								<div class="col">
									 <img class="plain  fragment current-visible" data-fragment-index="0" style="position:absolute; top:150px; left:180px;;" data-src="assets/desi.gif" />
									 <img class="plain fragment current-visible" data-fragment-index="1" style="position:absolute; top:200px; right:100px; height:300px;" data-src="assets/boss_dr12_data.png" />
									 <img class="plain fragment current-visible" data-fragment-index="2" style="position:absolute; top:200px; right:100px; width:500px;" data-src="assets/pk_eqn3.png" />
									 <img class="plain fragment current-visible" data-fragment-index="3" style="position:absolute; top:200px; right:100px; width:500px;" src="assets/pk_likelihood.png" />
									 <img class="plain fragment current-visible" data-fragment-index="4" style="position:absolute; top:150px; right:150px; height:400px;" src="assets/misha_constraints.png" />
									 <div class="plain fragment current-visible" data-fragment-index="1" style="position:absolute; bottom:0px; right:20px; font-size: 20px"> Beutler et.al. (including <b><u> CM</b></u>) (2016)</div>
									 <div class="plain fragment current-visible" data-fragment-index="2" style="position:absolute; bottom:0px; right:20px; font-size: 20px"> Beutler et.al. (including <b><u> CM</b></u>) (2016)</div>
									 <div class="plain fragment current-visible" data-fragment-index="3" style="position:absolute; bottom:0px; right:20px; font-size: 20px"> Kobayashi, Nishimichi et.al. (2022)</div>
									 <div class="plain fragment current-visible" data-fragment-index="4" style="position:absolute; bottom:-40px; right:20px; font-size: 20px"> Ivanov, Simonovic, Zaldarriaga (2020)</div>
								</div>
						</div>
					</section>

					<!-------------------------------------------------------------------------------->
                                        
                                        <section>
                                                
						<h3  class='slide-title'>Limitation of current analyses #1</h3>

                                                <br>
                                                <div class="boxonly" style="width:550px; padding:8px" >We need to choose a <b class="alert"> summary </b> statistic.</div> 
						<div class="slide-text">
                                                        
							<ul>
                                                                <br>
								<li class="fragment" data-fragment-index="0"> Power spectrum, and 2-point correlation function are <em> no longer </em>  sufficient.
                                                                        <ul class="fragment" data-fragment-index="2"> <li> Has this not been a limitation before? </li>  </ul>
                                                                        <ul class="fragment" data-fragment-index="3"> <li> New surveys are probing smaller, non-linear and non-Gaussian scales. </li>  </ul>
                                                                </li>
                                                                <br>
                                                                <li class="fragment" data-fragment-index="4"> Need to go beyond 2-point function analysis. </li>
                                                                <br>
                                                                <li class="fragment" data-fragment-index="5"> How much information is left behind? </li>
								<br>
                                                        </ul>
                                                        
						</div>
						
                                                <span class= "fragment fade-in" data-fragment-index="1" >
                                                        <span class= "fragment fade-out" data-fragment-index="4" >
                                                                <img class="plain" style="position:absolute; top:260px; left:150px; width:320px; ;" data-src="assets/ngfield0.png" />
                                                                <img class="plain" style="position:absolute; top:260px; left:400px; width:320px;" data-src="assets/gfield0.png" />
                                                                <img class="plain" style="position:absolute; top:260px; left:680px; width:320px;" data-src="assets/ngfield0_pk.png" />
                                                                
                                                                <span class= "fragment fade-in" data-fragment-index="2" >
                                                                        
                                                                        <img class="plain" style="position:absolute; top:480px; left:150px; width:320px; ;" data-src="assets/ngfield1.png" />
                                                                        <img class="plain" style="position:absolute; top:480px; left:400px; width:320px; ;" data-src="assets/gfield1.png" />
                                                                        <img class="plain" style="position:absolute; top:480px; left:680px; width:320px; ;" data-src="assets/ngfield1_pk.png" />
                                                                </span>
                                                        </span>
                                                </span>

                                                <div class="block fragment " data-fragment-index="4" style="position:absolute; bottom:-260px; right:100px; width:400px">
							<div class="block-title" , style="text-align:center">
								Proposed summary statistics
							</div>
							<div class="block-content", style="text-align:center; font-size:smaller">
                                                                bispectrum <br>
                                                                three point function <br>
                                                                trispectrum <br>
                                                                reconstructed power spectrum <br>
                                                                peak counts <br>
                                                                k-nearest neighbor <br>
                                                                marked power spectrum <br>
                                                                density splits <br>
                                                                wavelet coefficients <br>
                                                                Minkowski functionals <br>
                                                                ...
							</div>
                                                        
						</div>
                                                
                                                <img class="plain fragment" data-fragment-index="4" style="position:absolute; bottom:-280px; left:100px; width:300px; ;" data-src="assets/wavelets_eickenberg_mfield.png" />
                                                <div class="plain fragment" data-fragment-index="4" style="position:absolute; bottom:-270px; left:360px; width:300px; font-size:smaller;"> Eickenberg et.al. (2022) </div>

					</section>


					<!-------------------------------------------------------------------------------->
                                        
                                        <section>
                                                
						<h3  class='slide-title'>Limitation of current analyses #2</h3>

                                                <br>
                                                <div class="boxonly" style="width:600px; padding:8px" > We need a <b class="alert"> theory </b>  model of the summary statistics. </div>
                                                
                                                <div class="slide-text" style="width:750px">
                                                        
							<ul>
                                                                <br>
                                                                <br>
								<li class="fragment" data-fragment-index="0"> Pertubation theory- as small perturbations beyond Gaussian random field.
                                                                        <ul class="fragment" data-fragment-index="1"> <li> Cannot model deep in the non-linear, non-Gaussian regime </li>  </ul>
                                                                </li>
                                                                <br>
                                                                <li class="fragment" data-fragment-index="2"> Hard to include survey systematics
                                                                        <ul > <li>  masks, fibre collisions, PSF... </li>  </ul>
                                                                </li>
                                                                <br>
                                                                <li class="fragment" data-fragment-index="3">  No theory model yet for other summary statistics than N-point functions
                                                                        <ul > <li>  how do you model neural network based summary statistics? </li>  </ul>
                                                                </li>
								<br>
                                                      </ul>
 						</div>
                                                <img class="plain fragment" data-fragment-index="1" style="position:absolute; top:200px; right:50px; width:400px;" data-src="assets/ptfit_shifan.png" />
                                                <img class="plain fragment current-visible" data-fragment-index="2" style="position:absolute; top:400px; left:50px; width:700px; text-align:center;" data-src="assets/desi_text.png" />
                                                <div style="float:right; margin-right:20px; text-align:right; font-size: smaller">
                                                        <div class="plain fragment " data-fragment-index="1" style=""> 
                                                                <u> Modi</u>, White, Vlah (2017) <br>
                                                                Chen, Vlah et.al. (2021)
                                                        </div> 
                                                        <div class="plain fragment current-visible" data-fragment-index="2" style=""> DESI whitepaper (Aghamousa et.al. (2016))</div>
                                                </div>

					</section>
                                        

					<!-------------------------------------------------------------------------------->
                                        
                                        <section>
                                                
						<h3  class='slide-title'>Limitation of current analyses #3</h3>

                                                <br>
                                                <div class="boxonly" style="width:600px; padding:8px"> We need to an <b class="alert"> analytic </b> likelihood model. </div>
						<div class="slide-text">

							<ul>
                                                                <br>
								<li  class="plain fragment fade-in" data-fragment-index="0"> Assumed to be a Gaussian likelihood based on central limit theorem.
                                                                        <ul class="plain fragment fade-in" data-fragment-index="1">
                                                                                <li> Not true in all the regimes for power spectrum. </li>
                                                                                <li> Not true for other summary statistics. </li>
                                                                        </ul>
                                                                </li>
								<br>
								<li  class="plain fragment fade-in" data-fragment-index="2"> Estimating covariance matrix is expensive!
                                                                        <ul>
                                                                                <li> Accuracy scales as $1/\sqrt{N_d}$  </li>
                                                                                <li> 2048 full-survey realizations for BOSS (Stage III) survey. </li>
                                                                        </ul>
								</li>
                                                                <br>
                                                                <li  class="plain fragment fade-in" data-fragment-index="4"> Combining different observables & surveys becomes challenging. </li>
 
                                                        </ul>
						</div>
                                                <span class="plain fragment fade-in" data-fragment-index="1">
                                                        <span class="plain fragment fade-out" data-fragment-index="4">
                                                                <img class="plain " style="position:absolute; top:150px; right:50px; width:400px;" data-src="assets/pl_divergence.png" />
                                                        </span>
                                                </span>
                                                <img class="fragment plain" data-fragment-index="4" style="position:absolute; top:200; right:50; width:400px;" data-src="assets/cov.png" />
                                                
                                                <div style="position:absolute; top:600px; right:20px; text-align:right; font-size: smaller">
                                                        <span class="plain fragment fade-in" data-fragment-index="1">
                                                                <span class="plain fragment fade-out" data-fragment-index="4">
                                                                        Hahn, Beutler et.al. (2019)
                                                                </span>
                                                        </span>
                                                        <div class="plain fragment" data-fragment-index="2" > Taylor, Joachimi, Kitching (2013) </div>
                                                        <div class="plain fragment" data-fragment-index="4" >Krause &amp; Eifler 2016</div>
                                                </div>

					</section>
                                </section>
                                        
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
                                
				<section>

                                        <!-- <section> -->
                                                
					<!-- 	<h3  class='slide-title'>a different perspective: forward modeling</h3> -->

                                        <!--         <br> -->
					<!-- 	<div class="box"> -->
					<!-- 		<div class="box-title"> -->
					<!-- 			Key Idea -->
					<!-- 		</div> -->
					<!-- 		<div class="box-content"> -->
                                        <!--                         Instead of trying to analytical evaluate the likelihood of data summary statistics, -->
                                        <!--                         build a computational forward model of the observables, -->
                                        <!--                         i.e. use the simulator as the physical model in the inference pipeline -->
					<!-- 		</div> -->
					<!-- 	</div> -->

                                        <!--         <br> -->
                                                
					<!-- 	<div class="container"> -->
					<!-- 		<div class='col fragment' data-fragment-index='1'> -->
					<!-- 			<img data-src="assets/fieldinit.png" class="plain" style="height:300px;"/> -->
					<!-- 			<b class="alert"> Linear Field </b> -->
					<!-- 		</div> -->
					<!-- 		<div class='col fragment' data-fragment-index='2'> -->
					<!-- 			<img data-src="assets/fieldfin.png" class="plain " style="height:300px;"/> -->
					<!-- 			<b class="alert"> Final Dark Matter </b> -->
					<!-- 		</div> -->
					<!-- 		<\!-- <hr style="width: 1px; height: 400px; background: white; border: none;" /> -\-> -->
					<!-- 		<div class='col fragment' data-fragment-index='3'> -->
					<!-- 			<img data-src="assets/fieldhalo.png" class="plain " style="height:300px;"/> -->
					<!-- 			<b class="alert"> Dark Matter Halos </b> -->
					<!-- 		</div> -->
					<!-- 		<div class='col fragment' data-fragment-index='4'> -->
					<!-- 			<img data-src="assets/fieldgal.png" class="plain " style="height:300px;"/> -->
					<!-- 			<b class="alert"> Galaxies </b> -->
					<!-- 		</div> -->
					<!-- 	</div> -->
                                                
					<!-- 	<div class="container" style="position:relative; width:1000px; height:50px; margin:0 auto;"> -->
					<!-- 		<div class='col fragment'  data-fragment-index='2'> <font size="10"> $\longrightarrow$ </font> <br> Gravity evolution <br> N-Body, PM simulations </div> -->
					<!-- 		<div class='col fragment' data-fragment-index='3'>  <font size="10"> $\longrightarrow$ </font> <br> Group Finding <br> algorithms </div> -->
					<!-- 		<div class='col fragment' data-fragment-index='4'>  <font size="10"> $\longrightarrow$ </font> <br> Semi-analytic &amp <br> distribution models </div> -->
					<!-- 	<\!-- 		<div class='fragment' data-fragment-index='2'> N-body simulations <div> -\-> -->
					<!-- 	<\!-- <div class='fragment' data-fragment-index='3'> Group Finding algorithms <div> -\-> -->
					<!-- 	<\!-- <div class='fragment' data-fragment-index='4'> Semi-analytic models <div> -\-> -->
					<!-- 	</div> -->
                                                                                                
                                                                                                
				        <!-- </section> -->

                                        <section>
                                                                                        
						<h3  class='slide-title'>a different perspective: forward modeling</h3>

                                                <br>
						<div class="block">
							<div class="block-title">
								Limitations of traditional analysis
							</div>
							<div class="block-content" style="font-size:smaller">
                                                                <ol>
                                                                        <span class="fragment" data-fragment-index="1">
                                                                                <span class="fragment highlight-current-green " data-fragment-index="4">
                                                                                        <li> Need to choose a summary statistic <br> $\rightarrow$ unclear which ones to use & and how much information is extracted. </li>
                                                                                </span>
                                                                        </span>
                                                                        <br>
                                                                        <span class="fragment" data-fragment-index="1">
                                                                                <span class="fragment highlight-green " data-fragment-index="3">
                                                                                        <li> Need a theory model  <br> $\rightarrow$ accurate in limited regimes and infeasible for new statistics </li>
                                                                                </span>
                                                                        </span>
                                                                        <br>
                                                                        <span class="fragment" data-fragment-index="1">
                                                                                <!-- <span class="fragment highlight-current-blue " data-fragment-index="4"> -->
                                                                                        <span class="fragment highlight-current-green " data-fragment-index="5">
                                                                                                <li> Need an analytic likelihood for inference <br> $\rightarrow$ limited to Gaussian approximation </li>
                                                                                <!-- </span> -->
                                                                        </span>
                                                                        <br>
                                                                        <span class="fragment" data-fragment-index="1">
                                                                                <span class="fragment highlight-current-green " data-fragment-index="4">
                                                                                        <span class="fragment highlight-current-green " data-fragment-index="5">
                                                                                                <li> Joint analysis of different statistics and surveys is challenging </li>
                                                                                        </span>
                                                                                </span>
                                                                        </span>
                                                                </ol>
							</div>
						</div>
						<!-- <div class="slide-text"> -->
						<!-- 	<b class="alert"> Limitations</b>  of traditional analysis: -->
                                                <!--         <br> -->
                                                <!--         <br>  -->
						<!-- 	<ol style="font-size:smaller"> -->
                                                <!--                 <li> Need to choose a summary statistic <br> $\rightarrow$ unclear which ones to use & and how much information is extracted. </li> -->
                                                <!--                 <br> -->
                                                <!--                 <li> Need a theory model  <br> $\rightarrow$ accurate in limited regimes and infeasible for new statistics </li> -->
                                                <!--                 <br> -->
                                                <!--                 <li> Need an analytic likelihood for inference  <br> $\rightarrow$ limited to Gaussian approximation & joint analysis is challenging. </li> -->
						<!-- 	</ol> -->
						<!-- </div> -->

                                                <br>
						<div class="box fragment" data-fragment-index="2">
							<div class="box-title">
								Forward Modeling approach for cosmological analysis
							</div>
							<div class="box-content">
                                                                <br>
                                                                Instead of a theory model, use a computational forward models i.e. cosmological simulations as the underlying physical models for inference.
                                                                <br>
                                                                <br>
                                                                <div class="fragment fade-in " data-fragment-index="4">
                                                                        <div class="fragment highlight-current-green" data-fragment-index="4"> 1. Field Level Inference / Bayesian Heirarchical Modeling </div>
                                                                </div> 
                                                                <br>
                                                                <div class="fragment fade-in " data-fragment-index="5">
                                                                        <div class="fragment highlight-current-green" data-fragment-index="5">  2. Simulations Based Inference / Likelihood Free Inference / Implicit Inference  
                                                                        </div>
                                                                </div> 
							</div>
                                                </div>
                                                <br>
                                                
                                                                                                
                                                                                                
				        </section>

				        <!-------------------------------------------------------------------------------->

                                        <section>
                                                <h3  class='slide-title'>example: forward modeling for galaxy clustering</h3>

                                                                                                
                                                <br>
						<div class="container" style="font-size:smaller">
                                                        <div class='col fragment' data-fragment-index="1" >
								<br>
								<br>
                                                                $\Lambda$
                                                                <br>
								<b class="alert"> Cosmology </b>
								<div style="font-size:30px"> + </div>
								<img data-src="assets/modes.png" class="plain" style="position:relative; top:-30px; height:150px;"/>
								<b class="alert" style="position:relative; top:-45px; ;"> Initial modes <br> $z \sim \mathcal{N}(0, 1)$</b>
							</div>

							<div class='col fragment' data-fragment-index='2'>
								<img data-src="assets/fieldinit.png" class="plain" style="height:200px;"/>
                                                                <br>
								<b class="alert"> Initial (Linear) <br>Dark Matter </b>
							</div>
							<div class='col fragment' data-fragment-index='3'>
								<img data-src="assets/fieldfin.png" class="plain " style="height:200px;"/>
								<br>
                                                                <b class="alert"> Final (Evolved) <br> Dark Matter </b>
							</div>
							<div class='col fragment' data-fragment-index='4'>
								<img data-src="assets/fieldhalo.png" class="plain " style="height:200px;"/>
								<br>
                                                                <b class="alert"> Dark Matter <br> Halos </b>
							</div>
							<div class='col fragment' data-fragment-index='5'>
								<img data-src="assets/fieldgal.png" class="plain " style="height:200px;"/>
                                                                <br>
                                                                <b class="alert"> Galaxies <br> (Tracers) </b>
							</div>
							<div class='col fragment' data-fragment-index='6'>
                                                                $x = f(\Lambda)$
								<br>
                                                                <br>
                                                                <b class="alert"> Data </b>
							</div>
                                                        
						</div>
                                                
						<div class="container" style="position:absolute; top:255px; width:1100px; height:50px; left:90px; font-size:35px">
							<div class='col fragment' data-fragment-index='2'>  $\rightarrow$ </div>
							<div class='col fragment' data-fragment-index='3'>  $\rightarrow$ </div>
							<div class='col fragment' data-fragment-index='4'>  $\rightarrow$ </div>
							<div class='col fragment' data-fragment-index='5'>  $\rightarrow$ </div>
							<div class='col fragment' data-fragment-index='6'>  $\rightarrow$ </div>
						</div>
                                                                                                
						<div class="container" style="position:relative; top:20px; width:1100px; height:50px; margin:0 auto; font-size:17px">
							<div class='col fragment' data-fragment-index='2'>  Boltzmann <br> equations </div>
							<div class='col fragment' data-fragment-index='3'>  Gravity evolution <br> (N-Body/<br>PM simulations) <br> ($\mathbf{\Lambda}$) </div>
							<div class='col fragment' data-fragment-index='4'>  Group Finding <br> algorithms <br>  ($\mathbf{\theta}$) </div>
							<div class='col fragment' data-fragment-index='5'>  Halo distribution/<br> Semi-analytic models <br> ($\mathbf{\theta}$)  </div>
							<div class='col fragment' data-fragment-index='6'>  Survey systematics <br> & summarize<br> ($\mathbf{\theta}$)  </div>
						</div>
                                                                                                
                                                
				        </section>
                                        
                                        <!-------------------------------------------------------------------------------->


                                        <section>
                                                <h3  class='slide-title'>now is time for forward modeling</h3>

                                                <br>
                                                Advances in computations, statistics and machine learning over the last 5-10 years <br> have finally made forward modeling approaches feasible. 
                                                <div class="container">
                                                        <div class="col slide-text" >
								<ol>
									<br>
									<li class="fragment plain" data-fragment-index="1" > GPU accelerated computations <br>
										<div style = "font-size:smaller" > $\rightarrow$ supercomputers like Perlmutter with 6000 A-100 GPUs  </div> 
									</li>
									<br>
									<li class="fragment plain" data-fragment-index="2"> Bayesian inference algorithms <br>
										<div style = "font-size:smaller" > $\rightarrow$ HMC, NUTS, VI & more for high dimensional inference  </div> 
									</li>
									<br>
									<li class="fragment plain" data-fragment-index="3"> Automatic differentiation frameworks <br>
										<div style = "font-size:smaller" > $\rightarrow$ mining the simulators with gradient information  </div> 
									</li>
									<br>
									<li class="fragment plain" data-fragment-index="4"> Deep learning tools <br>
										<div style = "font-size:smaller" > $\rightarrow$ neural density estimators like normalizing flows </div> 
									</li>
									<br>
									<li class="fragment plain" data-fragment-index="5"> Large scale resource investment<br>
										<div style = "font-size:smaller" > $\rightarrow$ collaboration and funding opportunities </div> 
									</li>
									<br>
								</ol>
								
							</div>
							<div class="col "> 
								<img class="fragment plain" data-fragment-index="1" style="position:absolute; top:200px; right:350px; width:300px;"
								     data-src="assets/perlmutter.jpg" />
								<img class=" plain fragment" data-fragment-index="2" style="position:absolute; top:220px; right:20px; width:320px;"
								     data-src="assets/nuts.png"  />
								<img class=" plain fragment" data-fragment-index="3" style="position:absolute; top:420px; right:480px; width:230px;"
								     data-src="assets/TF_FullColor_Horizontal.png" />
								<img class=" plain fragment" data-fragment-index="3" style="position:absolute; top:400px; right:350px; width:110px; height:60px;"
								     data-src="assets/jax_logo.png"  />
								<img class="plain fragment" data-fragment-index="4" style="position:absolute; top:400px; right:20px; width:300px;"
								     data-src="assets/glow_example.png"  />
								<img class="plain fragment" data-fragment-index="5" style="position:absolute; top:480px; right:400px; width:280px;"
								     data-src="assets/nsf_ai.png"  />
							</div>
						</div>
						<div class="plain" style="position:absolute; bottom:-0px; right:20px; font-size:20px; text-align:right">
							<div class="plain fragment" data-fragment-index="2" > Hoffmann & Gelman (2011)</div>
							<div class="plain fragment" data-fragment-index="4" > Kingma & Dhariwal (2018)</div>
						</div>
						
				        </section>
                                        
				</section>
                                

                                <!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				<section>
					<div style="font-size:80px">Field Level Inference</div>
				</section>

				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->

                                <section>
                                        <section>
                                                
						<h3 class='slide-title'> Field Level Inference </h3>

                                                <br>
                                                <div class="">
                                                        <!-- <div class="box"> -->
                                                        <!--         <div class="box-title", style="text-align:left; padding-left:20px "> -->
                                                        <!--                 Motivation -->
                                                        <!--         </div> -->
                                                        <!--         <div class="box-content"> -->
                                                        <!--                  Use simulations to model the field-level data without any compression <br> -->
                                                        <!--                  Simultaneously infer the initial conditions of the Universe and the cosmological parameters. -->
                                                                        
                                                        <!--         </div> -->
                                                        <!-- </div> -->
							<div class="boxonly" style="width:1100px; padding:10px">
                                                                Use simulations to model the field-level data <b class="alert" >without any compression </b> <br>
								<div class="fragment" data-fragment-index="2">
									$\rightarrow$ Simultaneously infer the initial conditions of the Universe and the cosmological parameters.
								</div>
                                                        </div>

                                                        <br>
                                                        <div class="plain fragment",  data-fragment-index="3", style=";">

                                                        Given observed data, we can inferring the initial conditions ($z$) by maximizing the posterior :
                                                        $$\hat{z} =  \max_z \log p(x| f(z)) \ + \log p(z) $$
                                                        </div>

                                                        <span class="plain fragment fade-in" data-fragment-index="1">
								<span class="plain fragment fade-out" data-fragment-index="4">
									<img class="plain" style="position:absolute; left:-300px; top:220px" data-src="assets/fwdmodel.png" style='height:500px;' />
								</span>
							</span>
                                                </div>
                                                <div class="container">
                                                                <div class="col fragment" data-fragment-index="4">
                                                                        <img class="plain" data-src="assets/init_field.png" style='height:250px;' />
                                                                        <br> True initial conditions <br> $z_0$
                                                                </div>

                                                                <div class="col fragment" data-fragment-index="3">
                                                                        <img class="plain" data-src="assets/reconim_init.gif" style='height:250px;' />
                                                                        <br> Reconstructed initial conditions $z$
                                                                </div>

                                                                <div class="col fragment" data-fragment-index="3">
                                                                        <img class="plain" data-src="assets/reconim_fin.gif" style='height:250px;' />
                                                                        <br> Reconstructed data <br> $x = f(z)$
                                                                </div>

                                                                <div class="col " data-fragment-index="1">
                                                                        <img class="plain" data-src="assets/fin_field.png" style='height:250px;' />
                                                                        <br> Data <br> $x = f(z_0)$
                                                                </div>
                                                        <br>
                                                </div>
                                        </section>
                                </section>
                                                
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				<section>
					<div style="font-size:40px">In addition to inferring a handful of cosmology parameters, <br>
						we now also wish to estimate millions of latent parameters.<br>
						<div class="fragment"> Why?</div>
					</div>
				</section>

                                <!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				<section>

                                        <section>
                                                
                                                <h3 class='slide-title'> Why field level inference #1 </h3>
                                                
                                                <br>
						<div class="boxonly" style="width:600px; padding:10px">
							It is the  <b class="alert"> optimal </b>  approach to cosmological analysis
						</div>
						
                                                <div class="slide-text", style="position:relative;">
                                                        <br>
                                                        <ul>
                                                                <li class="fragment " data-fragment-index="1"> No information is lost by compressing data into summary statistics.
                                                                </li>
                                                                <br>
                                                                <li class="fragment " data-fragment-index="2"> Undo non-linear evolution to recover the Gaussian initial conditions. <br>
                                                                        $\rightarrow$ standard reconstruction for Baryon Acoustic Oscillations (BAO) <br>
                                                                </li>
                                                        </ul>
                                                        <br>
                                                </div>
						<br>
                                                <div class="container">

							<div class="col" >
                                                                <img class="fragment plain"   data-fragment-index="1" width="300px" height="300px" style="position:relative;;" data-src="assets/field_level_prelim.png" />

								<div class="fragment  " data-fragment-index="1" style="position:absolute; float:right;  bottom:-10px; right:600px; font-size: 20px; margin:0 auto"><b><u>Modi</u></b> et.al. (Preliminary)</div>

							</div>
							<div class="col" >
								<img class="fragment plain" data-fragment-index="2" width="350px" height="300px" style="position:relative;" data-src="assets/realbaofisher.png" /> 

								<div class="fragment  " data-fragment-index="2" style="position:absolute; float:right;  bottom:-10px; right:0px; font-size: 20px; margin:0 auto">Seo et al. (2007)</div>
								<div class="fragment  " data-fragment-index="2" style="position:absolute; float:right;  bottom:10px; right:0px; font-size: 20px; margin:0 auto"><b><u>Modi</u></b>, Feng, Seljak (2018)</div>
							</div>
                                                </div>
                                                
                                        </section>
                                                                                
                                        <!-------------------------------------------------------------------------------->

                                        <section>
                                                
                                                <h3 class='slide-title'> Why field level inference #2 </h3>


                                                <br>
						<div class="boxonly" style="width:800px; padding:10px">
							Enables  <b class="alert"> joint analysis </b>  of different cosmological probes and surveys.
						</div>
                                                <br>

                                                <div class="slide-text">
							<div class="plain fragment", data-fragment-index="1">
								<b> Bottleneck</b>: Traditional analysis needs to model covariance matrix of different datasets
								<div style="font-size:smaller">
									$$ \log p(\theta | x_1, x_2) \propto   -\frac{1}{2}[x_{1} - t_1(\theta),\, x_2 - t_2(\theta)] ^\dagger C^{-1}  [x_{1} - t_1(\theta),\, x_2 - t_2(\theta)] + \log p(\theta)$$
								</div>
							</div>
							<div class="plain fragment", data-fragment-index="2">
								Instead of the likelihood, capture correlations in the joint forward model: $x_1, x_2 = f( z, \theta)$
								<div style="font-size:smaller">

									$$\log p(z, \theta | x_1, x_2) \propto  \log p(x_{1} | f(z, \theta)) + \log p(x_{2} | f(z,  \theta)) \ + \log p(z) + \log p(\theta) $$
								</div>
							</div>
							<br>
							
                                                </div>
						<div class="plain fragment", data-fragment-index="2" style="position:absolute; left:50px" >
							Joint reconstruction from <br> halo position & velocity data
							<br>
							<br>
							<img class="plain"  style="position:relative; width:800px"
							     data-src="assets/bayer_eqn.png"/>

						</div>
							
						<img class="plain fragment"  , data-fragment-index="2" style="position:absolute; right:100px; top:400px; height:280px "
							     data-src="assets/bayer_velrecon.png"/>

						<div class="fragment  " data-fragment-index="2" style="position:absolute; float:right;  top:700px; right:0px; font-size: 20px; margin:0 auto">Bayer, <b><u>Modi</u></b>, Ferraro (2022)
						</div>
								
                                                
                                        </section>
                                        <!-------------------------------------------------------------------------------->
                                        <!-------------------------------------------------------------------------------->
                                        <section>
                                                
                                                <h3 class='slide-title'> Why field level inference #3 </h3>
                                                

                                                <br>
						<div class="boxonly" style="width:800px; padding:10px">
							Reconstruct  <b class="alert"> latent </b>  fields to enable supplementary analysis
						</div>
                                                <br>
                                                <div class="container">

							<div class="col"  style="flex: 0 0 32em;">

                                                                <div class="slide-text", style="position:relative;">
                                                                        <div class="plain fragment" data-fragment-index="1">
                                                                                <b> Example</b>: Foreground wedge in 21-cm surveys
                                                                        </div>
                                                                        <br>
                                                                        
                                                                        <ul>
                                                                                <li class="fragment " data-fragment-index="1"> Large scale modes in the wedge are lost, 20-80% of the data
                                                                                </li>
                                                                                <br>
                                                                                <li class="fragment " data-fragment-index="2"> Match field level data on small scales to recover intial conditions
                                                                                </li>
                                                                                <br>
                                                                                <li class="fragment " data-fragment-index="2"> Evolve initial conditions to reconstruct large scales
                                                                                </li>
                                                                                <br>
                                                                                <li class="fragment " data-fragment-index="3"> Enable cross-correlation analysis with photometric surveys and CMB lensing
                                                                                        <br>
                                                                                        $\rightarrow$ most promising probes for high redshift
                                                                                </li>
                                                                        </ul>
                                                                        <br>
                                                                        <br>
                                                                        <br>
                                                                        <div class="plain fragment" data-fragment-index="4">
                                                                                Other latent fields: velocity, dark matter, tidal-tensor field...
                                                                        </div>
                                                                        <br>

                                                                </div>
                                                                
							

							</div>
							<div class="col" style="flex: 0 0 21em;">

                                                                <div style="position:relative; width:500px; height:600px; margin:0 auto;">
                                                                        <img class="fragment  plain"  data-src="assets/21cmcorrupt_x.png" width="150px" style="position:absolute; top:0px; left:0px;" data-fragment-index="1"/>
                                                                        <img class="fragment  plain"  data-src="assets/21cmcorrupt_x2.png" width="150px"  style="position:absolute; top:0px; left:175px;" data-fragment-index="1"/>
                                                                        <img class="fragment  plain"  data-src="assets/21cmcorrupt_x3.png" width="150px" style="position:absolute; top:0px; left:350px;" data-fragment-index="2"/>
                                                                        <img class="fragment  current-visible plain"  data-src="assets/21cmwedge.png" style="position:absolute; top:200px; left:10px;" data-fragment-index="1" />
                                                                        <img class="fragment  current-visible plain"  data-src="assets/21cmwedge.png" style="position:absolute; top:200px; left:10px;" data-fragment-index="2" />
	                                                                <img class="plaint fragment" data-fragment-index="3" style="position:relative; width:370px; top:160px; text-align:center"
								             data-src="assets/photocross-snr.png" />
                                                                        <div  class="fragment  plain"  data-fragment-index="1" style="position:absolute; float:right; right:0px; top:450px; font-size:20px; text-align:right">
										<b><u>Modi</u></b>, White et al. (2019) <br>
										<b><u>Modi</u></b>, Castorina et al. (2019) <br>
										<b><u>Modi</u></b>, White et al. (2021) <br>
									</div>
							        </div>
							</div>
                                                </div>

                                        </section>
                                        

				
				</section>

				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				<section>
					<div style="font-size:40px">Roadmap to field level inference-<br>
						advances, challeges and the way ahead
						<div class="fragment"> </div>
					</div>
				</section>

                                <!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				<section>
					<section>
						<h3 class='slide-title'> Roadmap to field level inference #1 </h3>

						<br>
						<div class="boxonly" style="width:800px; padding:10px">
							<b class="alert"> Fast, differentiable </b> cosmological simulations.
						</div>
						<br>
						<br>
						<div class="slide-text">
							
							<div class="container">
                                                        	<div class="col" style="flex: 0 0 32em;" >
									<ul>
										<li class="fragment " data-fragment-index="1"> 	Infer initial conditions at all points in the Universe <br>
											$\sim$ over a million unknown parameters
											
										</li>
										<br>
										<li class="fragment " data-fragment-index="2"> 	Need to use gradient based inference algorithms <br>
											$\rightarrow$ gradient descent optimization, Hamiltonian Monte Carlo, Variational inference...<br>
										</li>
										<br> 
										<li class="fragment " data-fragment-index="3"> 	 <b> Automatic differentiation </b> is the hammer behind deep learning <br>
											$\rightarrow$  <b>TensorFlow</b>, <b>JAX</b> or PyTorch.
										</li>
										<br>
										<li class="fragment " data-fragment-index="4"> 	 <b> GPU accelerated </b> simulations 
										</li>
									</ul>
								</div>
								<div class="col" style="flex: 0 0 21em; text-align:center">
									<div class="fragment " data-fragment-index="2" style="position:relative; top:50px">
										$$g_z = \frac{\partial\, p(z, \theta | x)}{\partial\, z},\, g_{\theta} = \frac{\partial\, p(z, \theta | x)}{\partial\, \theta}$$
									</div>

									<img class=" plain fragment " data-fragment-index="3" style="position:relative; top:50px; width:300px"
									     data-src="assets/TF_FullColor_Horizontal.png" />
									<img class=" plain fragment " data-fragment-index="3" style="position:relative; top:50px; width:200px; height:100px"
									     data-src="https://raw.githubusercontent.com/google/jax/master/images/jax_logo_250px.png"  />
									
								</div>
							</div>
							
						</div>
					</section>

                                        <!-------------------------------------------------------------------------------->

					
				<!-- 	<section> -->
				<!-- 		<h3 class='slide-title'><b class="alert"> FlowPM</b>: the first particle-mesh simulations in TensorFlow</h3> -->

						
				<!-- 		<div class='container'> -->
				<!-- 			<div class='col slide-text' style="flex: 0 0 25em;"> -->
								
				<!-- 				<ul> -->
				<!-- 					<li class="fragment" data-fragment-index="1">	Reconstructing the Universe in 10 lines -->
				<!-- 						<ul> -->
				<!-- 							<li> Automatic differentiation -->
				<!-- 							</li> -->
				<!-- 							<li> Access to SOTA optimization and Bayesian inference algorithms -->
				<!-- 							</li> -->
				<!-- 							<li>  Seamless interfacing with deep-learning tools  -->
				<!-- 							</li> -->
				<!-- 						</ul> -->
										
				<!-- 					</li> -->
				<!-- 					<br> -->
				<!-- 					<li class="fragment" data-fragment-index="2">	GPU accelerated simulations -->
				<!-- 						<ul> -->
				<!-- 							<li> $\sim$ 10 times faster than CPU simulations -->
				<!-- 							</li> -->
				<!-- 						</ul> -->
				<!-- 					</li> -->
				<!-- 					<br> -->
				<!-- 					<li class="fragment" data-fragment-index="3"> -->
				<!-- 						Distributed to multiple GPU with Mesh-TensorFlow -->
				<!-- 						<ul> -->
				<!-- 							<li> 2048$^3$ simulation -->
				<!-- 							</li> -->
				<!-- 							<li> Distributed on 256 NVIDIA V100 GPU -->
				<!-- 							</li> -->
				<!-- 							<li> Runtime: 3 mins -->
				<!-- 							</li> -->
				<!-- 						</ul> -->
				<!-- 					</li> -->
								
				<!-- 			</div> -->
							
				<!-- 			<div class='col' style="flex: 0 0 28em;"> -->

				<!-- 				<div style="position:relative; text-align:center"> -->
								
				<!-- 					<div class="plain" style="position:absolute; margin-left:20px"> <a href="https://github.com/DifferentiableUniverseInitiative/flowpm">https://github.com/DifferentiableUniverseInitiative/flowpm</a> -->
				<!-- 					</div> -->
				<!-- 					<div class="fragment current-visible" data-fragment-index="1" style="position:relative; top:30px; left:-15px"> -->
				<!-- 					  <pre  ><code data-trim data-noescape style="height:80em;width:49em;"> -->
				<!-- 					  import tensorflow as tf -->
				<!-- 					  import flowpm -->

				<!-- 					  #Run simulation from variable initial conditions -->
				<!-- 					  linear = tf.get_variable('linear', shape=(nc, nc, nc), -->
				<!-- 								 initializer=tf.random_normal_initializer(), trainable=True) -->
				<!-- 					  initial_conditions = flowpm.lpt_init(linear, name='icstate') -->
				<!-- 					  final_state = flowpm.nbody(initial_conditions, stages, nc, name='fnstate') -->
				<!-- 					  final_field = flowpm.cic_paint(tf.zeros_like(linear), final_state[0], boxsize=bs) -->

				<!-- 					  #Likelihood term: ((data-model)/noise)^2 -->
				<!-- 					  residual = tf.multiply(tf.subtract(final_field, data), 1/sigma) -->
				<!-- 					  neg_log_likelihood = tf.reduce_sum(tf.multiply(residual, residual)) -->

				<!-- 					  #Prior: (linear_modes^2 / linear_power_spectrum) -->
				<!-- 					  lineark = flowpm.r2c3d(linear, norm=nc**3) -->
				<!-- 					  neg_log_prior = tf.square(tf.cast(tf.abs(lineark), tf.float32)) -->
				<!-- 					  neg_log_prior = tf.reduce_sum(tf.multiply(neg_log_prior, 1/priorwt))j -->

				<!-- 					  #Loss & optimize -->
				<!-- 					  loss = tf.add(neg_log_likelihood, neg_log_prior, name='loss') -->
				<!-- 					  optimizer = ScipyOptimizerInterface(loss, var_list=[linear], 'L-BFGS-B') -->
				<!-- 					  with tf.Session() as session: -->
				<!-- 					      optimizer.minimize(session) -->
				<!-- 					      recon = session.run(linear) -->
				<!-- 					  </code></pre> -->
				<!-- 				</div> -->
				<!-- 				<img  class="plain fragment current-visible" data-fragment-index="2" style="position:absolute; top:30px; left:25px" data-src="assets/flowpm_lptcompare.png"/> -->
				<!-- 				<img  class="plain fragment" data-fragment-index="3" style="position:absolute; top:30px; left:150px" data-src="assets/mfpm_demo_1024.png" /> -->
							
								
				<!-- 				</div> -->
				<!-- 			</div> -->
							
							
				<!-- 		</div> -->
				<!-- 	</section> -->
					
				
				<!-- 	<section> -->
				<!-- 		<h3 class='slide-title'> $pmwd$: Particle Mesh with Derivatives </h3> -->

												
				<!-- 		<div class='container'> -->
				<!-- 			<div class="col" style="flex: 0 0 25em;"> -->

				<!-- 				<br> -->
				<!-- 				<div class="slide-text"> -->
				<!-- 					<b> Bottleneck </b>: Back-propogation is memory limited as it saves every snapshot of the simulation. -->
				<!-- 					<br> -->
				<!-- 					<br> -->
				<!-- 					<ul> -->
				<!-- 					<li class="fragment" data-fragment-index="1"> Adjoint method: evolve adjoint variables <em> backwards </em>  in time to evaluate gradients -->
				<!-- 						<ul> -->
				<!-- 							<li> Neural ODE & SDE (Chen et.al.) -->
				<!-- 							</li> -->
				<!-- 						</ul> -->
										
				<!-- 					</li> -->
				<!-- 					<br> -->
				<!-- 					<li class="fragment" data-fragment-index="2">	Leapfrog integration is exactly reversible -->
				<!-- 					</li> -->
				<!-- 					<br> -->
				<!-- 					<li class="fragment" data-fragment-index="3"> -->
				<!-- 						Memory cost of $pmwd$ simulations is <b class="alert"> independent </b>  of the number of time steps -->
				<!-- 						<ul> -->
				<!-- 							<li> accurate velocities & weak lensing simulations -->
				<!-- 							</li> -->
				<!-- 						</ul> -->
				<!-- 					</li> -->
				<!-- 					<br>  -->
				<!-- 					<li class="fragment" data-fragment-index="4"> CUDA optimizations -->
				<!-- 						<ul> -->
				<!-- 							<li> Faster than end-to-end deep learning emulators, 100x faster than CPU simulations -->
				<!-- 							</li> -->
				<!-- 						</ul> -->
				<!-- 					</li> -->
				<!-- 				</div> -->
				<!-- 			</div> -->
							
				<!-- 			<div class='col' style="flex: 0 0 10em;"> -->

				<!-- 					<div class="plain" style="position:absolute; top:50px; margin-left:180px"> <a href="https://github.com/eelregit/pmwd">https://github.com/eelregit/pmwd</a> -->
				<!-- 					</div> -->

							
				<!-- 				<img  class="plain" width="500px" style="position:absolute; top:100px" data-src="assets/pmwd_table.png" /> -->
				<!-- 				<img  class="plain fragment current-visible " data-fragment-index="2" -->
				<!-- 				      style="position:absolute; top:300px; margin-left:130px " data-src="assets/leapfrog.png" /> -->
				<!-- 				<img  class="plain fragment current-visible " data-fragment-index="3" -->
				<!-- 				      style="position:absolute; top:300px; margin-left:130px " data-src="assets/leapfrog.png" /> -->
				<!-- 				<img  class="plain fragment" data-fragment-index="4" -->
				<!-- 				      style="position:absolute; top:300px" width="500px" data-src="assets/pmwd_timing.png" /> -->
				<!-- 			</div> -->
				<!-- 		</div> -->
						
				<!-- 	</section> -->
				<!-- </section> -->
				
				
                                <!-------------------------------------------------------------------------------->
				
				
				<section>
						<h3 class='slide-title'> Differentiable Cosmological Simulations</h3>

						
						<br>
						<div class="fragment" data-fragment-index="1" > <b class="alert "> FlowPM</b>: the first particle-mesh simulations in TensorFlow </div>
						<br>
						
						<div class='container'>
							<div class='col slide-text' style="flex: 0 0 25em;">
								
								<ul>
									<li class="fragment" data-fragment-index="2">	Reconstructing the Universe in 10 lines
										<ul>
											<li> Automatic differentiation
											</li>
											<li> Access to SOTA inference algorithms
											</li>
											<li>  Seamless interfacing with deep-learning tools 
											</li>
										</ul>
										
									</li>
									<br>
									<li class="fragment" data-fragment-index="3">	GPU accelerated simulations
										<ul>
											<li> $\sim$ 10 times faster than CPU simulations
											</li>
										</ul>
									</li>
									<br>
									<li class="fragment" data-fragment-index="4">
										Distributed to multiple GPU with Mesh-TensorFlow
										<ul>
											<li> 2048$^3$ simulation on 256 GPU in 3 min
											</li>
										</ul>
									</li>
								
							</div>
							
							<div class='col' style="flex: 0 0 28em;">

								<div style="position:relative; text-align:center">
								
																	
									<img  class="plain fragment fade-out" data-fragment-index="1" style="position:absolute; top:0px; right:100px; width:500px" data-src="assets/pmwd_table_fastpm.png" />
									<img  class="plain fragment current-visible" data-fragment-index="1" style="position:absolute; top:0px; right:100px; width:500px" data-src="assets/pmwd_table_flowpm.png" />

									<div class="fragment current-visible" data-fragment-index="2" style="position:relative; top:0px; left:-20px">
									  <pre  ><code data-trim data-noescape style="height:80em;width:49em;">
									  import tensorflow as tf
									  import flowpm

									  #Run simulation from variable initial conditions
									  linear = tf.get_variable('linear', shape=(nc, nc, nc),
												 initializer=tf.random_normal_initializer(), trainable=True)
									  initial_conditions = flowpm.lpt_init(linear, name='icstate')
									  final_state = flowpm.nbody(initial_conditions, stages, nc, name='fnstate')
									  final_field = flowpm.cic_paint(tf.zeros_like(linear), final_state[0], boxsize=bs)

									  #Likelihood term: ((data-model)/noise)^2
									  residual = tf.multiply(tf.subtract(final_field, data), 1/sigma)
									  neg_log_likelihood = tf.reduce_sum(tf.multiply(residual, residual))

									  #Prior: (linear_modes^2 / linear_power_spectrum)
									  lineark = flowpm.r2c3d(linear, norm=nc**3)
									  neg_log_prior = tf.square(tf.cast(tf.abs(lineark), tf.float32))
									  neg_log_prior = tf.reduce_sum(tf.multiply(neg_log_prior, 1/priorwt))j

									  #Loss & optimize
									  loss = tf.add(neg_log_likelihood, neg_log_prior, name='loss')
									  optimizer = ScipyOptimizerInterface(loss, var_list=[linear], 'L-BFGS-B')
									  with tf.Session() as session:
									      optimizer.minimize(session)
									      recon = session.run(linear)
									  </code></pre>
								</div>
								<img  class="plain fragment current-visible" data-fragment-index="3" style="position:absolute; top:30px; left:25px" data-src="assets/flowpm_lptcompare.png"/>
								<img  class="plain fragment" data-fragment-index="4" style="position:absolute; top:30px; left:150px" data-src="assets/mfpm_demo_1024.png" />
								<div  class="plain fragment" data-fragment-index="4" style="position:absolute; top:440px; right:20px; font-size:20px"> Credits: F. Lanusse </div>
								<div  class="plain fragment" data-fragment-index="1" style="position:absolute; top:470px; right:20px; font-size:20px; text-align:right">
									<b> <u> Modi</u></b>, Lanusse, Seljak (2020) <br>
									<a href="https://github.com/DifferentiableUniverseInitiative/flowpm">https://github.com/DifferentiableUniverseInitiative/flowpm</a>
								</div>
								
								</div>
							</div>
							
							
						</div>
					</section>
					
				
					<section>
						<h3 class='slide-title'> Roadmap: Differentiable cosmological simulations </h3>

												
						<div class='container'>
							<div class="col" style="flex: 0 0 25em; margin-left:20px">

								<br>
								<b> Bottleneck </b>: Back-propogation is memory limited as it saves every snapshot of the simulation.
								<br>
								<br>
								
								<div class="box fragment" data-fragment-index="1" style="">
									<div class="box-title", style="height:35px">
										<b class="alert"> $pmwd$</b><font color="white">: particle mesh with derivatives </font>
									</div>
									<div class="box-content" style="">
										<ul class="fragment" data-fragment-index="2">
											<br>
											<li > Adjoint method to evaluate gradients <br>
											</li>
											<li>	Leapfrog integration is exactly reversible
											</li>
											<li> Memory cost is <b class="alert"> independent </b>  of the time stepping
											</li>
											<li class="fragment" data-fragment-index="3">  ~100x faster than CPU simulations <br>
												$\rightarrow$ faster than deep learning emulators
											</li>
										</ul>
									</div>
								</div>
								
								<br>

								<div class="box fragment" data-fragment-index="4" style="">
									<div class="box-title", style="height:35px">
										What's next?
									</div>
									<div class="box-content" style="">
										<ul class="fragment" data-fragment-index="5">
											<br>
											<li > Other observables like weak lensing, Lyman-$\alpha$
											</li>
											<li> Beyond $\Lambda$-CDM cosmology: PNG, $m_\nu$
											</li>
											<li> Baryonic effects and sub-grid physics
											</li>
											<li>...</li>
												
										</ul>
									</div>
								</div>
								
							</div>
							<div class='col' style="flex: 0 0 10em;">


 							
								<img  class="plain" width="430px" style="position:absolute; top:100px" data-src="assets/pmwd_table_flowpm.png" />
								<img  class="plain fragment"  data-fragment-index="1" width="430px" style="position:absolute; top:100px" data-src="assets/pmwd_table.png" />
								<img  class="plain fragment current-visible " data-fragment-index="1"
								      style="position:absolute; top:260px; right:190px; width:300px" data-src="assets/pmwd_logo.svg" />

								<img  class="plain fragment current-visible " data-fragment-index="2"
								      style="position:absolute; top:270px; right:200px " data-src="assets/leapfrog.png" />
								<img  class="plain fragment" data-fragment-index="3"
								      style="position:absolute; top:270px" width="430px" data-src="assets/pmwd_timing.png" />

								<span  class="plain fragment" data-fragment-index="1" style="position:absolute; top:600px; right:20px; font-size:20px; text-align:right">
									Li, <b><u>Modi</u></b> et.al. (2022) <br>
									Li, Lu, <b> <u>Modi</u></b> et.al. (2022) <br>
									<a href="https://github.com/eelregit/pmwd">https://github.com/eelregit/pmwd</a> <br>
									
								</span>
							</div>
						</div>
						
					</section>
				</section>


				<!-------------------------------------------------------------------------------->
                                <!-------------------------------------------------------------------------------->

				
				<section>
					
					<section>
						<h3 class='slide-title'> Roadmap to field level inference #2 </h3>

						<b class="alert"> Accelerated </b> Bayesian inference algorithms
						
						<div class="container">
							<div class="col">
								<div class="box fragment" data-fragment-index="1" style="position:absolute; top:150px; width:600px">
									<div class="box-title", style="height:35px">
										MAP estimate with gradient descent
									</div>
									<div class="box-content" style="font-size:smaller">
										<br>										
										$z_{i+1} = z_i - \epsilon \left(\nabla_z{\log p(z_i | x)} + \nabla_z \log p(z_i) \right)$
										<br>
										<br>
										<div class="slide-text">
											<b>Good</b>: Fast(er), $\mathcal O(100)$ iterations to reach MAP
											<br>
											<b>Bad</b>: Single, point estimate only
											<br>
											<b>Ugly</b>: Approximate, no theoretical guarantees
										</div>
									</div>
								</div>
							</div>
							
							<div class="col">
								<div class="box fragment" data-fragment-index="2" style="position:absolute; top:150px; width:650px">
									<div class="box-title", style="height:35px">
										Hamiltonian Monte Carlo (HMC)
									</div>
									<div class="box-content" style="font-size:smaller">
										<br>
										$H(z, p) = -\log p(z | x) + \frac{1}{2}p^T M^{-1} p$
										<br>
										<br>
										<div style="font-size:25px" >
											$\frac{dz }{dt} = \frac{\partial H(z, p)}{\partial z},\, \frac{dp }{dt} = -\frac{\partial H(z, p)}{\partial p}$
										</div>
										<br>
										<div class="slide-text">
											<b> Good</b>: Asymptotically explores the entire posterior
											<br>
											<b>Bad</b>: Consecutive samples are correlated
											<br>
											<div class="plain fragment" data-fragment-index="3" >
												<b>Ugly </b>: <b> <font color="red"> $\sim 10^4$ simulations </font> </b> for a single independent sample!!
											</div>

										</div>
									</div>
								</div>
							</div>
							<br>
							
						</div>
						<img  class="fragment plain" style="position:relative; top:320px" data-fragment-index="3" data-src="assets/hmc_ac.png" height="250px"/>
						<span  class="plain fragment" data-fragment-index="3" style="position:absolute; top:650px; right:20px; font-size:20px; text-align:right">
							<b><u>Modi</u></b>, Li, Blei (2022) <br>
							
						</span>
					</section>

					<!-------------------------------------------------------------------------------->

					<section>
						<h3 class="slide-title">Accelerating MAP optimization</h3>

						<br>
						&nbsp &nbsp<font style="font-size:smaller">
							$x_{i+1} = x_i - \epsilon \left[ \nabla_x{\log p(y | f(x_i))} + \nabla_x \log p(x_i) \right] = x_i - \Gamma \left(\nabla_x{\log p(y | f(x_i))}, \nabla_x \log p(x_i) \right)$
						</font>
						<div class="slide-text">
							<!-- &nbsp &nbsp<font style="font-size:smaller"> -->
							<!-- 	$x_{i+1} = x_i - \epsilon \left[ \nabla_x{\log p(y | f(x_i))} + \nabla_x \log p(x_i) \right] = x_i - \Gamma \left(\nabla_x{\log p(y | f(x_i))}, \nabla_x \log p(x_i) \right)$ -->
							<!-- </font> -->
							<br>
							update function  $\mathbf{\Gamma}(u,v) \rightarrow \epsilon(u + v)$
							<br>
							<div class="fragment" data-fragment-index="1">
								<b> Recurrent inference machine</b>: Learn the update function with recurrent neural networks.
							</div>
						</div>
						<br>
						<b class="alert"> CosmicRIM</b>: Recurrence Inference Machines for Reconstructing the Universe
						<br>
						<div class="container">
							<div class="col">
								<img class="fragment" data-fragment-index="1" data-src="assets/cosmic_rim.png" width="400" />
							</div>
							
							<div class="col">
								<img class="fragment" data-fragment-index="2" data-src="assets/rim_rc.png" width="420" />
								<br>
								<div class="fragment" data-fragment-index="2" style="font-size:smaller">
									CosmicRIM converges <b class="alert"> 40x </b> faster than L-BFGS
								</div>
							</div>
							<br>
							
						</div>
					</section>

					<!-------------------------------------------------------------------------------->
					

					<section>
						<h3 class="slide-title">Variational (self-)Boosted Sampling</h3>

						<br>
						<em> Combine HMC and variational inference to generate samples from the posterior with smaller auto-correlation length</em>
						<br>
						<br>
						<div class="slide-text">
							<ul>
								<li class="fragment" data-fragment-index="1" > Variational inference: approximate the target distribution with a parametric distribution $q(z; \nu)$
								</li>
								<br>
								<li class="fragment" data-fragment-index="2" > Two phase algorithm:
									<ol>
										<li class="fragment" data-fragment-index="2" > Learn a proposal variational distribution $q$ from a short, correlated HMC chain
											<ul> $q$: Normalizing flow with <em > Fourier space convolutions </em> (inductive bias)</ul>
										</li>
										<li class="fragment" data-fragment-index="3" > Alternate between generating samples from HMC kernel and variational distribution  </li>
									</ol>
									
								</li>
							</ul>
						</div>
						<br>
						<img class="plain fragment" data-fragment-index="4" width="1000px"  data-src="assets/vsbs_ac_200_64.png" />

					</section>
					

				</section>
                                <!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				
				<section>
					<section>
						<h3 class='slide-title'> Challenges to field level inference #3 </h3>
						Correct likelihood model?
					</section>
					
				</section>
                                <!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->

				<section >
					<h3 class='slide-title'>Story so far</h3>
					

					<br>
					<div class="block fragment " style="width:1200px">
						<div class="block-title" >
							Limitations of traditional analysis
						</div>
						<div class="block-content">
							<ul>
								<li> Develop novel inference methodologies for future surveys </li>
								<li> FlowPM: differentiable PM simulations in ML framework </li>
								<li> Hybrid, ML enahanced cosmological simulations </li>
                                                        </ul>
						</div>
					</div>
					<br>
					<div class="block fragment " style="width:1200px" >
						<div class="block-title" >
							Field Level Inference
						</div>
						<div class="block-content">
							<ul>
								<li> Why? Enables optimal analysis, joint analyses & reconstucts latent fields for supplementary analysis </li>
								<li> Requires access to fast, differentiable simulations such as FlowPM and $pmwd$ (open source)</li>
							        <li> Bayesian inference algorithms can be accelerated with ML components such as in CosmicRIM and VBS </li>
                                                        </ul>
						</div>
					</div>
					<br>
					
				</section>


                                <!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				<section>
					<div style="font-size:80px">Simulations Based Inference</div>
                                        (also goes by Likelihood Free Inference or Implicit Inference)
				</section>

				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				

				<section >
                                        <section> 
                                                <h3 class='slide-title'>beyond traditional analysis</h3>


                                                <br>
                                                To extract non-linear and non-Gaussian information from cosmological fields
                                                <br>
                                                <br>
                                                <br>
                                                <div class="slide-text">

                                                        <ul>
                                                                <li class="fragment " data-fragment-index="1" >Novel statistics promise to extract more information
                                                                        <ul style="font-size:smaller">
                                                                                <li> wavelet moments, marked power spectrum, k-nearest neighbors & more </li>
                                                                                <li> ML based summary statistics </li>
                                                                        </ul>
                                                                </li>
                                                                <br>
                                                                <li class="fragment " data-fragment-index="2">Challenge:
                                                                        <ul style="font-size:smaller">
                                                                                <li> Lack theoretical model for these statistics connecting to cosmology parameters </li>
                                                                                <li> Lack analytic likelihood model, $p(x | \theta)$ </li>
                                                                                <br>
                                                                                $$ p(\theta|x) \propto \color{red}{p(x | \theta)}\, p(\theta)$$
                                                                        </ul>
                                                                </li>
                                                        </ul>
                                                        <br>

                                                        <img class="plain fragment " data-fragment-index="1" style="position:absolute; top:150px; right:20px"
                                                             data-src="assets/wavelets_eickenberg_mfield.png" width="350" />

                                                </div>
                                   
                                        </section>


				        <!-------------------------------------------------------------------------------->

                                
                                        <section >
                                                <h3 class='slide-title'>simulations based inference - theory</h3>

                                                <br>
                                                <div class="block fragment " data-fragment-index="1" style=";" >
                                                        <div class="block-title" >
                                                                Motivation
                                                        </div>
                                                        <div class="block-content" style="font-size:smaller">
                                                                <ol>
                                                                        <li class=" fragment " data-fragment-index="1"> We can computationally evaluate these summary statistics.</li>
                                                                        <li class=" fragment" data-fragment-index="2"> A simulator defines $p(x|\theta)$ as an <em> implicit likelihood </em> distribution i.e we can sample from it but cannot evaluate it.</li>
                                                                </ol>
                                                        </div>
                                                </div>

                                                <br>
                                                        <img class="plain fragment" data-fragment-index="3" style=""
                                                             data-src="assets/lfi_sim.png" width="700" />
                                                        <div class="plain fragment" data-fragment-index="3" style="position:absolute; top:410px; left:300px; font-size:14px"> $\theta \sim p(\theta)$ </div> 
                                                        <div class="plain fragment" data-fragment-index="3" style="position:absolute; top:410px; left:570px; font-size:14px; color:black"> $z \sim p(z)$ </div> 
                                                        <div class="plain fragment" data-fragment-index="3" style="position:absolute; top:410px; left:910px; font-size:14px"> $x \sim p(x|\theta)$ </div> 
                                                        
                                                <div class="slide-text fragment " data-fragment-index="3" style="font-size:smaller">
                                                        <center> Generating simulations is equivalent to sampling from the joint distribution i.e. $\mathcal{D} = \{x_i, \theta_i\} \sim p(x, \theta)$ </center>
                                                        <br>
                                                        <!-- Inference: Assume the target posterior $p(\theta|x)$ can be modeled by a parametric conditional distribution $q_\phi(\theta | x)$. -->
                                                        <!-- Minimizing the KL divergence between them is equivalent to -->
                                                        <!--         $$  \min_\phi D_{KL}(p||q) \approx \max_{\phi} \sum_i \log q_{\phi}(\theta_i | x_i) $$ -->


                                                </div>
                                                <div class="block  fragment " data-fragment-index="4" style="" >
                                                        <div class="block-title" >
                                                                How to infer $p(\theta|x)$?
                                                        </div>
                                                        <div class="block-content" style="font-size:smaller">
                                                                Assume the target posterior can be modeled by a parametric conditional distribution $q_\phi(\theta | x)$.
                                                                <br>
                                                                <div class="plain fragment" data-fragment-index="5">
                                                                        Then, minimizing the Kullback Leibler  divergence between them leads to
                                                                        $$  \min_\phi D_{KL}(p||q) \approx \max_{\phi} \sum_i \log q_{\phi}(\theta_i | x_i) $$ 
                                                                        <!-- <br> -->
                                                                        <!-- <br> -->
                                                                        <!-- <center> $  \min_\phi D_{KL}(p||q) \approx \max_{\phi} \sum_i \log q_{\phi}(\theta_i | x_i) $ </center> -->
                                                                </div>
                                                        </div>
                                                </div>
                                        </section>


				        <!-------------------------------------------------------------------------------->

                                
                                        <section >
                                                <h3 class='slide-title'>simulations based inference - in practice </h3>

                                                <br>

                                                <div class="fragment" data-fragment-index="1">
                                                        Generate a dataset of simulations i.e. samples from the joint distribution
                                                        $$\mathcal{D} = \{x_i, \theta_i\}_{i\in N} \sim p(x, \theta)$$
                                                </div>
                                                <div class="fragment" data-fragment-index="2">
                                                        Optimize the parameters $\phi$ of a parameteric distribution $q_\phi$ to
                                                        $$\max_{\phi} \sum_i \log q_{\phi}(\theta_i | x_i) $$
                                                </div>

                                                <div class="fragment" data-fragment-index="3">
                                                        Then, in the limit of <b class="alert" > large number of samples</b>, $N$, and  <b class="alert" > sufficient flexibility </b> of $q_\phi$,
                                                        $$ q_{\phi^*}(\theta | x) \approx  p(\theta | x) $$
                                                </div>

                                                <div class="slide-text fragment" data-fragment-index="4">
                                                        $q_\phi$ is parameterizied as a neural network.
                                                        <br>
                                                        <br>
                                                        <ul>
                                                                <li>Mixture density network</li>
                                                                <li>Normalizing flows</li>
                                                        </ul>
                                                <br>
                                                <img class="plain " data-fragment-index="3" style="position:absolute; top:480px; left:520px"
                                                             width="320px" data-src="assets/maf_example.png"  />
                                                
                                                <img class="plain " data-fragment-index="3" style="position:absolute; top:480px; left:900px"
                                                             width="300px" data-src="assets/glow_example.png"  />
                                                </div>
                                        </section>

                                </section>
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->

				<section >
					<h3 class='slide-title'>Example application: <font style="font-variant:small-caps"> SimBIG</font></h3>
					
                                        <br>
                                        First analysis of BOSS CMASS galaxy sample with simulations based inference
                                        <br>
                                        <br>

                                        <div class="container">
						<div class="col"  style="flex: 0 0 30em">
                                                        <div class="slide-text">
								<ul>
									<li class="plain fragment " data-fragment-index="1"> Data
										<ul  style="font-size:smaller">
										
											<li> SDSS III survey, Baryon Oscillation Spectroscopic Survey  </li>
											<li> Collected spectra of $\sim$ 1.4 million galaxies from 2008-2014 </li> 
											<li> <font style="font-variant:small-caps"> SimBIG </font>  analyzed $\sim100,000$ galaxies from South Galactic Cap </li>
										</ul>
									</li>
									<br>
									<li class="plain fragment " data-fragment-index="2" > Simulations
										<ul style="font-size:smaller">
											<li> 1000 N-Body simulations of Quijote suite</li>
											<li> Populate galaxies with extended HOD model  </li>
											<li> Survey realism- survey geometry, veto mask, fibre collisions </li>
										</ul>
									</li>
									<br>
									<li class="plain fragment " data-fragment-index="3" > Analysis 
										<ul style="font-size:smaller">
											<li> Power spectrum multipoles ($P_0, P_2, P_4$) up to $k_{\mathrm max} < 0.5$ h/Mpc</li>
																				  <li> Constrain 5 cosmology, 9 HOD and 1 nuisance parameter   </li>
										</ul>
									</li>
									<br>
									<li class="plain fragment " data-fragment-index="4" > Results 
										<ul style="font-size:smaller">

											<li  > Improve $\sigma_8$ constraint by <b class="alert" > 27% </b> over standard galaxy clustering analysis  </li>
											<li  > Perturbative models can only model up to $k_{\mathrm max} =0.25$ h/Mpc  </li>
										</ul>
									</li>
								</ul>

                                                        </div>
						</div>
						
						<div class="col" style="flex: 0 0 25em">
							<img class="plain fragment current-visible" data-fragment-index="1" style="position:absolute; top:200px; right:50px"
                                                             data-src="assets/boss_telescope.jpg" width="420" />
							<img class="plain fragment current-visible" data-fragment-index="2" style="position:absolute; top:200px; right:50px"
                                                             data-src="assets/simbig_fwmodel.png" width="420" />
							<img class="plain fragment current-visible" data-fragment-index="3" style="position:absolute; top:200px; right:50px"
                                                             data-src="assets/simbig_fwmodel.png" width="420" />
							<img class="plain fragment" data-fragment-index="4" style="position:absolute; top:200px; right:50px"
                                                             data-src="assets/simbig_constraint.png" width="420" />
						</div>
						<br>
						
					</div>
                                        
        				
				</section>


				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				<section>
					<div style="font-size:40px">Roadmap to simulations based inference-<br>
						advances, challeges and the way ahead
						<div class="fragment"> </div>
					</div>
				</section>

                                <!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->

				<section >
					<h3 class='slide-title'>Roadmap to SBI #1</h3>
					
                                        <br>
                                        <b class="alert"> High fidelity simulations:</b> SBI training converges in the limit of a large number of samples. 
                                        <br>
                                        <br>
                                        <div class="slide-text">
                                                <ul>
                                                        <li  class="plain fragment" data-fragment-index="1"> SimBIG only analyzed <font color="red">10%</font> of the BOSS CMASS galaxies </li>
                                                        <br>
                                                        <li  class="plain fragment" data-fragment-index="2"> Limited by the simulation suite, Quijote, even though it's the <em> largest </em> available
                                                                <br>
                                                                $\rightarrow$ 1000 N-Body simulations- 1Gpc/h volume, 1024$^3$ particles, requiring $\sim$ 5 million CPU hours
                                                        </li>
                                                        <br>
                                                        <li  class="plain fragment" data-fragment-index="3"> Upcoming surveys will probe much larger survey volume & higher resolution</li>
                                                        <br>
                                                </ul>

                                        </div>
                                        <br>
                                        <div class="container">
						<div class="col"  style="margin-left:70px; ">
                                                        
						        <div class="box fragment", data-fragment-index="4"  style="width:700px" >
                                                                <div class="box-title">
                                                                        Fast, hybrid simulations
                                                                </div>
                                                                <div class="box-content">
                                                                        <ul>
                                                                                <br>
                                                                                <li class="plain fragment" data-fragment-index="4" > GPU accelerated particle-mesh (PM) simulations- $pmwd$ </li>
                                                                                <br>
                                                                                <li class="plain fragment" data-fragment-index="5" > Hybrid simulations with ML enhancements
                                                                                        <ul>
                                                                                                <li> Learn small scale forces missing in PM simulations </li>
                                                                                                <li> Learn sub-grid, baryonic physics </li>
                                                                                        </ul>
                                                                                </li>
                                                                        </ul>
                                                                </div>
                                                        </div>
                                                        <br>
                                                        <br>
                                                </div>
						<div class="col" style="">
							<img  class="plain fragment current-visible" data-fragment-index="4"
							      style="position:absolute; top:400px; right:50px" width="400px" data-src="assets/pmwd_timing.png" />
	                                                <img class="plain fragment" data-fragment-index="5" style="position:absolute; top:320px; right:50px;"
                                                             data-src="assets/denise_hybrid.png" width="320" />
						</div>
						
					</div>
       				                
       				
				</section>


				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				

				<section >
					<h3 class='slide-title'>Roadmap to SBI #2</h3>
					
                                        <br>
                                        <b class="alert"> Model misspecification:</b> SBI assumes that the observed data is generated from the same model (simulation)
                                        <br>
                                        <br>
					
                                        <div class="container">
						<div class="col"  style="flex: 0 0 30em">
                                                        <div class="slide-text">
                                                                <ul>
                                                                        <li class="plain fragment" data-fragment-index="1" > Can be over-confident or fail catastrophically if the model is not well-specified </li>
                                                                        <br>
                                                                        <li  class="plain fragment" data-fragment-index="3" > Glass completely empty: we cannot model the Universe exactly. </li>
                                                                        <br>
                                                                        <li  class="plain fragment" data-fragment-index="4" > Glass half full: we often have multiple models for the data.
                                                                                <ul>
                                                                                        <li> We can be more confident in regimes where these agree. </li> 
                                                                                        <li> Use the variations to construct invariant methodologies.  </li>
                                                                                </ul>
                                                                        </li>
                                                                        <br>
                                                                        <li  class="plain fragment" data-fragment-index="5" > Informed data-cuts, physically motivated models, combined in a principled way. </li>
                                                                </ul>
                                                        </div>
                                                </div>
						
						<div class="col" style="flex: 0 0 25em">
							<img class="plain fragment current-visible" data-fragment-index="2" style="position:absolute; top:180px; right:150px"
                                                             width="300px" data-src="assets/sbi_diffhod.png"  />
							<img class="plain fragment current-visible" data-fragment-index="1" style="position:absolute; top:450px; right:10px"
                                                             width="600px" data-src="assets/sbi_modelmisspec.png"  />
							<img class="plain fragment current-visible" data-fragment-index="2" style="position:absolute; top:450px; right:10px"
                                                             width="600px" data-src="assets/sbi_modelmisspec.png"  />
							<img class="plain fragment current-visible" data-fragment-index="3" style="position:absolute; top:180px; right:150px"
                                                             width="300px" data-src="assets/sbi_diffhod.png"  />
                                                        <img class="plain fragment current-visible" data-fragment-index="3" style="position:absolute; top:450px; right:10px"
                                                             width="600px" data-src="assets/sbi_modelmisspec.png"  />
                                                        
					                <div class="block fragment current-visible" data-fragment-index="4" style="width:500px" >
						                <div class="block-title" >
							                Galaxy occupation models
						                </div>
						                <div class="block-content">
							                <ul>
								                <li> Halo occupation distribution (HOD) </li>
								                <li> HOD with assembly biases</li>
								                <li> Semi-analytic models</li>
							                        <li> Hydro simulations </li>
                                                                        </ul>
						                </div>
					                </div>
							<img class="plain fragment " data-fragment-index="5" style="position:absolute; top:150px; right:-50px"
                                                             height="450px" width="800px" data-src="assets/sbi_robust.png"  />
                                                        <div> Cannon, Ward et. al. (2022) </div>
						</div>
						<br>
						
					</div>
                                        
        				
				</section>


				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->
				
				<section >
					<h3 class='slide-title'>Roadmap to SBI #3</h3>


                                        <div class="slide-text">
                                                <br>
                                                Other unresolved questions- 
                                                <br>
                                                <br>
                                                <ul>
                                                        <li class="plain fragment" data-fragment-index="1" >What are the optimal summary statistics?
                                                                <ul style="font-size:smaller">
                                                                        <li> NN based statistics, Information Maximizing neural networks, Variatoinal mutual information </li>
                                                                        <li> How much information is left behind? </li>
                                                                </ul>

                                                        </li>
                                                        <br>
                                                        <li class="plain fragment" data-fragment-index="2" > Which SBI methodology to use?
                                                                <ul style="font-size:smaller">
                                                                        <li> Amortized neural posterior estimation (discussed) </li>
                                                                        <li> Neural likelihood estimation </li>
                                                                        <li> Neural likelihood ratios </li>
                                                                        <li> Sequential neural posterior estimation </li>
                                                                        <li>...</li>
                                                                </ul>

                                                        </li>
                                                        <br>
                                                        <li class="plain fragment" data-fragment-index="3" > Where to generate training dataset i.e. sample parameters from prior $p(\theta)$ to run simulations?
                                                                <ul style="font-size:smaller">
                                                                        <li> agnostic latin-hypercube over the entire parameter space </li>
                                                                        <li> parameter combinations to break degeneracies  </li>
                                                                        <li> Bayesian optimization </li>
                                                                        <li> Gradient based parameter exploration </li> 
                                                                </ul>
                                                        </li>
                                                        <br>

                                                </ul>
                                        </div>
       				
				</section>


				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->

				<section >
					<h3 class='slide-title'>Summary</h3>
					

					<br>
					<div class="block fragment " style="width:1200px">
						<div class="block-title" >
							Limitations of traditional analysis
						</div>
						<div class="block-content">
							<ul>
								<li> Develop novel inference methodologies for future surveys </li>
								<li> FlowPM: differentiable PM simulations in ML framework </li>
								<li> Hybrid, ML enahanced cosmological simulations </li>
                                                        </ul>
						</div>
					</div>
					<br>
					<div class="block fragment " style="width:1200px" >
						<div class="block-title" >
							Field Level Inference
						</div>
						<div class="block-content">
							<ul>
								<li> Why? Enables optimal analysis, joint analyses & reconstucts latent fields for supplementary analysis </li>
								<li> Requires access to fast, differentiable simulations such as FlowPM and $pmwd$ (open source)</li>
							        <li> Bayesian inference algorithms can be accelerated with ML components such as in CosmicRIM and VBS </li>
                                                        </ul>
						</div>
					</div>
					<br>
					
					<div class="block fragment " style="width:1200px" >
						<div class="block-title" >
							Simulations Based Inference
						</div>
						<div class="block-content">
							<ul>
								<li> Use powerful summary statistics </li>
								<li> Need to ensure robustness to model mis-specification</li>
							        <li> Need to generate training dataset </li>
                                                        </ul>
						</div>
					</div>
					<br>
					
				</section>
                                
				<!-------------------------------------------------------------------------------->
				<!-------------------------------------------------------------------------------->

				
				</div>
			</div>
			

		<style>
		.reveal .slides {
		     border: 1px solid red;
		     min-height: 100%; 
		     width: 128mm; 
		     height: 96mm; 
                }  
		.reveal .box {
			background-color: #191919;
			margin-left: 10px;
			margin-right: 10px;
			text-align: center;
		}
		.reveal .box-title {
			background-color: #333333;
			padding:1px 1px 1px 1px;
  		color: #FFAA7F;
  		font-weight: bold;
		}

		
		.reveal .block {
			background-color: #191919;
			margin-left: 20px;
			margin-right: 20px;
			text-align: left;
			padding-bottom: 0.1em;
		}
		.reveal .block-title {
			background-color: #333333;
			padding:8px 35px 8px 14px;
  		color: #FFAA7F;
  		font-weight: bold;
		}
		.reveal .block-content {
			padding:8px 35px 8px 14px;
		}
                
		.reveal .slide-title {
			border-left: 5px solid white;
			text-align: left;
			margin-left: 20px;
			padding-left: 20px;
		}
		.reveal .slide-title-black {
			border-left: 5px solid black;
			text-align: left;
			margin-left: 20px;
			padding-left: 20px;
		}
                
		.reveal .alert {
  		color: #FFAA7F;
  		font-weight: bold;
		}
                
		.reveal .slide-text {
			text-align: left;
			margin-left: 20px;
		}
                
		.reveal .boxonly {
			background-color:  #333333;
			margin: auto;
			text-align: center;
			border-radius: 5px;

		}
                
		.reveal .inverted {
			filter: invert(100%);
		}
		</style>


		<script src="reveal.js/js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				controls: true,

				//center: false,
				hash: true,
				// Visibility rule for backwards navigation arrows; "faded", "hidden"
				// or "visible"
				controlsBackArrows: 'hidden',
				// Display a presentation progress bar
				progress: true,
				// Display the page number of the current slide
				slideNumber: true,
				transition: 'slide', // none/fade/slide/convex/concave/zoom
				// The "normal" size of the presentation, aspect ratio will be preserved
				// when the presentation is scaled to fit different resolutions. Can be
				// specified using percentage units.
				width: 1280,
				height: 720,
				// Factor of the display size that should remain empty around the content
				margin: 0.1,
				// Bounds for smallest/largest possible scale to apply to content
				minScale: 0.2,
				maxScale: 1.5,

				dependencies: [
					{ src: 'reveal.js/plugin/markdown/marked.js' },
					{ src: 'reveal.js/plugin/markdown/markdown.js' },
					{ src: 'reveal.js/plugin/notes/notes.js', async: true },
					{ src: 'reveal.js/plugin/highlight/highlight.js', async: true },
					{ src: 'reveal.js/plugin/math/math.js', async: true },
					{ src: 'reveal.js/plugin/reveal.js-d3/reveald3.js' },
					{ src: 'reveal.js/plugin/reveal.js-plugins/chart/Chart.min.js' },
					{ src: 'reveal.js/plugin/reveal.js-plugins/chart/csv2chart.js' },
				]
			});
		</script>
	</body>
</html>


